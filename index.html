<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¥Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† - Firebase</title>
    
    <!-- Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„Ù…Ø¯Ù…Ø¬ -->
    <script>
        // Ù†Ø¸Ø§Ù… Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª SVG Ø§Ø­ØªØ±Ø§ÙÙŠ Ù…Ø¯Ù…Ø¬
        const IconSystem = {
            // Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª SVG
            icons: {
                'users': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>',
                'calendar-plus': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line><line x1="12" y1="15" x2="12" y2="19"></line><line x1="10" y1="17" x2="14" y2="17"></line></svg>',
                'clock': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12,6 12,12 16,14"></polyline></svg>',
                'user-plus': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>',
                'file-text': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14,2 14,8 20,8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10,9 9,9 8,9"></polyline></svg>',
                'log-out': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16,17 21,12 16,7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>',
                'save': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17,21 17,13 7,13 7,21"></polyline><polyline points="7,3 7,8 15,8"></polyline></svg>',
                'edit-2': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>',
                'trash-2': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3,6 5,6 21,6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>',
                'x': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',
                'check': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20,6 9,17 4,12"></polyline></svg>',
                'plus': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>',
                'settings': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>',
                'arrow-up': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5,12 12,5 19,12"></polyline></svg>',
                'arrow-down': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19,12 12,19 5,12"></polyline></svg>',
                'chevron-right': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9,18 15,12 9,6"></polyline></svg>',
                'chevron-left': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15,18 9,12 15,6"></polyline></svg>',
                'rotate-ccw': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1,4 1,10 7,10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>',
                'history': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12,6 12,12 16,14"></polyline></svg>',
                'alert-triangle': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>',
                'trending-down': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23,18 13.5,8.5 8.5,13.5 1,6"></polyline><polyline points="17,18 23,18 23,12"></polyline></svg>',
                'calendar': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>',
                'play': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5,3 19,12 5,21"></polygon></svg>',
                'square': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>',
                'user': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>',
                'check-circle': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22,4 12,14.01 9,11.01"></polyline></svg>',
                'x-circle': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>',
                'alert-circle': '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>'
            },

            // ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
            createIcons: function() {
                const iconElements = document.querySelectorAll('[data-lucide]');
                iconElements.forEach(element => {
                    const iconName = element.getAttribute('data-lucide');
                    if (this.icons[iconName]) {
                        element.innerHTML = this.icons[iconName];
                        element.style.display = 'inline-block';
                        element.style.verticalAlign = 'middle';
                    }
                });
                console.log(`âœ… Processed ${iconElements.length} icons`);
            }
        };

        // Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù† lucide Ù…ØªÙˆØ§ÙÙ‚
        window.lucide = {
            createIcons: function() {
                IconSystem.createIcons();
            }
        };

        console.log('âœ… Professional Icon System loaded');
    </script>

    <!-- ØªØ­Ù…ÙŠÙ„ Firebase Ø¨Ø´ÙƒÙ„ Ø§Ø­ØªØ±Ø§ÙÙŠ -->
    <script>
        // Ù†Ø¸Ø§Ù… ØªØ­Ù…ÙŠÙ„ Firebase Ø§Ù„Ù…Ø­Ø³Ù†
        async function loadFirebase() {
            const firebaseSources = [
                [
                    'https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js',
                    'https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js',
                    'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js'
                ],
                [
                    'https://www.gstatic.com/firebasejs/9.21.0/firebase-app-compat.js',
                    'https://www.gstatic.com/firebasejs/9.21.0/firebase-auth-compat.js',
                    'https://www.gstatic.com/firebasejs/9.21.0/firebase-firestore-compat.js'
                ]
            ];

            for (const sources of firebaseSources) {
                try {
                    console.log('ğŸ”„ Loading Firebase...');
                    
                    for (const src of sources) {
                        await loadScript(src);
                    }
                    
                    if (typeof firebase !== 'undefined') {
                        console.log('âœ… Firebase loaded successfully');
                        return true;
                    }
                } catch (error) {
                    console.warn('âš ï¸ Firebase source failed, trying next...', error);
                }
            }
            
            console.warn('âŒ All Firebase sources failed - using local mode');
            return false;
        }

        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const existingScript = document.querySelector(`script[src="${src}"]`);
                if (existingScript) {
                    resolve();
                    return;
                }

                const script = document.createElement('script');
                script.src = src;
                script.async = true;
                
                const timeout = setTimeout(() => {
                    reject(new Error(`Timeout: ${src}`));
                }, 8000);

                script.onload = () => {
                    clearTimeout(timeout);
                    resolve();
                };

                script.onerror = () => {
                    clearTimeout(timeout);
                    reject(new Error(`Failed: ${src}`));
                };

                document.head.appendChild(script);
            });
        }

        // Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Firebase
        window.firebaseLoadingPromise = loadFirebase();
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #001a4d 0%, #002366 50%, #001a4d 100%);
            color: #ffffff;
            min-height: 100vh;
            direction: rtl;
        }

        :root {
            --primary-900: #001a4d;
            --primary-800: #002366;
            --primary-700: #003080;
            --primary-600: #004099;
            --primary-500: #0050b3;
            --primary-400: #1677ff;
            --primary-300: #4096ff;
            --primary-200: #69b1ff;
            --primary-100: #91caff;
            
            --neon-blue: #00d4ff;
            --neon-green: #00ff88;
            --neon-yellow: #ffeb3b;
            --neon-red: #ff4444;
            --neon-orange: #ff9800;
            --neon-purple: #9c27b0;
            
            /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ© */
            --tab-balances: #00d4ff;
            --tab-record: #00ff88;
            --tab-saturday: #ff9800;
            --tab-employees: #9c27b0;
            --tab-records: #ffeb3b;
            --tab-settings: #ff4444;
        }

        .neon-text {
            color: var(--neon-blue);
            text-shadow: 0 0 10px var(--neon-blue), 0 0 20px var(--neon-blue), 0 0 30px var(--neon-blue);
        }

        .card-neon {
            background: rgba(0, 35, 102, 0.3);
            border: 1px solid rgba(0, 212, 255, 0.3);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .btn-neon {
            background: linear-gradient(45deg, var(--neon-blue), var(--primary-600));
            border: 1px solid var(--neon-blue);
            color: white;
            transition: all 0.3s ease;
            cursor: pointer;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 1rem;
        }

        .btn-neon:hover {
            box-shadow: 0 0 20px var(--neon-blue);
            transform: translateY(-2px);
        }

        .btn-neon:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .input-neon {
            background: rgba(0, 35, 102, 0.5);
            border: 1px solid rgba(0, 212, 255, 0.3);
            color: white;
            transition: all 0.3s ease;
            padding: 0.75rem;
            border-radius: 8px;
            width: 100%;
        }

        .input-neon:focus {
            outline: none;
            border-color: var(--neon-blue);
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }

        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .login-card {
            width: 100%;
            max-width: 400px;
            padding: 2rem;
            border-radius: 12px;
        }

        .login-title {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--primary-200);
            font-weight: 500;
        }

        .notification {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .notification.success {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            color: var(--neon-green);
        }

        .notification.error {
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid rgba(255, 68, 68, 0.3);
            color: var(--neon-red);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--neon-blue);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .text-center { text-align: center; }
        .text-sm { font-size: 0.875rem; }
        .mt-4 { margin-top: 1rem; }
        .text-gray { color: var(--primary-200); }

        .main-screen {
            padding: 2rem;
        }

        .welcome-message {
            text-align: center;
            margin-bottom: 2rem;
        }

        .logout-btn {
            background: rgba(255, 68, 68, 0.2);
            border: 1px solid rgba(255, 68, 68, 0.5);
            color: #ff4444;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            float: left;
            margin-bottom: 2rem;
        }

        .logout-btn:hover {
            background: rgba(255, 68, 68, 0.3);
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
        .remember-me-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .remember-me-checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--neon-blue);
            cursor: pointer;
        }

        .forgot-password-link {
            color: var(--neon-blue);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .forgot-password-link:hover {
            color: var(--neon-green);
            text-shadow: 0 0 5px var(--neon-green);
        }

        /* Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            overflow-y: auto;
            padding: 2rem 1rem;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: linear-gradient(135deg, var(--primary-900) 0%, var(--primary-800) 100%);
            border: 2px solid var(--neon-blue);
            border-radius: 16px;
            padding: 2rem;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            text-align: center;
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.3);
            transform: scale(0.8);
            transition: all 0.3s ease;
            overflow-y: auto;
            margin: auto;
            position: relative;
        }

        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        /* Ù…Ù†Ø¹ Ø§Ù„Ø³ÙƒØ±ÙˆÙ„ ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
        body.modal-open {
            overflow: hidden;
        }

        /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø³ÙƒØ±ÙˆÙ„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
        .modal-content::-webkit-scrollbar {
            width: 8px;
        }

        .modal-content::-webkit-scrollbar-track {
            background: rgba(0, 35, 102, 0.3);
            border-radius: 4px;
        }

        .modal-content::-webkit-scrollbar-thumb {
            background: var(--neon-blue);
            border-radius: 4px;
        }

        .modal-content::-webkit-scrollbar-thumb:hover {
            background: var(--neon-green);
        }

        .modal-title {
            color: var(--neon-blue);
            font-size: 1.5rem;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px var(--neon-blue);
        }

        .modal-message {
            color: white;
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 2rem;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .modal-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .modal-btn.funny {
            background: linear-gradient(45deg, var(--neon-yellow), #ff9800);
            color: var(--primary-900);
            font-weight: bold;
        }

        .modal-btn.funny:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 235, 59, 0.4);
        }

        .modal-btn.primary {
            background: linear-gradient(45deg, var(--neon-blue), var(--primary-600));
            color: white;
        }

        .modal-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.4);
        }

        /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ© */
        .seasonal-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary-900) 0%, var(--primary-800) 100%);
            border: 2px solid var(--neon-green);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            color: white;
            font-size: 1rem;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
            z-index: 999;
            transform: translateX(120%);
            transition: all 0.5s ease;
            max-width: 350px;
            opacity: 0;
            visibility: hidden;
        }

        .seasonal-message.show {
            transform: translateX(0);
            opacity: 1;
            visibility: visible;
        }

        .seasonal-message .close-btn {
            position: absolute;
            top: 5px;
            left: 10px;
            background: none;
            border: none;
            color: var(--neon-red);
            font-size: 1.2rem;
            cursor: pointer;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø³ÙŠØ§Ù† */
        .forget-counter {
            background: rgba(255, 235, 59, 0.1);
            border: 1px solid rgba(255, 235, 59, 0.3);
            border-radius: 8px;
            padding: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: var(--neon-yellow);
            text-align: center;
        }

        /* Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
        @media (max-width: 1200px) {
            #balancesContent {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)) !important;
            }
        }

        @media (max-width: 768px) {
            .main-screen {
                padding: 1rem;
            }
            
            #balancesContent {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
                gap: 0.75rem !important;
            }
            
            .tab-button {
                padding: 0.75rem 1rem !important;
                font-size: 0.9rem;
            }
            
            .welcome-message h1 {
                font-size: 1.5rem;
            }
            
            /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            .main-screen > div:first-of-type {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
            }
            
            /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù„Ù…Ø³ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            .btn-neon, .tab-button, button {
                min-height: 44px;
                touch-action: manipulation;
                -webkit-tap-highlight-color: transparent;
            }
            
            .input-neon, input, select, textarea {
                min-height: 44px;
                font-size: 16px; /* Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¹Ù„Ù‰ iOS */
                -webkit-appearance: none;
                appearance: none;
            }
        }

        @media (max-width: 480px) {
            #balancesContent {
                grid-template-columns: 1fr !important;
            }
            
            .tab-button {
                padding: 0.5rem 0.75rem !important;
                font-size: 0.8rem;
            }
            
            .tab-button span {
                display: none;
            }
            
            /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
            .main-screen > div:first-of-type {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0.75rem !important;
            }
            
            /* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª */
            #saturdayTable {
                border-radius: 8px;
                overflow: hidden;
            }
            
            #saturdayTable th {
                background: rgba(0, 35, 102, 0.5);
                font-size: 0.9rem;
            }
            
            #saturdayTable td {
                font-size: 0.9rem;
            }
            
            #saturdayTable tbody tr:hover {
                background: rgba(0, 212, 255, 0.05);
            }
            
            /* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† */
            #employeesTable {
                border-radius: 8px;
                overflow: hidden;
            }
            
            #employeesTable th {
                background: rgba(0, 35, 102, 0.5);
                font-size: 0.9rem;
            }
            
            #employeesTable td {
                font-size: 0.9rem;
            }
            
            #employeesTable tbody tr:hover {
                background: rgba(0, 212, 255, 0.05);
            }
            
            /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
            .edit-employee-btn:hover {
                background: rgba(0, 212, 255, 0.3) !important;
                transform: translateY(-1px);
            }
            
            .delete-employee-btn:hover {
                background: rgba(255, 68, 68, 0.3) !important;
                transform: translateY(-1px);
            }
            
            /* Ø²Ø± Ø§Ù„Ø¥Ù„ØºØ§Ø¡ */
            #cancelEmployeeBtn:hover {
                background: rgba(255, 68, 68, 0.3);
            }
            
            /* Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø© */
            #photoPreview {
                transition: all 0.3s ease;
            }
            
            #photoPreview:hover {
                transform: scale(1.1);
                box-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
            }
            
            /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ±Ù‚ÙŠÙ… */
            #prevPage:disabled,
            #nextPage:disabled {
                cursor: not-allowed;
                opacity: 0.5;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
            .employee-photo {
                transition: transform 0.3s ease;
            }
            
            .employee-photo:hover {
                transform: scale(1.2);
            }
            
            /* Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
            .modal-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                z-index: 1000;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .modal-content {
                width: 90%;
                max-width: 500px;
                padding: 2rem;
                border-radius: 12px;
                max-height: 80vh;
                overflow-y: auto;
            }
        }

        /* ==================== ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø© ==================== */
        
        /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø­Ø³Ù†Ø© */
        .employee-balance-card {
            background: rgba(0, 35, 102, 0.3);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            padding: 1.25rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 200px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        /* ØªØ£Ø«ÙŠØ± hover Ù…Ù…ÙŠØ² */
        .employee-balance-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: var(--neon-blue);
            box-shadow: 
                0 20px 40px rgba(0, 212, 255, 0.2),
                0 0 30px rgba(0, 212, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            background: rgba(0, 35, 102, 0.5);
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ù‚Ø± */
        .employee-balance-card:active {
            transform: translateY(-4px) scale(1.01);
            transition: all 0.1s ease;
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¶ÙˆØ¡ Ø§Ù„Ù…ØªØ­Ø±Ùƒ */
        .employee-balance-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent,
                rgba(0, 212, 255, 0.1),
                transparent
            );
            transform: rotate(45deg);
            transition: all 0.6s ease;
            opacity: 0;
        }

        .employee-balance-card:hover::before {
            animation: shimmer 1.5s ease-in-out;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%) translateY(-100%) rotate(45deg);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateX(100%) translateY(100%) rotate(45deg);
                opacity: 0;
            }
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¨Ø¶Ø© Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
        .employee-balance-card.updated {
            animation: pulse-update 2s ease-in-out;
        }

        @keyframes pulse-update {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(0, 255, 136, 0.7);
            }
            50% {
                box-shadow: 0 0 0 20px rgba(0, 255, 136, 0);
            }
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .employee-balance-card.loading {
            position: relative;
            pointer-events: none;
        }

        .employee-balance-card.loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 35, 102, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
        }

        /* ØªØ­Ø³ÙŠÙ† Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent
            );
            animation: progress-shine 2s infinite;
        }

        @keyframes progress-shine {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        /* ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… */
        .balance-number {
            font-weight: 700;
            font-size: 1.1rem;
            text-shadow: 0 0 10px currentColor;
            transition: all 0.3s ease;
        }

        .employee-balance-card:hover .balance-number {
            transform: scale(1.05);
        }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø­Ø§Ù„Ø© */
        .status-indicator {
            position: absolute;
            top: 1rem;
            left: 1rem;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: status-pulse 2s infinite;
        }

        .status-indicator.excellent {
            background: var(--neon-green);
            box-shadow: 0 0 10px var(--neon-green);
        }

        .status-indicator.good {
            background: var(--neon-blue);
            box-shadow: 0 0 10px var(--neon-blue);
        }

        .status-indicator.warning {
            background: var(--neon-yellow);
            box-shadow: 0 0 10px var(--neon-yellow);
        }

        .status-indicator.critical {
            background: var(--neon-red);
            box-shadow: 0 0 10px var(--neon-red);
        }

        @keyframes status-pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.7;
                transform: scale(1.2);
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        @media (max-width: 768px) {
            .employee-balance-card:hover {
                transform: translateY(-4px) scale(1.01);
            }
        }

        /* ==================== ØªØ­Ø³ÙŠÙ†Ø§Øª Ø´Ø±ÙŠØ· Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ==================== */
        
        /* Ø­Ø§ÙˆÙŠ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù† */
        .tabs-container {
            position: relative;
            background: rgba(0, 35, 102, 0.3);
            border-radius: 12px;
            margin-bottom: 2rem;
            padding: 0.5rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 212, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
        .tabs-bar {
            display: flex;
            position: relative;
            width: 100%;
            overflow: hidden;
        }

        /* Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ù…ØªØ­Ø±Ùƒ */
        .tab-indicator {
            position: absolute;
            bottom: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--tab-balances), rgba(0, 212, 255, 0.5));
            border-radius: 2px 2px 0 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px currentColor;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù†Ø© */
        .tab-button {
            flex: 1;
            background: none;
            border: none;
            padding: 1rem 0.75rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.95rem;
            font-weight: 500;
            border-radius: 8px;
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--primary-200);
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            min-height: 60px;
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª hover Ù„Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
        .tab-button:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
            color: white;
        }

        .tab-button:hover i {
            transform: scale(1.1);
        }

        /* Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù†Ø´Ø· */
        .tab-button.active {
            color: white;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .tab-button.active i {
            transform: scale(1.1);
        }

        /* Ø£Ù„ÙˆØ§Ù† Ù…Ø®ØµØµØ© Ù„ÙƒÙ„ ØªØ¨ÙˆÙŠØ¨ */
        .tab-button[data-tab="balances"]:hover,
        .tab-button[data-tab="balances"].active {
            color: var(--tab-balances);
            text-shadow: 0 0 10px var(--tab-balances);
        }

        .tab-button[data-tab="record"]:hover,
        .tab-button[data-tab="record"].active {
            color: var(--tab-record);
            text-shadow: 0 0 10px var(--tab-record);
        }

        .tab-button[data-tab="saturday"]:hover,
        .tab-button[data-tab="saturday"].active {
            color: var(--tab-saturday);
            text-shadow: 0 0 10px var(--tab-saturday);
        }

        .tab-button[data-tab="employees"]:hover,
        .tab-button[data-tab="employees"].active {
            color: var(--tab-employees);
            text-shadow: 0 0 10px var(--tab-employees);
        }

        .tab-button[data-tab="records"]:hover,
        .tab-button[data-tab="records"].active {
            color: var(--tab-records);
            text-shadow: 0 0 10px var(--tab-records);
        }

        .tab-button[data-tab="settings"]:hover,
        .tab-button[data-tab="settings"].active {
            color: var(--tab-settings);
            text-shadow: 0 0 10px var(--tab-settings);
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª */
        .tab-button i {
            transition: all 0.3s ease;
            width: 20px;
            height: 20px;
        }

        /* Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© */
        @media (max-width: 1024px) {
            .tab-button {
                font-size: 0.9rem;
                padding: 0.875rem 0.5rem;
                gap: 0.375rem;
            }
            
            .tab-button i {
                width: 18px;
                height: 18px;
            }
        }

        /* Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
        @media (max-width: 768px) {
            .tab-button {
                font-size: 0.8rem;
                padding: 0.75rem 0.25rem;
                gap: 0.25rem;
                min-height: 50px;
            }
            
            .tab-button i {
                width: 16px;
                height: 16px;
            }
            
            .tabs-container {
                margin-bottom: 1.5rem;
                padding: 0.25rem;
            }
        }

        /* Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
        @media (max-width: 480px) {
            .tab-button {
                font-size: 0.7rem;
                padding: 0.5rem 0.125rem;
                flex-direction: column;
                gap: 0.125rem;
                min-height: 45px;
            }
            
            .tab-button i {
                width: 14px;
                height: 14px;
            }
            
            /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Øµ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙÙ‚Ø· */
            .tab-button span.tab-text {
                display: none;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 768px) {
            .modal-overlay {
                padding: 1rem 0.5rem;
            }
            
            .modal-content {
                max-height: 95vh;
                padding: 1.5rem;
                margin: 0;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            #addUserModal .modal-content {
                max-width: 95vw;
            }
            
            #addUserModal form > div[style*="grid-template-columns"] {
                grid-template-columns: 1fr !important;
                gap: 0.75rem !important;
            }
            
            #addUserModal .form-group {
                margin-bottom: 0.75rem;
            }
            
            #addUserModal .input-neon {
                padding: 0.75rem !important;
                font-size: 16px; /* Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¹Ù„Ù‰ iOS */
            }
        }

        @media (max-width: 480px) {
            .modal-overlay {
                padding: 0.5rem 0.25rem;
            }
            
            .modal-content {
                padding: 1rem;
                border-radius: 12px;
            }
            
            #addUserModal .modal-title {
                font-size: 1.1rem !important;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªÙØ§Ø¹Ù„ */
        .tab-button:active {
            transform: translateY(0);
        }

        .tab-button:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
        }

        /* Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙˆÙ„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª */
        .leave-history-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .leave-history-table thead {
            background: linear-gradient(135deg, var(--primary-700), var(--primary-800));
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .leave-history-table th {
            padding: 1rem 0.75rem;
            text-align: center;
            color: var(--neon-blue);
            font-weight: 600;
            font-size: 0.9rem;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
        }

        .leave-history-table td {
            padding: 0.875rem 0.75rem;
            text-align: center;
            color: white;
            font-size: 0.85rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            vertical-align: middle;
        }

        .leave-history-table tbody tr {
            transition: all 0.2s ease;
        }

        .leave-history-table tbody tr:hover {
            background: rgba(0, 212, 255, 0.1);
            transform: scale(1.01);
        }

        .leave-history-table tbody tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.02);
        }

        .leave-history-table tbody tr:nth-child(odd) {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Ø£Ù†Ù…Ø§Ø· Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
        .leave-type-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.375rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .leave-type-regular {
            background: rgba(0, 212, 255, 0.2);
            color: var(--neon-blue);
            border: 1px solid rgba(0, 212, 255, 0.4);
        }

        .leave-type-emergency {
            background: rgba(255, 193, 7, 0.2);
            color: var(--neon-yellow);
            border: 1px solid rgba(255, 193, 7, 0.4);
        }

        .leave-type-permission {
            background: rgba(255, 152, 0, 0.2);
            color: var(--neon-orange);
            border: 1px solid rgba(255, 152, 0, 0.4);
        }

        .leave-type-sick {
            background: rgba(255, 68, 68, 0.2);
            color: var(--neon-red);
            border: 1px solid rgba(255, 68, 68, 0.4);
        }

        /* Ø­Ø§ÙˆÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
        .table-container {
            max-height: 400px;
            overflow-y: auto;
            border-radius: 12px;
            scrollbar-width: thin;
            scrollbar-color: var(--neon-blue) rgba(255, 255, 255, 0.1);
        }

        .table-container::-webkit-scrollbar {
            width: 8px;
        }

        .table-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: var(--neon-blue);
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: var(--primary-400);
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 768px) {
            .leave-history-table th,
            .leave-history-table td {
                padding: 0.5rem 0.25rem;
                font-size: 0.75rem;
            }

            .leave-type-badge {
                padding: 0.25rem 0.5rem;
                font-size: 0.7rem;
                gap: 0.25rem;
            }

            .table-container {
                max-height: 300px;
            }

            /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            #employeeDetailsModal .modal-content {
                max-width: 95vw !important;
                margin: 1rem 0.5rem !important;
                padding: 1rem !important;
                max-height: 95vh !important;
            }

            #employeeDetailsModal .employee-info-section > div {
                grid-template-columns: 1fr !important;
                gap: 1rem !important;
            }

            #employeeDetailsModal .modal-title {
                font-size: 1.1rem !important;
            }

            /* Ø¥Ø®ÙØ§Ø¡ Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
            @media (max-width: 480px) {
                .leave-history-table th:nth-child(3),
                .leave-history-table td:nth-child(3) {
                    display: none;
                }

                #employeeDetailsModal .modal-content {
                    margin: 0.5rem 0.25rem !important;
                    padding: 0.75rem !important;
                }

                .leave-history-table th,
                .leave-history-table td {
                    padding: 0.375rem 0.125rem;
                    font-size: 0.7rem;
                }
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ØªØ§Ø¨Ù„Øª */
        @media (max-width: 1024px) and (min-width: 769px) {
            .leave-history-table th,
            .leave-history-table td {
                padding: 0.75rem 0.5rem;
                font-size: 0.8rem;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
        @media (max-width: 768px) {
            /* ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø´Ø¨ÙƒØ© Ø¥Ù„Ù‰ Ø¹Ù…ÙˆØ¯ ÙˆØ§Ø­Ø¯ ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            #employeesTab .card-neon[style*="grid-template-columns: 1fr 1fr"] {
                display: block !important;
            }
            
            #employeesTab .card-neon[style*="grid-template-columns: 1fr 1fr"] > div {
                margin-bottom: 1.5rem;
            }
            
            #employeesTab .card-neon[style*="grid-template-columns: 1fr 1fr"] > div:last-child {
                margin-bottom: 0;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±Ø© */
            #employeesTab [style*="justify-content: space-between"] {
                flex-direction: column !important;
                align-items: stretch !important;
                gap: 1rem !important;
            }
            
            #employeesTab [style*="justify-content: space-between"] h3 {
                text-align: center;
            }
            
            #employeesTab [style*="justify-content: space-between"] > div {
                justify-content: center !important;
                flex-wrap: wrap !important;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙÙ„ØªØ±Ø© */
            #employeesTab select,
            #employeesTab input[type="text"] {
                width: 100% !important;
                max-width: 200px;
                margin-bottom: 0.5rem;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† */
            #employeesTable {
                font-size: 0.8rem;
            }
            
            #employeesTable th,
            #employeesTable td {
                padding: 0.5rem 0.25rem !important;
            }
            
            /* Ø¥Ø®ÙØ§Ø¡ Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            #employeesTable th:nth-child(1),
            #employeesTable td:nth-child(1),
            #employeesTable th:nth-child(6),
            #employeesTable td:nth-child(6) {
                display: none;
            }
        }

        @media (max-width: 480px) {
            /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
            #employeesTable th:nth-child(5),
            #employeesTable td:nth-child(5),
            #employeesTable th:nth-child(7),
            #employeesTable td:nth-child(7) {
                display: none;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ */
            #employeesTab .form-group {
                margin-bottom: 1rem;
            }
            
            #employeesTab [style*="grid-template-columns: 1fr 1fr"] {
                display: block !important;
            }
            
            #employeesTab [style*="grid-template-columns: 1fr 1fr"] > div {
                margin-bottom: 0.75rem;
            }
            
            /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
            #employeesTab [style*="display: flex"] button {
                flex: 1;
                min-width: 120px;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ØªØ§Ø¨Ù„Øª */
        @media (max-width: 1024px) and (min-width: 769px) {
            #employeesTab select,
            #employeesTab input[type="text"] {
                width: 140px !important;
            }
            
            #employeesTable {
                font-size: 0.85rem;
            }
            
            #employeesTable th,
            #employeesTable td {
                padding: 0.6rem 0.4rem !important;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ ØªØ³Ø¬ÙŠÙ„ Ø­Ø±ÙƒØ© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
        .record-tab-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        .record-form-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .record-sidebar {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .leave-type-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.75rem;
        }

        .leave-type-btn {
            padding: 0.75rem;
            border-radius: 8px;
            border: 2px solid var(--primary-600);
            background: none;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        .leave-type-btn.active {
            border-color: var(--neon-green);
            background: rgba(0, 255, 136, 0.1);
            color: var(--neon-green);
        }

        .leave-type-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3);
        }

        .date-time-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ ØªØ³Ø¬ÙŠÙ„ Ø­Ø±ÙƒØ© Ù„Ù„ØªØ§Ø¨Ù„Øª */
        @media (max-width: 1024px) and (min-width: 769px) {
            .record-tab-container {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .record-sidebar {
                flex-direction: row;
                gap: 1.5rem;
            }

            .leave-type-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ ØªØ³Ø¬ÙŠÙ„ Ø­Ø±ÙƒØ© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 768px) {
            .record-tab-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .record-form-card {
                padding: 1rem;
            }

            .record-sidebar {
                flex-direction: column;
                gap: 1rem;
            }

            .leave-type-buttons {
                grid-template-columns: 1fr 1fr;
                gap: 0.5rem;
            }

            .leave-type-btn {
                padding: 0.6rem 0.5rem;
                font-size: 0.8rem;
            }

            .date-time-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            #recordTab h2 {
                font-size: 1.2rem !important;
                margin-bottom: 1rem !important;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ ØªØ³Ø¬ÙŠÙ„ Ø­Ø±ÙƒØ© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
        @media (max-width: 480px) {
            .record-form-card {
                padding: 0.75rem;
                margin: 0 -0.5rem;
            }

            .leave-type-buttons {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }

            .leave-type-btn {
                padding: 0.75rem;
                font-size: 0.85rem;
            }

            #recordTab h2 {
                font-size: 1.1rem !important;
                text-align: center;
            }

            .form-group {
                margin-bottom: 1rem;
            }

            .input-neon, .btn-neon {
                padding: 0.75rem !important;
                font-size: 16px !important; /* Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¹Ù„Ù‰ iOS */
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
        .saturday-tab-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .saturday-form-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª Ù„Ù„ØªØ§Ø¨Ù„Øª */
        @media (max-width: 1024px) and (min-width: 769px) {
            .saturday-tab-container {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 768px) {
            .saturday-tab-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .saturday-form-card {
                padding: 1rem;
            }

            #saturdayTab h2 {
                font-size: 1.2rem !important;
                margin-bottom: 1rem !important;
                text-align: center;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
        @media (max-width: 480px) {
            .saturday-form-card {
                padding: 0.75rem;
                margin: 0 -0.5rem;
            }

            #saturdayTab h2 {
                font-size: 1.1rem !important;
                flex-direction: column;
                gap: 0.25rem !important;
            }

            /* ØªØ­Ø³ÙŠÙ† Ø¬Ø¯ÙˆÙ„ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            #saturdayTable {
                font-size: 0.75rem;
            }

            #saturdayTable th,
            #saturdayTable td {
                padding: 0.5rem 0.25rem !important;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø¬Ø¯ÙˆÙ„ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª */
        @media (max-width: 768px) {
            #saturdayTable {
                font-size: 0.8rem;
            }

            #saturdayTable th,
            #saturdayTable td {
                padding: 0.6rem 0.4rem;
            }
        }

        @media (max-width: 480px) {
            /* Ø¥Ø®ÙØ§Ø¡ Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            #saturdayTable .hide-mobile {
                display: none;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø³Ø¬Ù„ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
        .records-filters-container {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .records-filters-row2 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr auto;
            gap: 1rem;
            align-items: end;
        }

        .records-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .records-table-container {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid rgba(0, 212, 255, 0.3);
        }

        .records-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(0, 35, 102, 0.3);
        }

        .records-table th {
            padding: 1rem;
            text-align: right;
            color: var(--neon-blue);
            border-bottom: 1px solid rgba(0, 212, 255, 0.3);
            cursor: pointer;
            white-space: nowrap;
        }

        .records-table td {
            padding: 0.875rem 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
        }

        .records-table tbody tr:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .records-pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(0, 212, 255, 0.3);
        }

        .records-action-buttons {
            display: flex;
            gap: 0.5rem;
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø³Ø¬Ù„ Ù„Ù„ØªØ§Ø¨Ù„Øª */
        @media (max-width: 1024px) and (min-width: 769px) {
            .records-filters-container {
                grid-template-columns: 1fr 1fr;
                gap: 0.75rem;
            }

            .records-filters-row2 {
                grid-template-columns: 1fr 1fr auto;
                gap: 0.75rem;
            }

            .records-stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .records-table th,
            .records-table td {
                padding: 0.75rem 0.5rem;
                font-size: 0.9rem;
            }

            .records-action-buttons {
                flex-direction: column;
                gap: 0.25rem;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø³Ø¬Ù„ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 768px) {
            .records-filters-container {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .records-filters-row2 {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .records-stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }

            .records-table th,
            .records-table td {
                padding: 0.5rem 0.25rem;
                font-size: 0.8rem;
            }

            .records-pagination {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .records-action-buttons {
                justify-content: center;
            }

            #recordsTab h2 {
                font-size: 1.2rem !important;
                margin-bottom: 1rem !important;
                text-align: center;
            }

            /* Ø¥Ø®ÙØ§Ø¡ Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            .records-table .hide-mobile {
                display: none;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø³Ø¬Ù„ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
        @media (max-width: 480px) {
            .records-stats-grid {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }

            .records-table th,
            .records-table td {
                padding: 0.375rem 0.125rem;
                font-size: 0.75rem;
            }

            #recordsTab h2 {
                font-size: 1.1rem !important;
            }

            .card-neon {
                padding: 1rem !important;
                margin: 0 -0.5rem !important;
            }

            /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© */
            .records-table .hide-small {
                display: none;
            }

            .records-action-buttons {
                flex-direction: column;
                width: 100%;
            }

            .records-action-buttons button {
                width: 100%;
                justify-content: center;
            }

            /* ØªØ­Ø³ÙŠÙ† Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
            .records-stats-grid .card-neon {
                padding: 0.75rem !important;
                margin: 0 !important;
            }

            .records-stats-grid .card-neon > div:first-child {
                font-size: 1.5rem !important;
            }

            .records-stats-grid .card-neon > div:last-child {
                font-size: 0.8rem !important;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
        .settings-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 2rem;
        }

        .settings-sidebar {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            height: fit-content;
        }

        .settings-nav-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .settings-nav-btn {
            background: none;
            border: 1px solid rgba(0, 212, 255, 0.3);
            color: var(--primary-200);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: right;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            width: 100%;
        }

        .settings-nav-btn.active {
            background: rgba(0, 212, 255, 0.2);
            border-color: rgba(0, 212, 255, 0.3);
            color: var(--neon-blue);
        }

        .settings-nav-btn:hover {
            background: rgba(0, 212, 255, 0.1);
            transform: translateX(-2px);
        }

        .settings-content {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
        }

        .settings-form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .settings-section-title {
            color: var(--neon-blue);
            margin-bottom: 1rem;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .settings-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        .users-table-container {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid rgba(0, 212, 255, 0.3);
        }

        .users-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(0, 35, 102, 0.3);
        }

        .users-table th {
            padding: 1rem;
            text-align: right;
            color: var(--neon-blue);
            border-bottom: 1px solid rgba(0, 212, 255, 0.3);
        }

        .users-table td {
            padding: 1rem;
            border-bottom: 1px solid rgba(0, 212, 255, 0.1);
            color: white;
        }

        .users-table tbody tr:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„Ù„ØªØ§Ø¨Ù„Øª */
        @media (max-width: 1024px) and (min-width: 769px) {
            .settings-container {
                grid-template-columns: 200px 1fr;
                gap: 1.5rem;
            }

            .settings-sidebar {
                padding: 1rem;
            }

            .settings-content {
                padding: 1.5rem;
            }

            .settings-form-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .users-table th,
            .users-table td {
                padding: 0.75rem 0.5rem;
                font-size: 0.9rem;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 768px) {
            .settings-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .settings-sidebar {
                padding: 1rem;
                order: 2;
            }

            .settings-nav-buttons {
                flex-direction: row;
                overflow-x: auto;
                gap: 0.5rem;
                padding-bottom: 0.5rem;
            }

            .settings-nav-btn {
                white-space: nowrap;
                min-width: 150px;
                justify-content: center;
                text-align: center;
            }

            .settings-content {
                padding: 1rem;
                order: 1;
            }

            .settings-form-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .settings-actions {
                flex-direction: column;
                gap: 0.75rem;
            }

            .settings-actions button {
                width: 100%;
                justify-content: center;
            }

            #settingsTab h2 {
                font-size: 1.2rem !important;
                margin-bottom: 1rem !important;
                text-align: center;
                flex-direction: column;
                gap: 0.25rem;
            }

            .users-table th,
            .users-table td {
                padding: 0.5rem 0.25rem;
                font-size: 0.8rem;
            }

            /* Ø¥Ø®ÙØ§Ø¡ Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            .users-table .hide-mobile {
                display: none;
            }

            .users-table-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch !important;
            }

            .users-table-header button {
                width: 100%;
                justify-content: center;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
        @media (max-width: 480px) {
            .settings-sidebar {
                padding: 0.75rem;
                margin: 0 -0.5rem;
            }

            .settings-content {
                padding: 0.75rem;
                margin: 0 -0.5rem;
            }

            .settings-nav-btn {
                min-width: 120px;
                padding: 0.6rem 0.75rem;
                font-size: 0.85rem;
            }

            #settingsTab h2 {
                font-size: 1.1rem !important;
            }

            .users-table th,
            .users-table td {
                padding: 0.375rem 0.125rem;
                font-size: 0.75rem;
            }

            /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© */
            .users-table .hide-small {
                display: none;
            }

            .form-group {
                margin-bottom: 1rem;
            }

            .input-neon, select {
                padding: 0.75rem !important;
                font-size: 16px !important; /* Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¹Ù„Ù‰ iOS */
            }
        }
    </style>
</head>
<body>
    <!-- Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="loginScreen" class="login-container">
        <div class="login-card card-neon">
            <h1 class="login-title neon-text">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¥Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h1>
            
            <div id="loginNotification"></div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="text" id="loginEmail" class="input-neon" required value="admin" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="loginPassword" class="input-neon" required value="admin123" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                </div>
                
                <!-- Ù…Ø±Ø¨Ø¹ ØªØ°ÙƒØ±Ù†ÙŠ -->
                <div class="remember-me-container">
                    <input type="checkbox" id="rememberMe" class="remember-me-checkbox">
                    <label for="rememberMe" style="color: var(--primary-200); cursor: pointer;">ØªØ°ÙƒØ±Ù†ÙŠ</label>
                    <div style="flex: 1;"></div>
                    <a href="#" id="forgotPasswordLink" class="forgot-password-link">Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ</a>
                </div>
                
                <!-- Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø³ÙŠØ§Ù† - Ù…Ø­Ø°ÙˆÙ -->
                
                <button type="submit" id="loginBtn" class="btn-neon" style="width: 100%;">
                    <span id="loginBtnText">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
                    <div id="loginLoading" class="loading hidden"></div>
                </button>
            </form>
            
            <div class="mt-4 text-center text-sm text-gray">
                <p>Ø­Ø³Ø§Ø¨Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©:</p>
                <p>Ù…Ø¯ÙŠØ±: admin Ø£Ùˆ admin@company.com / admin123</p>
                <p>Ù…Ø´Ø±Ù: supervisor Ø£Ùˆ supervisor@company.com / super123</p>
                <p>Ù…ÙˆØ¸Ù: employee Ø£Ùˆ employee@company.com / emp123</p>
                <p style="margin-top: 0.5rem; color: var(--neon-blue);">ğŸ’¡ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</p>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ù†Ø³ÙŠØ§Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
    <div id="forgotPasswordModal" class="modal-overlay">
        <div class="modal-content">
            <h2 class="modal-title">ğŸ¤¦â€â™‚ï¸ Ø£ÙˆÙˆÙˆÙˆÙˆØ¨Ø³!</h2>
            <div id="forgotPasswordMessage" class="modal-message"></div>
            <div class="modal-buttons">
                <button class="modal-btn funny" onclick="closeForgotPasswordModal()">ğŸ˜‚ Ù‡Ù‡Ù‡Ù‡Ù‡Ù‡</button>
                <button class="modal-btn primary" onclick="resetPassword()">ÙŠÙ„Ø§ Ø¨ÙŠÙ†Ø§ Ù†ØºÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±! ğŸ”</button>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ© -->
    <div id="seasonalMessage" class="seasonal-message">
        <button class="close-btn" onclick="closeSeasonalMessage()">Ã—</button>
        <div id="seasonalMessageContent"></div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„ -->
    <div id="recordDetailsModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 600px;">
            <h2 class="modal-title">ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</h2>
            <div id="recordDetailsContent" class="modal-message" style="text-align: right;">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
            <div class="modal-buttons">
                <button class="modal-btn primary" onclick="closeRecordDetailsModal()">Ø¥ØºÙ„Ø§Ù‚</button>
                <button class="modal-btn" onclick="printRecordDetails()" style="background: rgba(0, 255, 136, 0.2); color: var(--neon-green);">
                    <i data-lucide="printer"></i>
                    Ø·Ø¨Ø§Ø¹Ø©
                </button>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div id="mainScreen" class="hidden">
        <div class="main-screen">
            <button id="logoutBtn" class="logout-btn">
                <i data-lucide="log-out"></i>
                Ø®Ø±ÙˆØ¬
            </button>
            
            <div class="welcome-message">
                <h1 class="neon-text">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¥Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h1>
                <p id="userWelcome" class="text-gray mt-4"></p>
            </div>
            
            <!-- Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                <!-- Ø£Ø±ØµØ¯Ø© Ù…Ù†ØªÙ‡ÙŠØ© -->
                <div class="card-neon" style="padding: 1.5rem; border-radius: 12px; background: linear-gradient(135deg, rgba(255, 68, 68, 0.1) 0%, rgba(255, 68, 68, 0.05) 100%); border-color: rgba(255, 68, 68, 0.3);">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div>
                            <h3 style="color: var(--neon-red); font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;" id="expiredBalances">0</h3>
                            <p style="color: var(--primary-200); font-size: 0.9rem;">Ø£Ø±ØµØ¯Ø© Ù…Ù†ØªÙ‡ÙŠØ©</p>
                        </div>
                        <div style="background: rgba(255, 68, 68, 0.2); border-radius: 50%; padding: 1rem;">
                            <i data-lucide="trending-down" style="width: 24px; height: 24px; color: var(--neon-red);"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ -->
                <div class="card-neon" style="padding: 1.5rem; border-radius: 12px; background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%); border-color: rgba(0, 255, 136, 0.3);">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div>
                            <h3 style="color: var(--neon-green); font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;" id="weekSaturdays">0</h3>
                            <p style="color: var(--primary-200); font-size: 0.9rem;">Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</p>
                        </div>
                        <div style="background: rgba(0, 255, 136, 0.2); border-radius: 50%; padding: 1rem;">
                            <i data-lucide="clock" style="width: 24px; height: 24px; color: var(--neon-green);"></i>
                        </div>
                    </div>
                </div>
                
                <!-- ÙÙŠ Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„ÙŠÙˆÙ… -->
                <div class="card-neon" style="padding: 1.5rem; border-radius: 12px; background: linear-gradient(135deg, rgba(255, 235, 59, 0.1) 0%, rgba(255, 235, 59, 0.05) 100%); border-color: rgba(255, 235, 59, 0.3);">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div>
                            <h3 style="color: var(--neon-yellow); font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;" id="todayLeaves">0</h3>
                            <p style="color: var(--primary-200); font-size: 0.9rem;">ÙÙŠ Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„ÙŠÙˆÙ…</p>
                        </div>
                        <div style="background: rgba(255, 235, 59, 0.2); border-radius: 50%; padding: 1rem;">
                            <i data-lucide="calendar" style="width: 24px; height: 24px; color: var(--neon-yellow);"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† -->
                <div class="card-neon" style="padding: 1.5rem; border-radius: 12px; background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(0, 212, 255, 0.05) 100%); border-color: rgba(0, 212, 255, 0.3);">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div>
                            <h3 style="color: var(--neon-blue); font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;" id="totalEmployees">0</h3>
                            <p style="color: var(--primary-200); font-size: 0.9rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</p>
                        </div>
                        <div style="background: rgba(0, 212, 255, 0.2); border-radius: 50%; padding: 1rem;">
                            <i data-lucide="users" style="width: 24px; height: 24px; color: var(--neon-blue);"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card-neon" style="padding: 2rem; border-radius: 12px;">
                <!-- Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù†Ø© -->
                <div class="tabs-container">
                    <div class="tabs-bar">
                        <!-- Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ù…ØªØ­Ø±Ùƒ -->
                        <div class="tab-indicator" id="tabIndicator"></div>
                        
                        <button class="tab-button active" data-tab="balances">
                            <i data-lucide="users"></i>
                            <span class="tab-text">Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø±ØµØ¯Ø©</span>
                        </button>
                        
                        <button class="tab-button" data-tab="record">
                            <i data-lucide="calendar-plus"></i>
                            <span class="tab-text">ØªØ³Ø¬ÙŠÙ„ Ø­Ø±ÙƒØ©</span>
                        </button>
                        
                        <button class="tab-button" data-tab="saturday">
                            <i data-lucide="clock"></i>
                            <span class="tab-text">Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª</span>
                        </button>
                        
                        <button class="tab-button" data-tab="employees">
                            <i data-lucide="user-plus"></i>
                            <span class="tab-text">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</span>
                        </button>
                        
                        <button class="tab-button" data-tab="records">
                            <i data-lucide="file-text"></i>
                            <span class="tab-text">Ø§Ù„Ø³Ø¬Ù„</span>
                        </button>
                        
                        <button class="tab-button" data-tab="settings">
                            <i data-lucide="settings"></i>
                            <span class="tab-text">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
                        </button>
                    </div>
                </div>

                <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
                <div id="tabContent">
                    <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø£Ø±ØµØ¯Ø© -->
                    <div id="balancesTab" class="tab-panel">
                        <h2 style="color: var(--neon-blue); margin-bottom: 1.5rem; font-size: 1.5rem;">Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h2>
                        <div id="balancesContent" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; overflow-y: visible;">
                            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                        </div>
                    </div>

                    <!-- ØªØ¨ÙˆÙŠØ¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ© -->
                    <div id="recordTab" class="tab-panel hidden">
                        <h2 style="color: var(--neon-blue); margin-bottom: 1.5rem; font-size: 1.5rem;">ØªØ³Ø¬ÙŠÙ„ Ø­Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©</h2>
                        
                        <div id="recordNotification"></div>
                        
                        <div class="record-tab-container">
                            <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
                            <div class="record-form-card">
                                <form id="recordForm">
                                    <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¸Ù -->
                                    <div class="form-group">
                                        <label class="form-label">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¸Ù</label>
                                        <select id="recordEmployee" class="input-neon" required>
                                            <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù --</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ© -->
                                    <div class="form-group">
                                        <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ©</label>
                                        <div class="leave-type-buttons">
                                            <button type="button" class="leave-type-btn active" data-type="regular">
                                                Ø¥Ø¬Ø§Ø²Ø© Ø§Ø¹ØªÙŠØ§Ø¯ÙŠØ©
                                            </button>
                                            <button type="button" class="leave-type-btn" data-type="emergency">
                                                Ø¥Ø¬Ø§Ø²Ø© Ø¹Ø§Ø±Ø¶Ø©
                                            </button>
                                            <button type="button" class="leave-type-btn" data-type="sick">
                                                Ø¥Ø¬Ø§Ø²Ø© Ù…Ø±Ø¶ÙŠØ©
                                            </button>
                                            <button type="button" class="leave-type-btn" data-type="permission">
                                                Ø¥Ø°Ù†
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ® -->
                                    <div id="dateFields">
                                        <div class="date-time-grid">
                                            <div class="form-group">
                                                <label class="form-label">Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                                                <input type="date" id="startDate" class="input-neon" required>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                                                <input type="date" id="endDate" class="input-neon" required>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Ø­Ù‚ÙˆÙ„ Ø§Ù„ÙˆÙ‚Øª (Ù„Ù„Ø£Ø°ÙˆÙ†Ø§Øª) -->
                                    <div id="timeFields" class="hidden">
                                        <div class="date-time-grid">
                                            <div class="form-group">
                                                <label class="form-label">Ù…Ù† Ø§Ù„Ø³Ø§Ø¹Ø©</label>
                                                <input type="time" id="startTime" class="input-neon">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Ø¥Ù„Ù‰ Ø§Ù„Ø³Ø§Ø¹Ø©</label>
                                                <input type="time" id="endTime" class="input-neon">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© -->
                                    <div id="calculatedDuration" class="hidden" style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <i data-lucide="clock" style="width: 20px; height: 20px; color: var(--neon-blue);"></i>
                                            <span id="durationText" style="color: var(--neon-blue); font-weight: 500;"></span>
                                        </div>
                                        <div id="permissionWarning" class="hidden" style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--neon-orange);">
                                            âš ï¸ Ø³ÙŠØªÙ… Ø®ØµÙ… Ø£ÙŠØ§Ù… Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ
                                        </div>
                                    </div>
                                    
                                    <!-- Ù…Ù„Ø§Ø­Ø¸Ø§Øª -->
                                    <div class="form-group">
                                        <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                                        <textarea id="recordNotes" class="input-neon" style="min-height: 80px; resize: vertical;" placeholder="Ø£Ø¶Ù Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..."></textarea>
                                    </div>
                                    
                                    <!-- Ø²Ø± Ø§Ù„Ø­ÙØ¸ -->
                                    <button type="submit" id="recordSubmitBtn" class="btn-neon" style="width: 100%;">
                                        <i data-lucide="save"></i>
                                        Ø­ÙØ¸ Ø§Ù„Ø­Ø±ÙƒØ©
                                    </button>
                                </form>
                            </div>
                            
                            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù -->
                            <div class="record-sidebar">
                                <div id="employeeBalance" class="card-neon hidden" style="padding: 1.5rem; border-radius: 8px;">
                                    <h3 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1.1rem;">Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…ÙˆØ¸Ù</h3>
                                    <div id="balanceInfo"></div>
                                </div>
                                
                                <!-- Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£Ù„ÙˆØ§Ù† -->
                                <div class="card-neon" style="padding: 1.5rem; border-radius: 8px;">
                                    <h3 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1.1rem;">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£Ù„ÙˆØ§Ù†</h3>
                                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                            <div style="width: 16px; height: 16px; border-radius: 50%; background: var(--neon-green);"></div>
                                            <span style="color: var(--primary-200); font-size: 0.9rem;">Ø¥Ø¬Ø§Ø²Ø© Ø§Ø¹ØªÙŠØ§Ø¯ÙŠØ©</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                            <div style="width: 16px; height: 16px; border-radius: 50%; background: var(--neon-yellow);"></div>
                                            <span style="color: var(--primary-200); font-size: 0.9rem;">Ø¥Ø¬Ø§Ø²Ø© Ø¹Ø§Ø±Ø¶Ø©</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                            <div style="width: 16px; height: 16px; border-radius: 50%; background: var(--neon-red);"></div>
                                            <span style="color: var(--primary-200); font-size: 0.9rem;">Ø¥Ø¬Ø§Ø²Ø© Ù…Ø±Ø¶ÙŠØ©</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <div style="width: 16px; height: 16px; border-radius: 50%; background: var(--neon-orange);"></div>
                                            <span style="color: var(--primary-200); font-size: 0.9rem;">Ø¥Ø°Ù† / Ø®ØµÙ… Ø£Ø°ÙˆÙ†Ø§Øª</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ÙˆÙŠØ¨ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª -->
                    <div id="saturdayTab" class="tab-panel hidden">
                        <h2 style="color: var(--neon-blue); margin-bottom: 1.5rem; font-size: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i data-lucide="clock" style="width: 24px; height: 24px;"></i>
                            Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª
                        </h2>
                        
                        <div id="saturdayNotification"></div>
                        
                        <div class="saturday-tab-container">
                            <!-- ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø¬Ø¯ÙŠØ¯ -->
                            <div class="saturday-form-card">
                                <h3 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1.1rem;">ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø¬Ø¯ÙŠØ¯</h3>
                                
                                <form id="saturdayAttendanceForm">
                                    <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¸Ù -->
                                    <div class="form-group">
                                        <label class="form-label">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¸Ù</label>
                                        <select id="attendanceEmployee" class="input-neon" required>
                                            <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù --</option>
                                        </select>
                                    </div>
                                    
                                    <!-- ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆÙ‚Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) -->
                                    <div class="form-group">
                                        <label class="form-label">ØªØ­Ø¯ÙŠØ¯ ÙˆÙ‚Øª Ø§Ù„Ø­Ø¶ÙˆØ± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ - Ø¥Ø°Ø§ ØªÙØ±Ùƒ ÙØ§Ø±ØºØ§Ù‹ Ø³ÙŠÙØ³ØªØ®Ø¯Ù… Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ)</label>
                                        <input type="time" id="customArrivalTime" class="input-neon" placeholder="Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ">
                                    </div>
                                    
                                    <!-- ØªØ­Ø¯ÙŠØ¯ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØµØ±Ø§Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) -->
                                    <div class="form-group" id="departureTimeGroup" style="display: none;">
                                        <label class="form-label">ØªØ­Ø¯ÙŠØ¯ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØµØ±Ø§Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ - Ø¥Ø°Ø§ ØªÙØ±Ùƒ ÙØ§Ø±ØºØ§Ù‹ Ø³ÙŠÙØ³ØªØ®Ø¯Ù… Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ)</label>
                                        <input type="time" id="customDepartureTime" class="input-neon" placeholder="Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ">
                                    </div>
                                    
                                    <!-- Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±/Ø§Ù„Ø§Ù†ØµØ±Ø§Ù -->
                                    <button type="submit" id="attendanceBtn" class="btn-neon" style="width: 100%; margin-bottom: 1rem;">
                                        <i data-lucide="play" id="attendanceIcon"></i>
                                        <span id="attendanceBtnText">ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±</span>
                                    </button>
                                </form>
                                
                                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³Ø±ÙŠØ¹Ø© -->
                                <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem;">
                                    <h4 style="color: var(--neon-blue); margin-bottom: 0.75rem; font-size: 1rem;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h4>
                                    
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span style="color: var(--primary-200);">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰</span>
                                        <span style="color: var(--neon-yellow); font-weight: bold;">8 Ø³Ø§Ø¹Ø§Øª</span>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span style="color: var(--primary-200);">Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø§Ù„ÙŠÙˆÙ…</span>
                                        <span style="color: var(--neon-green); font-weight: bold;" id="todayAttendees">0</span>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between;">
                                        <span style="color: var(--primary-200);">Ø§Ù„ØªØ§Ø±ÙŠØ®</span>
                                        <span style="color: var(--neon-blue); font-weight: bold;" id="currentDate"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹ -->
                            <div class="saturday-form-card">
                                <h3 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem;">
                                    <i data-lucide="clock" style="width: 20px; height: 20px;"></i>
                                    Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹
                                </h3>
                                
                                <div id="currentAttendees" style="max-height: 300px; overflow-y: auto;">
                                    <div style="text-align: center; padding: 2rem; color: var(--primary-200);">
                                        <i data-lucide="clock" style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;"></i>
                                        <p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ø­Ø§Ø¶Ø±ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ø³Ø¬Ù„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª -->
                        <div class="card-neon" style="padding: 1.5rem; border-radius: 8px;">
                            <h3 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1.1rem;">Ø³Ø¬Ù„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª</h3>
                            
                            <div style="overflow-x: auto;">
                                <table id="saturdayTable" style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="border-bottom: 1px solid rgba(0, 212, 255, 0.3);">
                                            <th style="padding: 0.75rem; text-align: right; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ù…ÙˆØ¸Ù</th>
                                            <th class="hide-mobile" style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                            <th style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ø­Ø¶ÙˆØ±</th>
                                            <th style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ø§Ù†ØµØ±Ø§Ù</th>
                                            <th style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ø³Ø§Ø¹Ø§Øª</th>
                                            <th class="hide-mobile" style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                        </tr>
                                    </thead>
                                    <tbody id="saturdayTableBody">
                                        <tr>
                                            <td colspan="6" style="text-align: center; padding: 3rem; color: var(--primary-200);">
                                                <i data-lucide="calendar" style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;"></i>
                                                <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ù…Ø³Ø¬Ù„Ø©</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† -->
                    <div id="employeesTab" class="tab-panel hidden">
                        <h2 style="color: var(--neon-blue); margin-bottom: 1.5rem; font-size: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i data-lucide="user-plus" style="width: 24px; height: 24px;"></i>
                            Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                        </h2>
                        
                        <div id="employeesNotification"></div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                            <!-- Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆØ¸Ù -->
                            <div class="card-neon" style="padding: 1.5rem; border-radius: 8px;">
                                <h3 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1.1rem;" id="employeeFormTitle">Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯</h3>
                                
                                <form id="employeeForm">
                                    <!-- Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù -->
                                    <div class="form-group">
                                        <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</label>
                                        <input type="text" id="employeeName" class="input-neon" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„ÙƒØ§Ù…Ù„">
                                    </div>
                                    
                                    <!-- Ø§Ù„Ù‚Ø³Ù… -->
                                    <div class="form-group">
                                        <label class="form-label">Ø§Ù„Ù‚Ø³Ù…</label>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <select id="employeeDepartment" class="input-neon" required style="flex: 1;">
                                                <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù… --</option>
                                            </select>
                                            <button type="button" id="manageDepartmentsBtn" class="btn-neon" style="padding: 0.75rem; width: auto;">
                                                <i data-lucide="settings"></i>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Ø§Ù„Ø£Ø±ØµØ¯Ø© -->
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                        <div class="form-group">
                                            <label class="form-label">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ</label>
                                            <input type="number" id="regularBalance" class="input-neon" min="0" max="60" value="30" required>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Ø±ØµÙŠØ¯ Ø§Ù„Ø¹Ø§Ø±Ø¶Ø©</label>
                                            <input type="number" id="emergencyBalance" class="input-neon" min="0" max="15" value="7" required>
                                        </div>
                                    </div>
                                    
                                    <!-- Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© -->
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                        <div class="form-group">
                                            <label class="form-label">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ</label>
                                            <input type="number" id="regularUsed" class="input-neon" min="0" value="0">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ø¹Ø§Ø±Ø¶Ø©</label>
                                            <input type="number" id="emergencyUsed" class="input-neon" min="0" value="0">
                                        </div>
                                    </div>
                                    
                                    <!-- Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª ÙˆØ§Ù„Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„Ù…Ø±Ø¶ÙŠØ© -->
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                        <div class="form-group">
                                            <label class="form-label">Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª</label>
                                            <input type="number" id="permissionHours" class="input-neon" min="0" value="0">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„Ù…Ø±Ø¶ÙŠØ©</label>
                                            <input type="number" id="sickUsed" class="input-neon" min="0" value="0">
                                        </div>
                                    </div>
                                    
                                    <!-- ØµÙˆØ±Ø© Ø§Ù„Ù…ÙˆØ¸Ù -->
                                    <div class="form-group">
                                        <label class="form-label">ØµÙˆØ±Ø© Ø§Ù„Ù…ÙˆØ¸Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                                        <div style="display: flex; align-items: center; gap: 1rem;">
                                            <input type="file" id="employeePhoto" class="input-neon" accept="image/*" style="flex: 1;">
                                            <div id="photoPreview" class="hidden" style="width: 60px; height: 60px; border-radius: 50%; overflow: hidden; border: 2px solid var(--neon-blue);">
                                                <img id="previewImg" style="width: 100%; height: 100%; object-fit: cover;">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Ù…Ù„Ø§Ø­Ø¸Ø§Øª -->
                                    <div class="form-group">
                                        <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                                        <textarea id="employeeNotes" class="input-neon" style="min-height: 80px; resize: vertical;" placeholder="Ø£Ø¶Ù Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸Ù..."></textarea>
                                    </div>
                                    
                                    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­ÙØ¸ ÙˆØ§Ù„Ø¥Ù„ØºØ§Ø¡ -->
                                    <div style="display: flex; gap: 1rem;">
                                        <button type="submit" id="saveEmployeeBtn" class="btn-neon" style="flex: 1;">
                                            <i data-lucide="save"></i>
                                            <span id="saveEmployeeBtnText">Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¸Ù</span>
                                        </button>
                                        <button type="button" id="cancelEmployeeBtn" class="hidden" style="flex: 1; background: rgba(255, 68, 68, 0.2); border: 1px solid rgba(255, 68, 68, 0.5); color: #ff4444; padding: 0.75rem 1.5rem; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
                                            <i data-lucide="x"></i>
                                            Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
                                        </button>
                                    </div>
                                </form>
                            </div>
                            
                            <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© -->
                            <div class="card-neon" style="padding: 1.5rem; border-radius: 8px;">
                                <h3 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1.1rem;">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                    <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem; text-align: center;">
                                        <div style="color: var(--neon-blue); font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem;" id="totalEmployeesCount">0</div>
                                        <div style="color: var(--primary-200); font-size: 0.9rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</div>
                                    </div>
                                    
                                    <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem; text-align: center;">
                                        <div style="color: var(--neon-red); font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem;" id="lowBalanceCount">0</div>
                                        <div style="color: var(--primary-200); font-size: 0.9rem;">Ø£Ø±ØµØ¯Ø© Ù…Ù†Ø®ÙØ¶Ø©</div>
                                    </div>
                                    
                                    <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem; text-align: center;">
                                        <div style="color: var(--neon-green); font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem;" id="activeDepartments">0</div>
                                        <div style="color: var(--primary-200); font-size: 0.9rem;">Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù†Ø´Ø·Ø©</div>
                                    </div>
                                    
                                    <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem; text-align: center;">
                                        <div style="color: var(--neon-yellow); font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem;" id="avgBalance">0</div>
                                        <div style="color: var(--primary-200); font-size: 0.9rem;">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±ØµÙŠØ¯</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ø¨Ø·Ø§Ù‚Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ© -->
                        <div class="card-neon" style="padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                            <h3 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i data-lucide="rotate-ccw" style="width: 20px; height: 20px;"></i>
                                Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ©
                            </h3>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                                <div>
                                    <div style="margin-bottom: 0.75rem;">
                                        <span style="color: var(--primary-200); font-size: 0.9rem;">Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</span>
                                        <div style="color: var(--neon-blue); font-weight: bold;" id="currentFiscalYear">2024-2025</div>
                                    </div>
                                    <div style="margin-bottom: 0.75rem;">
                                        <span style="color: var(--primary-200); font-size: 0.9rem;">Ø¢Ø®Ø± Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†:</span>
                                        <div style="color: var(--neon-green); font-weight: bold;" id="lastResetDate">Ù„Ù… ÙŠØªÙ… Ø¨Ø¹Ø¯</div>
                                    </div>
                                </div>
                                <div>
                                    <div style="margin-bottom: 0.75rem;">
                                        <span style="color: var(--primary-200); font-size: 0.9rem;">Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                                        <div style="font-weight: bold;" id="resetStatus">
                                            <span style="color: var(--neon-yellow);">âš ï¸ Ù…Ø·Ù„ÙˆØ¨</span>
                                        </div>
                                    </div>
                                    <div>
                                        <span style="color: var(--primary-200); font-size: 0.9rem;">Ù…ØªØ¨Ù‚ÙŠ Ø¹Ù„Ù‰ 1 ÙŠÙˆÙ„ÙŠÙˆ:</span>
                                        <div style="color: var(--neon-orange); font-weight: bold;" id="daysUntilJuly">-- ÙŠÙˆÙ…</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 1rem;">
                                <button id="resetBalancesBtn" class="btn-neon" style="flex: 1;">
                                    <i data-lucide="rotate-ccw"></i>
                                    Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø©
                                </button>
                                <button id="viewResetHistoryBtn" class="btn-neon" style="flex: 1; background: rgba(0, 212, 255, 0.1); border-color: rgba(0, 212, 255, 0.3);">
                                    <i data-lucide="history"></i>
                                    Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„ØªØ¹ÙŠÙŠÙ†
                                </button>
                            </div>
                        </div>
                        
                        <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† -->
                        <div class="card-neon" style="padding: 1.5rem; border-radius: 8px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 1rem;">
                                <h3 style="color: var(--neon-blue); font-size: 1.1rem;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h3>
                                <div style="display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap;">
                                    <select id="departmentFilter" class="input-neon" style="width: 150px;">
                                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>
                                        <option value="ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª">ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
                                        <option value="Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©">Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
                                        <option value="Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</option>
                                        <option value="Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©">Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©</option>
                                        <option value="Ø§Ù„ØªØ³ÙˆÙŠÙ‚">Ø§Ù„ØªØ³ÙˆÙŠÙ‚</option>
                                        <option value="Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</option>
                                        <option value="Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡">Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</option>
                                        <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                                    </select>
                                    <select id="sortColumn" class="input-neon" style="width: 150px;">
                                        <option value="name">ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø§Ø³Ù…</option>
                                        <option value="department">ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…</option>
                                        <option value="regularBalance">ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø±ØµÙŠØ¯</option>
                                        <option value="createdAt">ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®</option>
                                    </select>
                                    <button id="sortDirection" class="btn-neon" style="padding: 0.5rem; width: auto;">
                                        <i data-lucide="arrow-up" id="sortIcon"></i>
                                    </button>
                                    <input type="text" id="searchEmployee" class="input-neon" placeholder="Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆØ¸Ù..." style="width: 200px;">
                                </div>
                            </div>
                            
                            <div style="overflow-x: auto;">
                                <table id="employeesTable" style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="border-bottom: 1px solid rgba(0, 212, 255, 0.3);">
                                            <th style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600; width: 60px;">Ø§Ù„ØµÙˆØ±Ø©</th>
                                            <th style="padding: 0.75rem; text-align: right; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ø§Ø³Ù…</th>
                                            <th style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ù‚Ø³Ù…</th>
                                            <th style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ</th>
                                            <th style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø±ØµÙŠØ¯ Ø§Ù„Ø¹Ø§Ø±Ø¶Ø©</th>
                                            <th style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª</th>
                                            <th style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                            <th style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: 600;">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                        </tr>
                                    </thead>
                                    <tbody id="employeesTableBody">
                                        <tr>
                                            <td colspan="8" style="text-align: center; padding: 3rem; color: var(--primary-200);">
                                                <i data-lucide="users" style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;"></i>
                                                <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ†</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- ØªØ±Ù‚ÙŠÙ… Ø§Ù„ØµÙØ­Ø§Øª -->
                            <div id="pagination" class="hidden" style="display: flex; justify-content: center; align-items: center; gap: 1rem; margin-top: 1rem;">
                                <button id="prevPage" class="btn-neon" style="padding: 0.5rem 1rem;">
                                    <i data-lucide="chevron-right"></i>
                                    Ø§Ù„Ø³Ø§Ø¨Ù‚
                                </button>
                                <span id="pageInfo" style="color: var(--primary-200); font-size: 0.9rem;">ØµÙØ­Ø© 1 Ù…Ù† 1</span>
                                <button id="nextPage" class="btn-neon" style="padding: 0.5rem 1rem;">
                                    Ø§Ù„ØªØ§Ù„ÙŠ
                                    <i data-lucide="chevron-left"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø³Ø¬Ù„ -->
                    <div id="recordsTab" class="tab-panel hidden">
                        <h2 style="color: var(--neon-blue); margin-bottom: 1.5rem; font-size: 1.5rem;">ğŸ“œ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø´Ø§Ù…Ù„</h2>
                        
                        <!-- Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±Ø© -->
                        <div class="card-neon" style="padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem;">
                            <div class="records-filters-container">
                                <!-- Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹ -->
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--primary-200); font-size: 0.9rem;">ğŸ” Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹</label>
                                    <input type="text" id="recordsSearch" class="input-neon" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©..." style="font-size: 0.9rem;">
                                </div>
                                
                                <!-- ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„ØªØ§Ø±ÙŠØ® Ù…Ù† -->
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--primary-200); font-size: 0.9rem;">ğŸ“… Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                                    <input type="date" id="recordsDateFrom" class="input-neon" style="font-size: 0.9rem;">
                                </div>
                                
                                <!-- ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¥Ù„Ù‰ -->
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--primary-200); font-size: 0.9rem;">ğŸ“… Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                                    <input type="date" id="recordsDateTo" class="input-neon" style="font-size: 0.9rem;">
                                </div>
                            </div>
                            
                            <div class="records-filters-row2">
                                <!-- ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„Ù…ÙˆØ¸Ù -->
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--primary-200); font-size: 0.9rem;">ğŸ‘¤ Ø§Ù„Ù…ÙˆØ¸Ù</label>
                                    <select id="recordsEmployeeFilter" class="input-neon" style="font-size: 0.9rem;">
                                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</option>
                                    </select>
                                </div>
                                
                                <!-- ÙÙ„ØªØ±Ø© Ø¨Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© -->
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--primary-200); font-size: 0.9rem;">ğŸ“ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</label>
                                    <select id="recordsTypeFilter" class="input-neon" style="font-size: 0.9rem;">
                                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</option>
                                        <option value="regular">Ø¥Ø¬Ø§Ø²Ø© Ø§Ø¹ØªÙŠØ§Ø¯ÙŠØ©</option>
                                        <option value="emergency">Ø¥Ø¬Ø§Ø²Ø© Ø¹Ø§Ø±Ø¶Ø©</option>
                                        <option value="sick">Ø¥Ø¬Ø§Ø²Ø© Ù…Ø±Ø¶ÙŠØ©</option>
                                        <option value="permission">Ø¥Ø°Ù†</option>
                                        <option value="saturday">Ù†ÙˆØ¨ØªØ¬ÙŠØ© Ø³Ø¨Øª</option>
                                    </select>
                                </div>
                                
                                <!-- ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--primary-200); font-size: 0.9rem;">ğŸ‘¨â€ğŸ’¼ Ø§Ù„Ù…Ø³Ø¬Ù„</label>
                                    <select id="recordsUserFilter" class="input-neon" style="font-size: 0.9rem;">
                                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</option>
                                        <option value="admin">Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…</option>
                                        <option value="supervisor">Ø§Ù„Ù…Ø´Ø±Ù</option>
                                    </select>
                                </div>
                                
                                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                                <div class="records-action-buttons">
                                    <button id="clearRecordsFilters" class="btn-neon" style="padding: 0.75rem; background: rgba(255, 68, 68, 0.2); border-color: var(--neon-red); color: var(--neon-red);" title="Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±">
                                        <i data-lucide="x"></i>
                                    </button>
                                    <button id="refreshRecords" class="btn-neon" style="padding: 0.75rem;" title="ØªØ­Ø¯ÙŠØ«">
                                        <i data-lucide="rotate-ccw"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø© -->
                        <div class="records-stats-grid">
                            <!-- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª -->
                            <div class="card-neon" style="padding: 1rem; border-radius: 8px; text-align: center; background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(0, 212, 255, 0.05) 100%); border-color: rgba(0, 212, 255, 0.3);">
                                <div style="font-size: 2rem; font-weight: bold; color: var(--neon-blue); margin-bottom: 0.5rem;" id="totalRecordsCount">0</div>
                                <div style="color: var(--primary-200); font-size: 0.9rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</div>
                            </div>
                            
                            <!-- Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ… -->
                            <div class="card-neon" style="padding: 1rem; border-radius: 8px; text-align: center; background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%); border-color: rgba(0, 255, 136, 0.3);">
                                <div style="font-size: 2rem; font-weight: bold; color: var(--neon-green); margin-bottom: 0.5rem;" id="todayRecordsCount">0</div>
                                <div style="color: var(--primary-200); font-size: 0.9rem;">Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                            </div>
                            
                            <!-- Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ -->
                            <div class="card-neon" style="padding: 1rem; border-radius: 8px; text-align: center; background: linear-gradient(135deg, rgba(255, 235, 59, 0.1) 0%, rgba(255, 235, 59, 0.05) 100%); border-color: rgba(255, 235, 59, 0.3);">
                                <div style="font-size: 2rem; font-weight: bold; color: var(--neon-yellow); margin-bottom: 0.5rem;" id="weekRecordsCount">0</div>
                                <div style="color: var(--primary-200); font-size: 0.9rem;">Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
                            </div>
                            
                            <!-- Ø£ÙƒØ«Ø± Ù†ÙˆØ¹ Ø¹Ù…Ù„ÙŠØ© -->
                            <div class="card-neon" style="padding: 1rem; border-radius: 8px; text-align: center; background: linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(255, 152, 0, 0.05) 100%); border-color: rgba(255, 152, 0, 0.3);">
                                <div style="font-size: 1.2rem; font-weight: bold; color: var(--neon-orange); margin-bottom: 0.5rem;" id="mostCommonType">-</div>
                                <div style="color: var(--primary-200); font-size: 0.9rem;">Ø£ÙƒØ«Ø± Ù†ÙˆØ¹ Ø¹Ù…Ù„ÙŠØ©</div>
                            </div>
                        </div>
                        
                        <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª -->
                        <div class="card-neon" style="padding: 1.5rem; border-radius: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <h3 style="color: var(--neon-blue); font-size: 1.1rem;">ğŸ“‹ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</h3>
                                <div class="records-action-buttons">
                                    <button id="exportRecordsExcel" class="btn-neon" style="padding: 0.5rem 1rem; font-size: 0.9rem; background: rgba(0, 255, 136, 0.2); border-color: var(--neon-green); color: var(--neon-green);">
                                        <i data-lucide="file-text"></i>
                                        Excel
                                    </button>
                                    <button id="printRecords" class="btn-neon" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
                                        <i data-lucide="printer"></i>
                                        Ø·Ø¨Ø§Ø¹Ø©
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
                            <div class="records-table-container">
                                <table id="recordsTable" class="records-table">
                                    <thead>
                                        <tr style="background: rgba(0, 35, 102, 0.5);">
                                            <th data-sort="date">
                                                ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ® <i data-lucide="arrow-up-down" style="width: 14px; height: 14px; margin-right: 0.5rem;"></i>
                                            </th>
                                            <th data-sort="employee">
                                                ğŸ‘¤ Ø§Ù„Ù…ÙˆØ¸Ù <i data-lucide="arrow-up-down" style="width: 14px; height: 14px; margin-right: 0.5rem;"></i>
                                            </th>
                                            <th data-sort="type">
                                                ğŸ“ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© <i data-lucide="arrow-up-down" style="width: 14px; height: 14px; margin-right: 0.5rem;"></i>
                                            </th>
                                            <th class="hide-mobile" style="text-align: center;">
                                                â±ï¸ Ø§Ù„Ù…Ø¯Ø©
                                            </th>
                                            <th class="hide-small" style="text-align: center;">
                                                ğŸ“Š Ø§Ù„Ø±ØµÙŠØ¯
                                            </th>
                                            <th class="hide-mobile" style="text-align: right;">
                                                ğŸ‘¨â€ğŸ’¼ Ø§Ù„Ù…Ø³Ø¬Ù„
                                            </th>
                                            <th style="text-align: center;">
                                                ğŸ”§ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="recordsTableBody">
                                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- ØªØ±Ù‚ÙŠÙ… Ø§Ù„ØµÙØ­Ø§Øª -->
                            <div class="records-pagination">
                                <div style="color: var(--primary-200); font-size: 0.9rem;">
                                    Ø¹Ø±Ø¶ <span id="recordsShowingFrom">1</span> - <span id="recordsShowingTo">10</span> Ù…Ù† <span id="recordsTotal">0</span> Ø³Ø¬Ù„
                                </div>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button id="recordsPrevPage" class="btn-neon" style="padding: 0.5rem 1rem; font-size: 0.9rem;" disabled>
                                        <i data-lucide="chevron-right"></i>
                                        Ø§Ù„Ø³Ø§Ø¨Ù‚
                                    </button>
                                    <span id="recordsPageInfo" style="color: var(--primary-200); padding: 0.5rem 1rem; font-size: 0.9rem;">ØµÙØ­Ø© 1 Ù…Ù† 1</span>
                                    <button id="recordsNextPage" class="btn-neon" style="padding: 0.5rem 1rem; font-size: 0.9rem;" disabled>
                                        Ø§Ù„ØªØ§Ù„ÙŠ
                                        <i data-lucide="chevron-left"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª -->
                    <div id="settingsTab" class="tab-panel hidden">
                        <h2 style="color: var(--neon-blue); margin-bottom: 1.5rem; font-size: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i data-lucide="settings" style="width: 24px; height: 24px;"></i>
                            Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                        </h2>
                        
                        <div id="settingsNotification"></div>
                        
                        <div class="settings-container">
                            <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© -->
                            <div class="settings-sidebar">
                                <h3 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1.1rem;">ğŸ“‹ Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
                                
                                <div class="settings-nav-buttons">
                                    <button class="settings-nav-btn active" data-section="general">
                                        <i data-lucide="settings" style="width: 16px; height: 16px;"></i>
                                        Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
                                    </button>
                                    
                                    <button class="settings-nav-btn" data-section="users">
                                        <i data-lucide="users" style="width: 16px; height: 16px;"></i>
                                        Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                                    </button>
                                    
                                    <button class="settings-nav-btn" data-section="permissions">
                                        <i data-lucide="user" style="width: 16px; height: 16px;"></i>
                                        Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Ø±
                                    </button>
                                    
                                    <button class="settings-nav-btn" data-section="security">
                                        <i data-lucide="alert-triangle" style="width: 16px; height: 16px;"></i>
                                        Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø­Ù…Ø§ÙŠØ©
                                    </button>
                                    
                                    <button class="settings-nav-btn" data-section="backup">
                                        <i data-lucide="save" style="width: 16px; height: 16px;"></i>
                                        Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
                            <div>
                                <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© -->
                                <div id="generalSettings" class="settings-section">
                                    <div class="settings-content">
                                        <h3 style="color: var(--neon-blue); margin-bottom: 1.5rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                                            <i data-lucide="settings" style="width: 20px; height: 20px;"></i>
                                            Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
                                        </h3>
                                        
                                        <form id="generalSettingsForm">
                                            <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© -->
                                            <div style="margin-bottom: 2rem;">
                                                <h4 class="settings-section-title">
                                                    ğŸ“… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©
                                                </h4>
                                                
                                                <div class="settings-form-grid">
                                                    <div class="form-group">
                                                        <label class="form-label">Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</label>
                                                        <select id="fiscalYearStart" class="input-neon">
                                                            <option value="7">ÙŠÙˆÙ„ÙŠÙˆ (Ø§Ù„Ø´Ù‡Ø± 7)</option>
                                                            <option value="1">ÙŠÙ†Ø§ÙŠØ± (Ø§Ù„Ø´Ù‡Ø± 1)</option>
                                                            <option value="4">Ø£Ø¨Ø±ÙŠÙ„ (Ø§Ù„Ø´Ù‡Ø± 4)</option>
                                                            <option value="10">Ø£ÙƒØªÙˆØ¨Ø± (Ø§Ù„Ø´Ù‡Ø± 10)</option>
                                                        </select>
                                                    </div>
                                                    
                                                    <div class="form-group">
                                                        <label class="form-label">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯</label>
                                                        <select id="defaultBalance" class="input-neon">
                                                            <option value="30">30 ÙŠÙˆÙ…</option>
                                                            <option value="45">45 ÙŠÙˆÙ…</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¸Ù‡Ø± -->
                                            <div style="margin-bottom: 2rem;">
                                                <h4 class="settings-section-title">
                                                    ğŸ¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¸Ù‡Ø±
                                                </h4>
                                                
                                                <div class="settings-form-grid">
                                                    <div class="form-group">
                                                        <label class="form-label">Ø§Ù„Ù„ØºØ©</label>
                                                        <select id="systemLanguage" class="input-neon">
                                                            <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                                                            <option value="en">English</option>
                                                        </select>
                                                    </div>
                                                    
                                                    <div class="form-group">
                                                        <label class="form-label">Ø­Ø¬Ù… Ø§Ù„Ø®Ø·</label>
                                                        <select id="fontSize" class="input-neon">
                                                            <option value="small">ØµØºÙŠØ±</option>
                                                            <option value="medium" selected>Ù…ØªÙˆØ³Ø·</option>
                                                            <option value="large">ÙƒØ¨ÙŠØ±</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
                                            <div style="margin-bottom: 2rem;">
                                                <h4 class="settings-section-title">
                                                    ğŸ“§ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                                                </h4>
                                                
                                                <div class="settings-form-grid">
                                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                        <input type="checkbox" id="emailNotifications" checked style="width: 18px; height: 18px; accent-color: var(--neon-blue);">
                                                        <label for="emailNotifications" style="color: var(--primary-200); cursor: pointer;">Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                                                    </div>
                                                    
                                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                        <input type="checkbox" id="lowBalanceAlerts" checked style="width: 18px; height: 18px; accent-color: var(--neon-blue);">
                                                        <label for="lowBalanceAlerts" style="color: var(--primary-200); cursor: pointer;">ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ù†Ø®ÙØ¶Ø©</label>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­ÙØ¸ -->
                                            <div class="settings-actions">
                                                <button type="button" id="resetGeneralSettings" style="background: rgba(255, 68, 68, 0.2); border: 1px solid rgba(255, 68, 68, 0.5); color: #ff4444; padding: 0.75rem 1.5rem; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
                                                    <i data-lucide="rotate-ccw"></i>
                                                    Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                                                </button>
                                                <button type="submit" class="btn-neon">
                                                    <i data-lucide="save"></i>
                                                    Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                
                                <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† -->
                                <div id="usersSettings" class="settings-section hidden">
                                    <div class="settings-content">
                                        <div class="users-table-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                                            <h3 style="color: var(--neon-blue); font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                                                <i data-lucide="users" style="width: 20px; height: 20px;"></i>
                                                Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                                            </h3>
                                            <button id="addNewUser" class="btn-neon" style="padding: 0.75rem 1rem;">
                                                <i data-lucide="user-plus"></i>
                                                Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
                                            </button>
                                        </div>
                                        
                                        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† -->
                                        <div class="users-table-container">
                                            <table id="usersTable" class="users-table">
                                                <thead>
                                                    <tr style="background: rgba(0, 35, 102, 0.5);">
                                                        <th>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…</th>
                                                        <th class="hide-mobile">ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th>
                                                        <th style="text-align: center;">ğŸ­ Ø§Ù„Ø¯ÙˆØ±</th>
                                                        <th class="hide-small" style="text-align: center;">ğŸ“Š Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                                        <th style="text-align: center;">ğŸ”§ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="usersTableBody">
                                                    <!-- Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠÙŠÙ† -->
                                                    <tr>
                                                        <td style="font-weight: bold;">Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…</td>
                                                        <td class="hide-mobile" style="color: var(--primary-200);">admin@company.com</td>
                                                        <td style="text-align: center;">
                                                            <span style="background: linear-gradient(45deg, var(--neon-blue), var(--primary-600)); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">Ù…Ø¯ÙŠØ± Ø¹Ø§Ù…</span>
                                                        </td>
                                                        <td class="hide-small" style="text-align: center;">
                                                            <span style="background: rgba(0, 255, 136, 0.2); color: var(--neon-green); padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">Ù†Ø´Ø·</span>
                                                        </td>
                                                        <td style="text-align: center;">
                                                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                                                <button class="btn-neon" style="padding: 0.5rem; font-size: 0.8rem;" title="\u062A\u0639\u062F\u064A\u0644">
                                                                    <i data-lucide="edit-2"></i>
                                                                </button>
                                                                <button style="background: rgba(255, 68, 68, 0.2); border: 1px solid rgba(255, 68, 68, 0.5); color: #ff4444; padding: 0.5rem; border-radius: 6px; cursor: pointer;" title="\u062D\u0630\u0641">
                                                                    <i data-lucide="trash-2"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="font-weight: bold;">Ø§Ù„Ù…Ø´Ø±Ù</td>
                                                        <td class="hide-mobile" style="color: var(--primary-200);">supervisor@company.com</td>
                                                        <td style="text-align: center;">
                                                            <span style="background: linear-gradient(45deg, var(--neon-yellow), var(--neon-orange)); color: var(--primary-900); padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">Ù…Ø´Ø±Ù</span>
                                                        </td>
                                                        <td class="hide-small" style="text-align: center;">
                                                            <span style="background: rgba(0, 255, 136, 0.2); color: var(--neon-green); padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">Ù†Ø´Ø·</span>
                                                        </td>
                                                        <td style="text-align: center;">
                                                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                                                <button class="btn-neon" style="padding: 0.5rem; font-size: 0.8rem;" title="\u062A\u0639\u062F\u064A\u0644">
                                                                    <i data-lucide="edit-2"></i>
                                                                </button>
                                                                <button style="background: rgba(255, 68, 68, 0.2); border: 1px solid rgba(255, 68, 68, 0.5); color: #ff4444; padding: 0.5rem; border-radius: 6px; cursor: pointer;" title="\u062D\u0630\u0641">
                                                                    <i data-lucide="trash-2"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="font-weight: bold;">Ø§Ù„Ù…ÙˆØ¸Ù</td>
                                                        <td class="hide-mobile" style="color: var(--primary-200);">employee@company.com</td>
                                                        <td style="text-align: center;">
                                                            <span style="background: rgba(255, 255, 255, 0.2); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">Ù…ÙˆØ¸Ù</span>
                                                        </td>
                                                        <td class="hide-small" style="text-align: center;">
                                                            <span style="background: rgba(0, 255, 136, 0.2); color: var(--neon-green); padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">Ù†Ø´Ø·</span>
                                                        </td>
                                                        <td style="text-align: center;">
                                                            <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                                                <button class="btn-neon" style="padding: 0.5rem; font-size: 0.8rem;" title="\u062A\u0639\u062F\u064A\u0644">
                                                                    <i data-lucide="edit-2"></i>
                                                                </button>
                                                                <button style="background: rgba(255, 68, 68, 0.2); border: 1px solid rgba(255, 68, 68, 0.5); color: #ff4444; padding: 0.5rem; border-radius: 6px; cursor: pointer;" title="\u062D\u0630\u0641"></button>
                                                                    <i data-lucide="trash-2"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Ø± -->
                                <div id="permissionsSettings" class="settings-section hidden">
                                    <div class="card-neon" style="padding: 2rem; border-radius: 12px;">
                                        <h3 style="color: var(--neon-blue); margin-bottom: 1.5rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                                            <i data-lucide="user" style="width: 20px; height: 20px;"></i>
                                            Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Ø±
                                        </h3>
                                        
                                        <!-- Ù…ØµÙÙˆÙØ© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª -->
                                        <div style="overflow-x: auto; border-radius: 8px; border: 1px solid rgba(0, 212, 255, 0.3);">
                                            <table style="width: 100%; border-collapse: collapse; background: rgba(0, 35, 102, 0.3);">
                                                <thead>
                                                    <tr style="background: rgba(0, 35, 102, 0.5);">
                                                        <th style="padding: 1rem; text-align: right; color: var(--neon-blue); border-bottom: 1px solid rgba(0, 212, 255, 0.3);">ğŸ”§ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</th>
                                                        <th style="padding: 1rem; text-align: center; color: var(--neon-blue); border-bottom: 1px solid rgba(0, 212, 255, 0.3);">ğŸ‘‘ Ù…Ø¯ÙŠØ± Ø¹Ø§Ù…</th>
                                                        <th style="padding: 1rem; text-align: center; color: var(--neon-blue); border-bottom: 1px solid rgba(0, 212, 255, 0.3);">ğŸ‘¨â€ğŸ’¼ Ù…Ø´Ø±Ù</th>
                                                        <th style="padding: 1rem; text-align: center; color: var(--neon-blue); border-bottom: 1px solid rgba(0, 212, 255, 0.3);">ğŸ‘¤ Ù…ÙˆØ¸Ù</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr style="border-bottom: 1px solid rgba(0, 212, 255, 0.1);">
                                                        <td style="padding: 1rem; color: white;">Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±ØµØ¯Ø©</td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                    </tr>
                                                    <tr style="border-bottom: 1px solid rgba(0, 212, 255, 0.1);">
                                                        <td style="padding: 1rem; color: white;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª</td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                    </tr>
                                                    <tr style="border-bottom: 1px solid rgba(0, 212, 255, 0.1);">
                                                        <td style="padding: 1rem; color: white;">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="alert-circle" style="color: var(--neon-yellow);" title="Ù‚Ø³Ù…Ù‡ ÙÙ‚Ø·"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                    </tr>
                                                    <tr style="border-bottom: 1px solid rgba(0, 212, 255, 0.1);">
                                                        <td style="padding: 1rem; color: white;">Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="alert-circle" style="color: var(--neon-yellow);" title="Ù‚Ø³Ù…Ù‡ ÙÙ‚Ø·"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                    </tr>
                                                    <tr style="border-bottom: 1px solid rgba(0, 212, 255, 0.1);">
                                                        <td style="padding: 1rem; color: white;">ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                    </tr>
                                                    <tr style="border-bottom: 1px solid rgba(0, 212, 255, 0.1);">
                                                        <td style="padding: 1rem; color: white;">Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                    </tr>
                                                    <tr style="border-bottom: 1px solid rgba(0, 212, 255, 0.1);">
                                                        <td style="padding: 1rem; color: white;">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                    </tr>
                                                    <tr>
                                                        <td style="padding: 1rem; color: white;">Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="check-circle" style="color: var(--neon-green);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                        <td style="padding: 1rem; text-align: center;"><i data-lucide="x-circle" style="color: var(--neon-red);"></i></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        
                                        <!-- Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª -->
                                        <div style="margin-top: 1.5rem; background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 8px; padding: 1rem;">
                                            <h4 style="color: var(--neon-blue); margin-bottom: 0.75rem;">ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</h4>
                                            <ul style="color: var(--primary-200); margin: 0; padding-right: 1.5rem; line-height: 1.6;">
                                                <li><i data-lucide="check-circle" style="color: var(--neon-green); width: 14px; height: 14px;"></i> = ØµÙ„Ø§Ø­ÙŠØ© ÙƒØ§Ù…Ù„Ø©</li>
                                                <li><i data-lucide="alert-circle" style="color: var(--neon-yellow); width: 14px; height: 14px;"></i> = ØµÙ„Ø§Ø­ÙŠØ© Ù…Ø­Ø¯ÙˆØ¯Ø© (Ù‚Ø³Ù…Ù‡ ÙÙ‚Ø·)</li>
                                                <li><i data-lucide="x-circle" style="color: var(--neon-red); width: 14px; height: 14px;"></i> = Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙ„Ø§Ø­ÙŠØ©</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø­Ù…Ø§ÙŠØ© -->
                                <div id="securitySettings" class="settings-section hidden">
                                    <div class="card-neon" style="padding: 2rem; border-radius: 12px;">
                                        <h3 style="color: var(--neon-blue); margin-bottom: 1.5rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                                            <i data-lucide="alert-triangle" style="width: 20px; height: 20px;"></i>
                                            Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø­Ù…Ø§ÙŠØ©
                                        </h3>
                                        
                                        <div style="display: grid; gap: 2rem;">
                                            <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± -->
                                            <div>
                                                <h4 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1rem;">ğŸ” Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±</h4>
                                                <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1.5rem;">
                                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                                        <div class="form-group">
                                                            <label class="form-label">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ø·ÙˆÙ„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                                                            <select id="minPasswordLength" class="input-neon">
                                                                <option value="6">6 Ø£Ø­Ø±Ù</option>
                                                                <option value="8" selected>8 Ø£Ø­Ø±Ù</option>
                                                                <option value="10">10 Ø£Ø­Ø±Ù</option>
                                                                <option value="12">12 Ø­Ø±Ù</option>
                                                            </select>
                                                        </div>
                                                        
                                                        <div class="form-group">
                                                            <label class="form-label">Ø¹Ø¯Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©</label>
                                                            <select id="maxLoginAttempts" class="input-neon">
                                                                <option value="3">3 Ù…Ø­Ø§ÙˆÙ„Ø§Øª</option>
                                                                <option value="5" selected>5 Ù…Ø­Ø§ÙˆÙ„Ø§Øª</option>
                                                                <option value="10">10 Ù…Ø­Ø§ÙˆÙ„Ø§Øª</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    
                                                    <div style="margin-top: 1rem;">
                                                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                                            <input type="checkbox" id="requireComplexPassword" checked style="width: 18px; height: 18px; accent-color: var(--neon-blue);">
                                                            <label for="requireComplexPassword" style="color: var(--primary-200); cursor: pointer;">ØªØ·Ù„Ø¨ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù…Ø¹Ù‚Ø¯Ø© (Ø£Ø­Ø±Ù ÙƒØ¨ÙŠØ±Ø© ÙˆØµØºÙŠØ±Ø© ÙˆØ£Ø±Ù‚Ø§Ù…)</label>
                                                        </div>
                                                        
                                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                            <input type="checkbox" id="passwordExpiry" style="width: 18px; height: 18px; accent-color: var(--neon-blue);">
                                                            <label for="passwordExpiry" style="color: var(--primary-200); cursor: pointer;">Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙƒÙ„ 90 ÙŠÙˆÙ…</label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© -->
                                            <div>
                                                <h4 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1rem;">â±ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø©</h4>
                                                <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1.5rem;">
                                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                                        <div class="form-group">
                                                            <label class="form-label">Ù…Ø¯Ø© Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø© (Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚)</label>
                                                            <select id="sessionTimeout" class="input-neon">
                                                                <option value="30">30 Ø¯Ù‚ÙŠÙ‚Ø©</option>
                                                                <option value="60" selected>60 Ø¯Ù‚ÙŠÙ‚Ø©</option>
                                                                <option value="120">120 Ø¯Ù‚ÙŠÙ‚Ø©</option>
                                                                <option value="240">240 Ø¯Ù‚ÙŠÙ‚Ø©</option>
                                                            </select>
                                                        </div>
                                                        
                                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                            <input type="checkbox" id="autoLogout" checked style="width: 18px; height: 18px; accent-color: var(--neon-blue);">
                                                            <label for="autoLogout" style="color: var(--primary-200); cursor: pointer;">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø¹Ø¯Ù… Ø§Ù„Ù†Ø´Ø§Ø·</label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù† -->
                                            <div>
                                                <h4 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1rem;">ğŸ“Š Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù†</h4>
                                                <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1.5rem;">
                                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                                                        <div style="text-align: center;">
                                                            <div style="font-size: 2rem; font-weight: bold; color: var(--neon-red);">0</div>
                                                            <div style="color: var(--primary-200); font-size: 0.9rem;">Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø¯Ø®ÙˆÙ„ ÙØ§Ø´Ù„Ø©</div>
                                                        </div>
                                                        <div style="text-align: center;">
                                                            <div style="font-size: 2rem; font-weight: bold; color: var(--neon-green);">3</div>
                                                            <div style="color: var(--primary-200); font-size: 0.9rem;">Ø¬Ù„Ø³Ø§Øª Ù†Ø´Ø·Ø©</div>
                                                        </div>
                                                        <div style="text-align: center;">
                                                            <div style="font-size: 2rem; font-weight: bold; color: var(--neon-blue);">15</div>
                                                            <div style="color: var(--primary-200); font-size: 0.9rem;">Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                                                        </div>
                                                    </div>
                                                    
                                                    <button id="viewSecurityLog" class="btn-neon" style="width: 100%;">
                                                        <i data-lucide="history"></i>
                                                        Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„ØªÙØµÙŠÙ„ÙŠ
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ -->
                                <div id="backupSettings" class="settings-section hidden">
                                    <div class="card-neon" style="padding: 2rem; border-radius: 12px;">
                                        <h3 style="color: var(--neon-blue); margin-bottom: 1.5rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                                            <i data-lucide="save" style="width: 20px; height: 20px;"></i>
                                            Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØ§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©
                                        </h3>
                                        
                                        <div style="display: grid; gap: 2rem;">
                                            <!-- Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ -->
                                            <div>
                                                <h4 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1rem;">ğŸ”„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</h4>
                                                <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1.5rem;">
                                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                                        <div class="form-group">
                                                            <label class="form-label">ØªÙƒØ±Ø§Ø± Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</label>
                                                            <select id="backupFrequency" class="input-neon">
                                                                <option value="daily" selected>ÙŠÙˆÙ…ÙŠ</option>
                                                                <option value="weekly">Ø£Ø³Ø¨ÙˆØ¹ÙŠ</option>
                                                                <option value="monthly">Ø´Ù‡Ø±ÙŠ</option>
                                                            </select>
                                                        </div>
                                                        
                                                        <div class="form-group">
                                                            <label class="form-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</label>
                                                            <select id="backupRetention" class="input-neon">
                                                                <option value="7">7 Ù†Ø³Ø®</option>
                                                                <option value="14" selected>14 Ù†Ø³Ø®Ø©</option>
                                                                <option value="30">30 Ù†Ø³Ø®Ø©</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    
                                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                        <input type="checkbox" id="enableAutoBackup" checked style="width: 18px; height: 18px; accent-color: var(--neon-blue);">
                                                        <label for="enableAutoBackup" style="color: var(--primary-200); cursor: pointer;">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</label>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Ø§Ù„Ù†Ø³Ø® Ø§Ù„ÙŠØ¯ÙˆÙŠ -->
                                            <div>
                                                <h4 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1rem;">ğŸ’¾ Ø§Ù„Ù†Ø³Ø® Ø§Ù„ÙŠØ¯ÙˆÙŠ</h4>
                                                <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1.5rem;">
                                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                                        <button id="createBackup" class="btn-neon">
                                                            <i data-lucide="save"></i>
                                                            Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„Ø¢Ù†
                                                        </button>
                                                        
                                                        <button id="downloadBackup" class="btn-neon" style="background: rgba(0, 255, 136, 0.2); border-color: var(--neon-green); color: var(--neon-green);">
                                                            <i data-lucide="save"></i>
                                                            ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± Ù†Ø³Ø®Ø©
                                                        </button>
                                                    </div>
                                                    
                                                    <div style="text-align: center; color: var(--primary-200); font-size: 0.9rem;">
                                                        Ø¢Ø®Ø± Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: <span style="color: var(--neon-blue); font-weight: bold;">Ø§Ù„ÙŠÙˆÙ… 2:30 Øµ</span>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                                            <div>
                                                <h4 style="color: var(--neon-blue); margin-bottom: 1rem; font-size: 1rem;">ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
                                                <div style="background: rgba(255, 235, 59, 0.1); border: 1px solid rgba(255, 235, 59, 0.3); border-radius: 8px; padding: 1.5rem;">
                                                    <div style="margin-bottom: 1rem;">
                                                        <label class="form-label">Ø§Ø®ØªØ± Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</label>
                                                        <input type="file" id="backupFile" class="input-neon" accept=".json,.csv,.xlsx" style="padding: 0.5rem;">
                                                    </div>
                                                    
                                                    <div style="display: flex; gap: 1rem;">
                                                        <button id="previewBackup" class="btn-neon" style="flex: 1; background: rgba(255, 235, 59, 0.2); border-color: var(--neon-yellow); color: var(--neon-yellow);">
                                                            <i data-lucide="check"></i>
                                                            Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                                                        </button>
                                                        
                                                        <button id="restoreBackup" class="btn-neon" style="flex: 1; background: rgba(255, 68, 68, 0.2); border-color: var(--neon-red); color: var(--neon-red);">
                                                            <i data-lucide="save"></i>
                                                            Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                                                        </button>
                                                    </div>
                                                    
                                                    <div style="margin-top: 1rem; background: rgba(255, 68, 68, 0.1); border: 1px solid rgba(255, 68, 68, 0.3); border-radius: 6px; padding: 0.75rem;">
                                                        <div style="display: flex; align-items: center; gap: 0.5rem; color: var(--neon-red); font-size: 0.9rem;">
                                                            <i data-lucide="alert-triangle" style="width: 16px; height: 16px;"></i>
                                                            <strong>ØªØ­Ø°ÙŠØ±:</strong> Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø³ØªØ­Ù„ Ù…Ø­Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ -->
    <div id="addUserModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 700px; text-align: right;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h2 class="modal-title" style="margin: 0;">ğŸ‘¤ Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</h2>
                <button id="closeAddUserModal" style="background: none; border: none; color: var(--neon-red); cursor: pointer; font-size: 1.5rem; padding: 0.5rem;">
                    <i data-lucide="x"></i>
                </button>
            </div>
            
            <div id="addUserNotification"></div>
            
            <form id="addUserForm">
                <!-- Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„: Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div class="form-group">
                        <label class="form-label" style="font-size: 0.9rem;">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *</label>
                        <input type="text" id="newUserName" class="input-neon" required placeholder="Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯" style="padding: 0.6rem;">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" style="font-size: 0.9rem;">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… *</label>
                        <input type="text" id="newUserUsername" class="input-neon" required placeholder="Ù…Ø«Ø§Ù„: ahmed.mohamed" style="padding: 0.6rem;">
                    </div>
                </div>
                
                <!-- Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆØ§Ù„Ù‡Ø§ØªÙ -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div class="form-group">
                        <label class="form-label" style="font-size: 0.9rem;">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label>
                        <input type="email" id="newUserEmail" class="input-neon" required placeholder="Ù…Ø«Ø§Ù„: ahmed@company.com" style="padding: 0.6rem;">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" style="font-size: 0.9rem;">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                        <input type="tel" id="newUserPhone" class="input-neon" placeholder="01234567890" style="padding: 0.6rem;">
                    </div>
                </div>
                
                <!-- Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø«: ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div class="form-group">
                        <label class="form-label" style="font-size: 0.9rem;">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± *</label>
                        <input type="password" id="newUserPassword" class="input-neon" required placeholder="8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„" style="padding: 0.6rem;">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" style="font-size: 0.9rem;">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± *</label>
                        <input type="password" id="newUserPasswordConfirm" class="input-neon" required placeholder="Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="padding: 0.6rem;">
                    </div>
                </div>
                
                <!-- Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹: Ø§Ù„Ø¯ÙˆØ± ÙˆØ§Ù„Ù‚Ø³Ù… -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div class="form-group">
                        <label class="form-label" style="font-size: 0.9rem;">Ø§Ù„Ø¯ÙˆØ± *</label>
                        <select id="newUserRole" class="input-neon" required style="padding: 0.6rem;">
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ±</option>
                            <option value="Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…">Ù…Ø¯ÙŠØ± Ø¹Ø§Ù…</option>
                            <option value="Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø£ÙˆÙ„">Ù…Ø´Ø±Ù</option>
                            <option value="Ù…ÙˆØ¸Ù ØªØ¬Ø±ÙŠØ¨ÙŠ">Ù…ÙˆØ¸Ù</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <div style="display: flex; align-items: end; gap: 0.5rem;">
                            <div style="flex: 1;">
                                <label class="form-label" style="font-size: 0.9rem;">Ø§Ù„Ù‚Ø³Ù…</label>
                                <select id="newUserDepartment" class="input-neon" style="padding: 0.6rem;">
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…</option>
                                    <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù…Ù† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† -->
                                </select>
                            </div>
                            <button type="button" onclick="openDepartmentsModal()" style="background: rgba(0, 212, 255, 0.2); border: 1px solid rgba(0, 212, 255, 0.5); color: var(--neon-blue); padding: 0.6rem; border-radius: 6px; cursor: pointer; transition: all 0.3s ease; font-size: 0.8rem; white-space: nowrap;" title="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…">
                                <i data-lucide="settings" style="width: 14px; height: 14px;"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª -->
                <div class="form-group" style="margin-bottom: 1rem;">
                    <label class="form-label" style="font-size: 0.9rem;">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                    <textarea id="newUserNotes" class="input-neon" style="min-height: 60px; resize: vertical; padding: 0.6rem;" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"></textarea>
                </div>
                
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ø®ØªØµØ±Ø© -->
                <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 8px; padding: 0.75rem; margin-bottom: 1rem;">
                    <div style="color: var(--neon-blue); font-size: 0.85rem; line-height: 1.4;">
                        ğŸ’¡ <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ ÙˆÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                        <br>
                        ğŸ”— <strong>Ø§Ù„Ø£Ù‚Ø³Ø§Ù…:</strong> Ù…Ø±ØªØ¨Ø·Ø© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù…Ø¹ Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† - ÙŠÙ…ÙƒÙ† Ø¥Ø¯Ø§Ø±ØªÙ‡Ø§ Ù…Ù† ØªØ¨ÙˆÙŠØ¨ "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†"
                    </div>
                </div>
                
                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª -->
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" id="cancelAddUser" style="background: rgba(255, 68, 68, 0.2); border: 1px solid rgba(255, 68, 68, 0.5); color: #ff4444; padding: 0.6rem 1.2rem; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-size: 0.9rem;">
                        <i data-lucide="x"></i>
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="submit" class="btn-neon" style="padding: 0.6rem 1.2rem; font-size: 0.9rem;">
                        <i data-lucide="user-plus"></i>
                        Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… -->
    <div id="departmentsModal" class="hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 1000; display: flex; align-items: center; justify-content: center;">
        <div class="card-neon" style="width: 90%; max-width: 500px; padding: 2rem; border-radius: 12px; max-height: 80vh; overflow-y: auto; position: relative;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 style="color: var(--neon-blue); font-size: 1.2rem;">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h3>
                <button id="closeDepartmentsModal" style="background: none; border: none; color: var(--neon-red); cursor: pointer; font-size: 1.5rem; padding: 0.5rem;"></button>
                    <i data-lucide="x"></i>
                </button>
            </div>
            
            <div id="departmentsNotification"></div>
            
            <!-- Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯ -->
            <div style="margin-bottom: 2rem;">
                <h4 style="color: var(--neon-blue); margin-bottom: 1rem;">Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯</h4>
                <div style="display: flex; gap: 0.5rem;">
                    <input type="text" id="newDepartmentName" class="input-neon" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯" style="flex: 1;">
                    <button id="addDepartmentBtn" class="btn-neon" style="padding: 0.75rem 1rem;">
                        <i data-lucide="plus"></i>
                        Ø¥Ø¶Ø§ÙØ©
                    </button>
                </div>
            </div>
            
            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØ© -->
            <div>
                <h4 style="color: var(--neon-blue); margin-bottom: 1rem;">Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h4>
                <div id="departmentsList" style="max-height: 300px; overflow-y: auto;">
                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø© -->
    <div id="resetBalancesModal" class="hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 1000; display: flex; align-items: center; justify-content: center;">
        <div class="card-neon" style="width: 90%; max-width: 600px; padding: 2rem; border-radius: 12px; max-height: 80vh; overflow-y: auto; position: relative;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 style="color: var(--neon-blue); font-size: 1.2rem;">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ©</h3>
                <button id="closeResetModal" style="background: none; border: none; color: var(--neon-red); cursor: pointer; font-size: 1.5rem; padding: 0.5rem;">
                    <i data-lucide="x"></i>
                </button>
            </div>
            
            <div id="resetNotification"></div>
            
            <div style="background: rgba(255, 235, 59, 0.1); border: 1px solid rgba(255, 235, 59, 0.3); border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
                <h4 style="color: var(--neon-yellow); margin-bottom: 0.75rem;">âš ï¸ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</h4>
                <p style="color: var(--primary-200); margin-bottom: 0.5rem;">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø£Ø±ØµØ¯Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†ØŸ</p>
            </div>
            
            <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
                <h4 style="color: var(--neon-blue); margin-bottom: 0.75rem;">ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©:</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                        <span style="color: var(--primary-200);">Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†:</span>
                        <span style="color: var(--neon-blue); font-weight: bold;" id="resetEmployeeCount">0 Ù…ÙˆØ¸Ù</span>
                    </div>
                    <div>
                        <span style="color: var(--primary-200);">Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:</span>
                        <span style="color: var(--neon-green); font-weight: bold;" id="resetNewYear">2025-2026</span>
                    </div>
                    <div>
                        <span style="color: var(--primary-200);">Ø§Ù„ØªØ§Ø±ÙŠØ®:</span>
                        <span style="color: var(--neon-yellow); font-weight: bold;" id="resetDate">1 ÙŠÙˆÙ„ÙŠÙˆ 2025</span>
                    </div>
                    <div>
                        <span style="color: var(--primary-200);">Ø§Ù„Ù…Ù†ÙØ°:</span>
                        <span style="color: var(--neon-orange); font-weight: bold;" id="resetBy">Ø§Ù„Ù…Ø¯ÙŠØ±</span>
                    </div>
                </div>
            </div>
            
            <div style="background: rgba(0, 255, 136, 0.1); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
                <h4 style="color: var(--neon-green); margin-bottom: 0.75rem;">âœ… Ø³ÙŠØªÙ…:</h4>
                <ul style="color: var(--primary-200); margin: 0; padding-right: 1.5rem;">
                    <li>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¥Ù„Ù‰ ØµÙØ± Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</li>
                    <li>Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (30 Ø£Ùˆ 45 ÙŠÙˆÙ… Ø­Ø³Ø¨ ÙƒÙ„ Ù…ÙˆØ¸Ù)</li>
                    <li>Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù„Ù„ØªÙ‚Ø§Ø±ÙŠØ±</li>
                    <li>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø¸Ø§Ù…</li>
                </ul>
            </div>
            
            <div style="display: flex; gap: 1rem;">
                <button id="confirmResetBtn" class="btn-neon" style="flex: 1; background: linear-gradient(45deg, var(--neon-green), var(--primary-600)); border-color: var(--neon-green);">
                    <i data-lucide="check"></i>
                    ØªØ£ÙƒÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
                </button>
                <button id="cancelResetBtn" style="flex: 1; background: rgba(255, 68, 68, 0.2); border: 1px solid rgba(255, 68, 68, 0.5); color: #ff4444; padding: 0.75rem 1.5rem; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
                    <i data-lucide="x"></i>
                    Ø¥Ù„ØºØ§Ø¡
                </button>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø³Ø¬Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† -->
    <div id="resetHistoryModal" class="hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 1000; display: flex; align-items: center; justify-content: center;">
        <div class="card-neon" style="width: 90%; max-width: 800px; padding: 2rem; border-radius: 12px; max-height: 80vh; overflow-y: auto; position: relative;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 style="color: var(--neon-blue); font-size: 1.2rem;">Ø³Ø¬Ù„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø©</h3>
                <button id="closeHistoryModal" style="background: none; border: none; color: var(--neon-red); cursor: pointer; font-size: 1.5rem; padding: 0.5rem;">
                    <i data-lucide="x"></i>
                </button>
            </div>
            
            <div id="resetHistoryContent">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø­Ø³Ù†Ø© -->
    <div id="employeeDetailsModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 900px; text-align: right; max-height: 90vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h2 class="modal-title">ğŸ‘¤ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù</h2>
                <button onclick="closeEmployeeDetailsModal()" style="background: none; border: none; color: var(--neon-red); cursor: pointer; font-size: 1.5rem; padding: 0.5rem;">
                    <i data-lucide="x"></i>
                </button>
            </div>
            
            <div id="employeeDetailsContent">
                <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                <div class="employee-info-section">
                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                </div>
                
                <!-- Ù‚Ø³Ù… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª -->
                <div style="margin-top: 2rem;">
                    <h3 style="color: var(--neon-blue); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <i data-lucide="history" style="width: 20px; height: 20px;"></i>
                        ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
                    </h3>
                    <div class="leave-history-section">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª
        window.addEventListener('load', function() {
            if (typeof firebase === 'undefined') {
                console.error('Firebase library failed to load');
                alert('Ø®Ø·Ø£: ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© Firebase. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
                return;
            }
            
            if (typeof lucide === 'undefined') {
                console.error('Lucide library failed to load');
                // ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¨Ø¯ÙˆÙ† Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
            }
            
            console.log('All libraries loaded successfully');
            
            // Ø¥Ø¶Ø§ÙØ© Event Listeners Ù„Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù
            setupEmployeeDetailsModalEvents();
        });
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Event Listeners Ù„Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù
        function setupEmployeeDetailsModalEvents() {
            const modal = document.getElementById('employeeDetailsModal');
            if (!modal) return;
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¨Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
            modal.addEventListener('click', function(event) {
                if (event.target === modal) {
                    closeEmployeeDetailsModal();
                }
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¨Ù…ÙØªØ§Ø­ Escape
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && modal.classList.contains('show')) {
                    closeEmployeeDetailsModal();
                }
            });
        }

        // ÙˆØ¸ÙŠÙØ© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†ØµØ± Ù‚Ø¨Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        function safeUpdateElement(elementId, updateFunction) {
            const element = document.getElementById(elementId);
            if (element && typeof updateFunction === 'function') {
                try {
                    updateFunction(element);
                } catch (error) {
                    console.warn(`Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†ØµØ± ${elementId}:`, error);
                }
            }
        }

        // ÙˆØ¸ÙŠÙØ© Ø¢Ù…Ù†Ø© Ù„ØªØ­Ø¯ÙŠØ« innerHTML
        function safeSetInnerHTML(elementId, htmlContent) {
            safeUpdateElement(elementId, (element) => {
                element.innerHTML = htmlContent;
            });
        }

        // ÙˆØ¸ÙŠÙØ© Ø¢Ù…Ù†Ø© Ù„ØªØ­Ø¯ÙŠØ« textContent
        function safeSetTextContent(elementId, textContent) {
            safeUpdateElement(elementId, (element) => {
                element.textContent = textContent;
            });
        }
        
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyC9uv8kVPNZ4bFLOhut8vfBohJC9754Kl8",
            authDomain: "employee-leave-system-802f2.firebaseapp.com",
            projectId: "employee-leave-system-802f2",
            storageBucket: "employee-leave-system-802f2.firebasestorage.app",
            messagingSenderId: "776392559214",
            appId: "1:776392559214:web:338956b61330b7307ef47f"
        };

        // ØªÙ‡ÙŠØ¦Ø© Firebase Ø¨Ø´ÙƒÙ„ Ø§Ø­ØªØ±Ø§ÙÙŠ
        let auth, db;
        async function initializeFirebase() {
            try {
                // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Firebase
                const firebaseReady = await window.firebaseLoadingPromise;
                
                if (firebaseReady && typeof firebase !== 'undefined') {
                    console.log('ğŸ”¥ Initializing Firebase...');
                    
                    const firebaseConfig = {
                        apiKey: "AIzaSyC9uv8kVPNZ4bFLOhut8vfBohJC9754Kl8",
                        authDomain: "employee-leave-system-802f2.firebaseapp.com",
                        projectId: "employee-leave-system-802f2",
                        storageBucket: "employee-leave-system-802f2.firebasestorage.app",
                        messagingSenderId: "776392559214",
                        appId: "1:776392559214:web:338956b61330b7307ef47f"
                    };

                    firebase.initializeApp(firebaseConfig);
                    auth = firebase.auth();
                    db = firebase.firestore();
                    
                    console.log('âœ… Firebase initialized successfully');
                    return true;
                } else {
                    console.warn('âš ï¸ Firebase not available, using local mode');
                    return false;
                }
            } catch (error) {
                console.error('âŒ Firebase initialization error:', error);
                return false;
            }
        }

        // Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø©
        let currentUser = null;
        let employees = [];
        let leaveRecords = [];
        let systemUsers = []; // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø¶Ø§ÙÙŠÙ†

        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        let forgetPasswordCount = parseInt(localStorage.getItem('forgetPasswordCount') || '0');
        
        // Ø±Ø³Ø§Ø¦Ù„ Ù†Ø³ÙŠØ§Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„ÙƒÙˆÙ…ÙŠØ¯ÙŠØ©
        const forgotPasswordMessages = [
            {
                emoji: "ğŸ˜ ",
                text: "Ù†Ø³ÙŠØª ØªØ§ÙƒÙ„! Ù†Ø³ÙŠØª ØªØ´Ø±Ø¨! Ù†Ø³ÙŠØª ØªØºØªØª Ø¹Ù„Ù‰ Ø²Ù…Ø§ÙŠÙ„Ùƒ!"
            },
            {
                emoji: "ğŸ¤”", 
                text: "Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ù…Ù„ÙŠØ§Ù†Ø©! .. Ø§Ù…Ø³Ø­ Ø´ÙˆÙŠØ© Ù…Ù† Ø°ÙƒØ±ÙŠØ§ØªÙƒ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©"
            },
            {
                emoji: "ğŸ˜‚",
                text: "Ù…Ø§ Ø³ÙŠØ§Ø¯ØªÙƒ Ù„Ùˆ Ù…Ø±ÙƒØ² .. Ù…Ø§ÙƒÙ†ØªØ´ Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
            }
        ];

        // Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ© Ø§Ù„Ø±Ø³Ù…ÙŠØ©
        const seasonalMessages = {
            // Ø±Ø³Ø§Ø¦Ù„ ÙŠÙˆÙ…ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª
            morning: [
                "ï¿½ ØµØ¨Ø§Ø³Ø­ Ø§Ù„Ø®ÙŠØ±! Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ ÙŠÙˆÙ…Ø§Ù‹ Ù…Ø«Ù…Ø±Ø§Ù‹ ÙˆÙ…Ù„ÙŠØ¦Ø§Ù‹ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª",
                "â˜€ï¸ ØµØ¨Ø§Ø­ Ø§Ù„Ù†ÙˆØ±! Ø¨Ø¯Ø§ÙŠØ© Ù…ÙˆÙÙ‚Ø© Ù„ÙŠÙˆÙ… Ø¹Ù…Ù„ Ø¬Ø¯ÙŠØ¯",
                "ğŸŒ Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! ØµØ¨Ø§Ø­ Ù…Ø¨Ø§Ø±Ùƒ ÙˆØ¹Ù…Ù„ Ù…Ù…ØªØ¹"
            ],
            afternoon: [
                "ğŸŒ¤ï¸ Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±! Ù†ØªÙ…Ù†Ù‰ Ø£Ù† ÙŠÙƒÙˆÙ† ÙŠÙˆÙ…Ùƒ Ù…Ø«Ù…Ø±Ø§Ù‹",
                "ï¿½ Ù…Ø³Ø§Ø¡ Ø§ÙƒÙ„Ù†ÙˆØ±! Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø±Ø§Ø¦Ø¹",
                "âœ¨ Ù…Ø³Ø§Ø¡ Ù…Ø¨Ø§Ø±Ùƒ! Ø´ÙƒØ±Ø§Ù‹ Ù„Ø¬Ù‡ÙˆØ¯Ùƒ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©"
            ],
            evening: [
                "ğŸŒ™ Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±! ÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ø§Ø¡ ÙŠÙˆÙ… Ø¹Ù…Ù„ Ù†Ø§Ø¬Ø­",
                "â­ Ù…Ø³Ø§Ø¡ Ø§Ù„Ù†ÙˆØ±! Ø´ÙƒØ±Ø§Ù‹ Ù„Ø¹Ø·Ø§Ø¦Ùƒ Ø§Ù„ÙŠÙˆÙ…",
                "ï¿½  Ù…Ø³Ø§Ø¡ Ù…Ø¨Ø§Ø±Ùƒ! Ø§Ø³ØªØ±Ø­ Ø¬ÙŠØ¯Ø§Ù‹ Ù„ØªØ³ØªØ¹Ø¯ Ù„ØºØ¯ Ø£ÙØ¶Ù„"
            ],
            
            // Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª ÙˆØ§Ù„Ø£Ø¹ÙŠØ§Ø¯ Ø§Ù„Ø±Ø³Ù…ÙŠØ© Ø§Ù„Ù…ØµØ±ÙŠØ©
            newYear: [
                "ğŸŠ ÙƒÙ„ Ø¹Ø§Ù… ÙˆØ£Ù†ØªÙ… Ø¨Ø®ÙŠØ±! Ø¹Ø§Ù… Ø¬Ø¯ÙŠØ¯ Ù…Ù„ÙŠØ¡ Ø¨Ø§Ù„Ù†Ø¬Ø§Ø­ ÙˆØ§Ù„ØªÙˆÙÙŠÙ‚",
                "âœ¨ Ø£Ø¹Ø§Ø¯Ù‡ Ø§Ù„Ù„Ù‡ Ø¹Ù„ÙŠÙ†Ø§ ÙˆØ¹Ù„ÙŠÙƒÙ… Ø¨Ø§Ù„Ø®ÙŠØ± ÙˆØ§Ù„ÙŠÙ…Ù† ÙˆØ§Ù„Ø¨Ø±ÙƒØ§Øª"
            ],
            
            ramadan: [
                "ğŸŒ™ Ø±Ù…Ø¶Ø§Ù† Ù…Ø¨Ø§Ø±Ùƒ! ÙƒÙ„ Ø¹Ø§Ù… ÙˆØ£Ù†ØªÙ… Ø¨Ø®ÙŠØ± ÙˆØµØ­Ø© ÙˆØ³Ù„Ø§Ù…Ø©",
                "ğŸ•Œ Ø£Ù‡Ù„Ø§Ù‹ Ø±Ù…Ø¶Ø§Ù†! Ø´Ù‡Ø± Ø§Ù„Ø®ÙŠØ± ÙˆØ§Ù„Ø¨Ø±ÙƒØ© ÙˆØ§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ§Ù„Ø­"
            ],
            
            eidFitr: [
                "ğŸ† Ø¹ÙŠØ¯ ÙØ·Ø± Ù…Ø¨Ø§Ø±Ùƒ! ÙƒÙ„ Ø¹Ø§Ù… ÙˆØ£Ù†ØªÙ… Ø¨Ø®ÙŠØ± ÙˆØ³Ø¹Ø§Ø¯Ø©",
                "ğŸŒŸ ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ù…Ù†Ø§ ÙˆÙ…Ù†ÙƒÙ…! Ø¹ÙŠØ¯ Ø³Ø¹ÙŠØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹"
            ],
            
            eidAdha: [
                "ï¿½  Ø¹ÙŠØ¯ Ø£Ø¶Ø­Ù‰ Ù…Ø¨Ø§Ø±Ùƒ! ÙƒÙ„ Ø¹Ø§Ù… ÙˆØ£Ù†ØªÙ… Ø¨Ø®ÙŠØ± ÙˆØµØ­Ø©",
                "ğŸŠ ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ù…Ù†Ø§ ÙˆÙ…Ù†ÙƒÙ… ØµØ§Ù„Ø­ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„! Ø¹ÙŠØ¯ Ø³Ø¹ÙŠØ¯"
            ],
            
            // Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ø§Ù„Ù…ØµØ±ÙŠØ©
            nationalDay: [
                "ğŸ‡ªğŸ‡¬ ÙƒÙ„ Ø¹Ø§Ù… ÙˆÙ…ØµØ± Ø¨Ø®ÙŠØ±! Ø¹ÙŠØ¯ ÙˆØ·Ù†ÙŠ Ø³Ø¹ÙŠØ¯",
                "ğŸ–ï¸ Ù…Ø¨Ø§Ø±Ùƒ Ù„Ù„ÙˆØ·Ù† Ø§Ù„ØºØ§Ù„ÙŠ! ÙƒÙ„ Ø¹Ø§Ù… ÙˆÙ…ØµØ± Ø£Ù‚ÙˆÙ‰ ÙˆØ£Ø¹Ø²"
            ],
            
            sinaiLiberation: [
                "ğŸ‡ªğŸ‡¬ Ø°ÙƒØ±Ù‰ ØªØ­Ø±ÙŠØ± Ø³ÙŠÙ†Ø§Ø¡! ÙƒÙ„ Ø¹Ø§Ù… ÙˆÙ…ØµØ± Ø­Ø±Ø© Ø£Ø¨ÙŠØ©",
                "ğŸ–ï¸ ØªØ­ÙŠØ© Ù„Ø£Ø¨Ø·Ø§Ù„ Ù…ØµØ±! Ø°ÙƒØ±Ù‰ Ø¹Ø²ÙŠØ²Ø© Ø¹Ù„Ù‰ Ù‚Ù„ÙˆØ¨Ù†Ø§"
            ],
            
            revolution25: [
                "ğŸ‡ªğŸ‡¬ Ø°ÙƒØ±Ù‰ Ø«ÙˆØ±Ø© 25 ÙŠÙ†Ø§ÙŠØ±! ÙƒÙ„ Ø¹Ø§Ù… ÙˆØ§Ù„Ø´Ø¹Ø¨ Ø§Ù„Ù…ØµØ±ÙŠ Ø¨Ø®ÙŠØ±",
                "âœŠ ØªØ­ÙŠØ© Ù„Ù„Ø¥Ø±Ø§Ø¯Ø© Ø§Ù„Ø´Ø¹Ø¨ÙŠØ©! Ù…ØµØ± Ø¯Ø§Ø¦Ù…Ø§Ù‹ ÙÙŠ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©"
            ],
            
            policeDay: [
                "ğŸ‘®â€â™‚ï¸ Ø¹ÙŠØ¯ Ø§Ù„Ø´Ø±Ø·Ø© Ø§Ù„Ù…ØµØ±ÙŠØ©! ØªØ­ÙŠØ© Ù„Ø±Ø¬Ø§Ù„ Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø£Ø¨Ø·Ø§Ù„",
                "ğŸ–ï¸ ÙƒÙ„ Ø¹Ø§Ù… ÙˆØ±Ø¬Ø§Ù„ Ø§Ù„Ø´Ø±Ø·Ø© Ø¨Ø®ÙŠØ± ÙˆØ¹Ø§ÙÙŠØ©"
            ]
        };

        // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
        function getSeasonalMessageType() {
            const now = new Date();
            const month = now.getMonth() + 1; // 1-12
            const day = now.getDate();
            const hour = now.getHours();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª Ø§Ù„Ø±Ø³Ù…ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹
            if ((month === 12 && day >= 31) || (month === 1 && day <= 2)) {
                return 'newYear';
            }
            
            // Ø±Ù…Ø¶Ø§Ù† (ØªÙ‚Ø±ÙŠØ¨ÙŠ - ÙŠØªØºÙŠØ± ÙƒÙ„ Ø³Ù†Ø©)
            if (month === 3 || month === 4) {
                return 'ramadan';
            }
            
            // Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø± (ØªÙ‚Ø±ÙŠØ¨ÙŠ)
            if (month === 4 || month === 5) {
                return 'eidFitr';
            }
            
            // Ø¹ÙŠØ¯ Ø§Ù„Ø£Ø¶Ø­Ù‰ (ØªÙ‚Ø±ÙŠØ¨ÙŠ)
            if (month === 7 || month === 8) {
                return 'eidAdha';
            }
            
            // Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ø§Ù„Ù…ØµØ±ÙŠØ©
            if (month === 1 && day === 25) {
                return 'revolution25';
            }
            
            if (month === 4 && day === 25) {
                return 'sinaiLiberation';
            }
            
            if (month === 7 && day === 23) {
                return 'nationalDay';
            }
            
            if (month === 1 && day === 25) {
                return 'policeDay';
            }
            
            // Ø±Ø³Ø§Ø¦Ù„ ÙŠÙˆÙ…ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª
            if (hour >= 5 && hour < 12) {
                return 'morning';
            } else if (hour >= 12 && hour < 17) {
                return 'afternoon';
            } else {
                return 'evening';
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ© (ÙÙ‚Ø· Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„)
        function showSeasonalMessage() {
            const messageType = getSeasonalMessageType();
            
            if (messageType && seasonalMessages[messageType]) {
                const messages = seasonalMessages[messageType];
                const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                
                const messageElement = document.getElementById('seasonalMessage');
                const contentElement = document.getElementById('seasonalMessageContent');
                
                contentElement.textContent = randomMessage;
                messageElement.classList.add('show');
                
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 4 Ø«ÙˆØ§Ù†
                setTimeout(() => {
                    messageElement.classList.remove('show');
                }, 4000);
            }
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ©
        function closeSeasonalMessage() {
            document.getElementById('seasonalMessage').classList.remove('show');
        }

        // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ù†Ø³ÙŠØ§Ù† ÙƒÙ„ï¿½ï¿½Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        function showForgotPasswordModal() {
            // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯
            forgetPasswordCount++;
            localStorage.setItem('forgetPasswordCount', forgetPasswordCount.toString());
            
            // Ø§Ø®ØªÙŠØ§Ø± Ø±Ø³Ø§Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
            const randomMessage = forgotPasswordMessages[Math.floor(Math.random() * forgotPasswordMessages.length)];
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ù…Ø¹ Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø³ÙŠØ§Ù†
            const messageElement = document.getElementById('forgotPasswordMessage');
            messageElement.innerHTML = `
                <div style="font-size: 3rem; margin-bottom: 1rem;">${randomMessage.emoji}</div>
                <div>${randomMessage.text}</div>
                ${showForgetCounterInModal()}
            `;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø§ÙØ°Ø©
            document.getElementById('forgotPasswordModal').classList.add('show');
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ù†Ø³ÙŠØ§Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        function closeForgotPasswordModal() {
            document.getElementById('forgotPasswordModal').classList.remove('show');
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø³ÙŠØ§Ù† (ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©)
        function updateForgetCounter() {
            // Ù„Ø§ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙÙŠ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ ÙÙ‚Ø· ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
            return;
        }

        // Ø¹Ø±Ø¶ Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø³ÙŠØ§Ù† ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        function showForgetCounterInModal() {
            if (forgetPasswordCount > 0) {
                let message = '';
                
                if (forgetPasswordCount === 1) {
                    message = "ï¿½â€ Ø£ÙˆÙ„ Ù…Ø±Ø© ØªÙ†Ø³Ù‰ØŸ Ø¹Ø§Ø¯ÙŠ ÙŠØ­ØµÙ„";
                } else if (forgetPasswordCount <= 3) {
                    message = `ï¿½  Ø§Ù„Ù…Ø±Ø© Ø±Ù‚Ù… ${forgetPasswordCount}! Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ù…Ø­ØªØ§Ø¬Ø© ÙÙŠØªØ§Ù…ÙŠÙ†!`;
                } else if (forgetPasswordCount <= 5) {
                    message = `ğŸ¤¦â€â™‚ï¸ Ø§Ù„Ù…Ø±Ø© Ø¯ÙŠ Ø±Ù‚Ù… ${forgetPasswordCount}! Ø¥Ù†Øª Ù…Ø­ØªØ§Ø¬ Ù…ÙÙƒØ±Ø©`;
                } else if (forgetPasswordCount <= 10) {
                    message = `ğŸ˜‚ ${forgetPasswordCount} Ù…Ø±Ø§Øª! Ø¥Ù†Øª Ø¨Ø·Ù„ Ø§Ù„Ù†Ø³ÙŠØ§Ù† Ø§Ù„Ø±Ø³Ù…ÙŠ`;
                } else {
                    message = `ğŸ† Ù…Ø¨Ø±ÙˆÙƒ! Ø¥Ù†Øª ÙˆØµÙ„Øª Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø¨ÙŠØ± ÙÙŠ Ø§Ù„Ù†Ø³ÙŠØ§Ù† (${forgetPasswordCount} Ù…Ø±Ø©)`;
                }
                
                return `<div style="margin-top: 1rem; padding: 0.5rem; background: rgba(255, 235, 59, 0.1); border: 1px solid rgba(255, 235, 59, 0.3); border-radius: 8px; font-size: 0.9rem; color: var(--neon-yellow);">${message}</div>`;
            }
            return '';
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        function resetPassword() {
            closeForgotPasswordModal();
            
            // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
            const resetModal = document.createElement('div');
            resetModal.className = 'modal-overlay show';
            resetModal.innerHTML = `
                <div class="modal-content">
                    <h2 class="modal-title">ğŸ” Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h2>
                    <div class="modal-message">
                        <p>Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¯ÙŠØ±:</p>
                        <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                            <p><strong>ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</strong> admin@company.com</p>
                            <p><strong>ğŸ“± Ø§Ù„Ù‡Ø§ØªÙ:</strong> 01234567890</p>
                            <p><strong>ğŸ’¬ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨:</strong> 01234567890</p>
                        </div>
                        <p style="font-size: 0.9rem; color: var(--primary-200);">Ø£Ùˆ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©</p>
                    </div>
                    <div class="modal-buttons">
                        <button class="modal-btn primary" onclick="closeResetModal()">ÙÙ‡Ù…ØªØŒ Ø´ÙƒØ±Ø§Ù‹ ğŸ‘</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(resetModal);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬Ù‡Ø§
            resetModal.addEventListener('click', function(e) {
                if (e.target === resetModal) {
                    closeResetModal();
                }
            });
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        function closeResetModal() {
            const resetModal = document.querySelector('.modal-overlay:last-child');
            if (resetModal) {
                resetModal.remove();
            }
        }

        // ==================== ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø³Ø¬Ù„ ====================
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø³Ø¬Ù„
        let allRecords = [];
        let filteredRecords = [];
        let currentRecordsPage = 1;
        const recordsPerPage = 10;
        let recordsSortField = 'date';
        let recordsSortDirection = 'desc';

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
        async function loadRecords() {
            try {
                console.log('ğŸ”„ Loading records...');
                
                // ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
                const leaveRecordsData = leaveRecords.map(record => ({
                    id: record.id,
                    date: record.startDate || record.date,
                    time: record.createdAt || new Date().toISOString(),
                    employeeName: record.employeeName,
                    employeeId: record.employeeId,
                    type: record.type,
                    typeArabic: getLeaveTypeArabic(record.type),
                    duration: record.duration || calculateDuration(record),
                    balanceBefore: record.balanceBefore || 0,
                    balanceAfter: record.balanceAfter || 0,
                    createdBy: record.createdBy || 'Ø§Ù„Ù†Ø¸Ø§Ù…',
                    notes: record.notes || '',
                    category: 'leave',
                    startDate: record.startDate,
                    endDate: record.endDate,
                    startTime: record.startTime,
                    endTime: record.endTime
                }));

                // ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„Ø§Øª Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª (Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØªÙˆÙØ±Ø©)
                let saturdayRecordsData = [];
                if (typeof saturdayShifts !== 'undefined' && saturdayShifts.length > 0) {
                    saturdayRecordsData = saturdayShifts.map(shift => ({
                        id: shift.id,
                        date: shift.date,
                        time: shift.createdAt || new Date().toISOString(),
                        employeeName: shift.employeeName,
                        employeeId: shift.employeeId,
                        type: 'saturday',
                        typeArabic: 'Ù†ÙˆØ¨ØªØ¬ÙŠØ© Ø³Ø¨Øª',
                        duration: `${shift.hours || 0} Ø³Ø§Ø¹Ø©`,
                        balanceBefore: '-',
                        balanceAfter: '-',
                        createdBy: shift.createdBy || 'Ø§Ù„Ù†Ø¸Ø§Ù…',
                        notes: shift.notes || '',
                        category: 'saturday',
                        arrivalTime: shift.arrivalTime,
                        departureTime: shift.departureTime,
                        hours: shift.hours
                    }));
                }

                // Ø¯Ù…Ø¬ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                allRecords = [...leaveRecordsData, ...saturdayRecordsData];
                
                // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹)
                allRecords.sort((a, b) => new Date(b.time) - new Date(a.time));
                
                console.log(`âœ… Loaded ${allRecords.length} records`);
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ± ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                applyRecordsFilters();
                updateRecordsStatistics();
                
            } catch (error) {
                console.error('âŒ Error loading records:', error);
                showMessage('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª', 'error');
            }
        }

        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
        function applyRecordsFilters() {
            const searchTerm = document.getElementById('recordsSearch').value.toLowerCase();
            const dateFrom = document.getElementById('recordsDateFrom').value;
            const dateTo = document.getElementById('recordsDateTo').value;
            const employeeFilter = document.getElementById('recordsEmployeeFilter').value;
            const typeFilter = document.getElementById('recordsTypeFilter').value;
            const userFilter = document.getElementById('recordsUserFilter').value;

            filteredRecords = allRecords.filter(record => {
                // ÙÙ„ØªØ±Ø© Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù†ØµÙŠ
                if (searchTerm && !record.employeeName.toLowerCase().includes(searchTerm) && 
                    !record.typeArabic.toLowerCase().includes(searchTerm)) {
                    return false;
                }

                // ÙÙ„ØªØ±Ø© Ø§Ù„ØªØ§Ø±ÙŠØ® Ù…Ù†
                if (dateFrom && record.date < dateFrom) {
                    return false;
                }

                // ÙÙ„ØªØ±Ø© Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¥Ù„Ù‰
                if (dateTo && record.date > dateTo) {
                    return false;
                }

                // ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ÙˆØ¸Ù
                if (employeeFilter && record.employeeId !== employeeFilter) {
                    return false;
                }

                // ÙÙ„ØªØ±Ø© Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
                if (typeFilter && record.type !== typeFilter) {
                    return false;
                }

                // ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                if (userFilter) {
                    const createdByMap = {
                        'admin': 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…',
                        'supervisor': 'Ø§Ù„Ù…Ø´Ø±Ù'
                    };
                    if (record.createdBy !== createdByMap[userFilter] && record.createdBy !== userFilter) {
                        return false;
                    }
                }

                return true;
            });

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            currentRecordsPage = 1;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…ÙÙ„ØªØ±Ø©
            displayRecords();
            updateRecordsPagination();
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        function displayRecords() {
            const tbody = document.getElementById('recordsTableBody');
            const startIndex = (currentRecordsPage - 1) * recordsPerPage;
            const endIndex = startIndex + recordsPerPage;
            const recordsToShow = filteredRecords.slice(startIndex, endIndex);

            if (recordsToShow.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 2rem; color: var(--primary-200);">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“­</div>
                            <div>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª ØªØ·Ø§Ø¨Ù‚ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«</div>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = recordsToShow.map(record => {
                const typeColor = getRecordTypeColor(record.type);
                const formattedDate = formatDate(record.date);
                const formattedTime = formatTime(record.time);
                
                return `
                    <tr style="border-bottom: 1px solid rgba(0, 212, 255, 0.1); transition: all 0.3s ease;" 
                        onmouseover="this.style.background='rgba(0, 212, 255, 0.05)'" 
                        onmouseout="this.style.background='transparent'">
                        <td style="padding: 1rem; color: white;">
                            <div style="font-weight: bold;">${formattedDate}</div>
                            <div style="font-size: 0.8rem; color: var(--primary-200);">${formattedTime}</div>
                        </td>
                        <td style="padding: 1rem; color: white;">
                            <div style="font-weight: bold;">${record.employeeName}</div>
                            <div style="font-size: 0.8rem; color: var(--primary-200);">ID: ${record.employeeId}</div>
                        </td>
                        <td style="padding: 1rem;">
                            <span style="background: ${typeColor.bg}; color: ${typeColor.text}; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">
                                ${record.typeArabic}
                            </span>
                        </td>
                        <td class="hide-mobile" style="padding: 1rem; text-align: center; color: white; font-weight: bold;">
                            ${record.duration}
                        </td>
                        <td class="hide-small" style="padding: 1rem; text-align: center; color: white;">
                            <div style="font-size: 0.8rem; color: var(--primary-200);">Ù‚Ø¨Ù„: ${record.balanceBefore}</div>
                            <div style="font-weight: bold;">Ø¨Ø¹Ø¯: ${record.balanceAfter}</div>
                        </td>
                        <td class="hide-mobile" style="padding: 1rem; color: var(--primary-200); font-size: 0.9rem;">
                            ${record.createdBy}
                        </td>
                        <td style="padding: 1rem; text-align: center;">
                            <button onclick="showRecordDetails('${record.id}')" class="btn-neon" style="padding: 0.5rem; font-size: 0.8rem;" title="Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„">
                                <i data-lucide="eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
            lucide.createIcons();
        }

        // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„Ø§Øª
        function updateRecordsStatistics() {
            const today = new Date().toISOString().split('T')[0];
            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];

            const totalCount = allRecords.length;
            const todayCount = allRecords.filter(r => r.date === today).length;
            const weekCount = allRecords.filter(r => r.date >= weekAgo).length;

            // Ø­Ø³Ø§Ø¨ Ø£ÙƒØ«Ø± Ù†ÙˆØ¹ Ø¹Ù…Ù„ÙŠØ©
            const typeCounts = {};
            allRecords.forEach(record => {
                typeCounts[record.typeArabic] = (typeCounts[record.typeArabic] || 0) + 1;
            });
            
            const mostCommonType = Object.keys(typeCounts).reduce((a, b) => 
                typeCounts[a] > typeCounts[b] ? a : b, 'Ù„Ø§ ÙŠÙˆØ¬Ø¯');

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
            document.getElementById('totalRecordsCount').textContent = totalCount;
            document.getElementById('todayRecordsCount').textContent = todayCount;
            document.getElementById('weekRecordsCount').textContent = weekCount;
            document.getElementById('mostCommonType').textContent = mostCommonType;
        }

        // ØªØ­Ø¯ÙŠØ« ØªØ±Ù‚ÙŠÙ… Ø§Ù„ØµÙØ­Ø§Øª
        function updateRecordsPagination() {
            const totalPages = Math.ceil(filteredRecords.length / recordsPerPage);
            const startIndex = (currentRecordsPage - 1) * recordsPerPage + 1;
            const endIndex = Math.min(currentRecordsPage * recordsPerPage, filteredRecords.length);

            document.getElementById('recordsShowingFrom').textContent = filteredRecords.length > 0 ? startIndex : 0;
            document.getElementById('recordsShowingTo').textContent = endIndex;
            document.getElementById('recordsTotal').textContent = filteredRecords.length;
            document.getElementById('recordsPageInfo').textContent = `ØµÙØ­Ø© ${currentRecordsPage} Ù…Ù† ${totalPages}`;

            // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„
            document.getElementById('recordsPrevPage').disabled = currentRecordsPage <= 1;
            document.getElementById('recordsNextPage').disabled = currentRecordsPage >= totalPages;
        }

        // ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø©
        function getLeaveTypeArabic(type) {
            const types = {
                'regular': 'Ø¥Ø¬Ø§Ø²Ø© Ø§Ø¹ØªÙŠØ§Ø¯ÙŠØ©',
                'emergency': 'Ø¥Ø¬Ø§Ø²Ø© Ø¹Ø§Ø±Ø¶Ø©',
                'sick': 'Ø¥Ø¬Ø§Ø²Ø© Ù…Ø±Ø¶ÙŠØ©',
                'permission': 'Ø¥Ø°Ù†',
                'saturday': 'Ù†ÙˆØ¨ØªØ¬ÙŠØ© Ø³Ø¨Øª'
            };
            return types[type] || type;
        }

        function getRecordTypeColor(type) {
            const colors = {
                'regular': { bg: 'rgba(0, 255, 136, 0.2)', text: 'var(--neon-green)' },
                'emergency': { bg: 'rgba(255, 235, 59, 0.2)', text: 'var(--neon-yellow)' },
                'sick': { bg: 'rgba(255, 68, 68, 0.2)', text: 'var(--neon-red)' },
                'permission': { bg: 'rgba(255, 152, 0, 0.2)', text: 'var(--neon-orange)' },
                'saturday': { bg: 'rgba(138, 43, 226, 0.2)', text: '#8a2be2' }
            };
            return colors[type] || { bg: 'rgba(0, 212, 255, 0.2)', text: 'var(--neon-blue)' };
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ar-EG', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });
        }

        function formatTime(timeString) {
            const date = new Date(timeString);
            return date.toLocaleTimeString('ar-EG', {
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
            });
        }

        function calculateDuration(record) {
            if (record.type === 'permission' && record.startTime && record.endTime) {
                const start = new Date(`2000-01-01T${record.startTime}`);
                const end = new Date(`2000-01-01T${record.endTime}`);
                const diffMs = end - start;
                const diffHours = Math.round(diffMs / (1000 * 60 * 60) * 10) / 10;
                return `${diffHours} Ø³Ø§Ø¹Ø©`;
            } else if (record.startDate && record.endDate) {
                const start = new Date(record.startDate);
                const end = new Date(record.endDate);
                const diffTime = Math.abs(end - start);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
                return `${diffDays} ÙŠÙˆÙ…`;
            }
            return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }

        // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„
        function showRecordDetails(recordId) {
            const record = allRecords.find(r => r.id === recordId);
            if (!record) return;

            const detailsContent = document.getElementById('recordDetailsContent');
            const typeColor = getRecordTypeColor(record.type);
            
            detailsContent.innerHTML = `
                <div style="background: rgba(0, 35, 102, 0.3); border-radius: 8px; padding: 1.5rem; margin-bottom: 1rem;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <strong style="color: var(--neon-blue);">ğŸ‘¤ Ø§Ù„Ù…ÙˆØ¸Ù:</strong><br>
                            <span style="color: white; font-size: 1.1rem;">${record.employeeName}</span>
                        </div>
                        <div>
                            <strong style="color: var(--neon-blue);">ğŸ†” Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¸Ù:</strong><br>
                            <span style="color: white;">${record.employeeId}</span>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <strong style="color: var(--neon-blue);">ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong><br>
                            <span style="color: white;">${formatDate(record.date)}</span>
                        </div>
                        <div>
                            <strong style="color: var(--neon-blue);">â° Ø§Ù„ÙˆÙ‚Øª:</strong><br>
                            <span style="color: white;">${formatTime(record.time)}</span>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <strong style="color: var(--neon-blue);">ğŸ“ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©:</strong><br>
                        <span style="background: ${typeColor.bg}; color: ${typeColor.text}; padding: 0.5rem 1rem; border-radius: 8px; font-weight: bold; display: inline-block; margin-top: 0.5rem;">
                            ${record.typeArabic}
                        </span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <strong style="color: var(--neon-blue);">â±ï¸ Ø§Ù„Ù…Ø¯Ø©:</strong><br>
                            <span style="color: white; font-size: 1.1rem; font-weight: bold;">${record.duration}</span>
                        </div>
                        <div>
                            <strong style="color: var(--neon-blue);">ğŸ“ˆ Ø§Ù„Ø±ØµÙŠØ¯ Ù‚Ø¨Ù„:</strong><br>
                            <span style="color: var(--neon-yellow);">${record.balanceBefore}</span>
                        </div>
                        <div>
                            <strong style="color: var(--neon-blue);">ğŸ“‰ Ø§Ù„Ø±ØµÙŠØ¯ Ø¨Ø¹Ø¯:</strong><br>
                            <span style="color: var(--neon-green);">${record.balanceAfter}</span>
                        </div>
                    </div>
                    
                    ${record.startDate ? `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <strong style="color: var(--neon-blue);">ğŸ“… Ù…Ù† ØªØ§Ø±ÙŠØ®:</strong><br>
                            <span style="color: white;">${formatDate(record.startDate)}</span>
                        </div>
                        <div>
                            <strong style="color: var(--neon-blue);">ğŸ“… Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®:</strong><br>
                            <span style="color: white;">${formatDate(record.endDate || record.startDate)}</span>
                        </div>
                    </div>
                    ` : ''}
                    
                    ${record.startTime ? `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <strong style="color: var(--neon-blue);">ğŸ• Ù…Ù† Ø§Ù„Ø³Ø§Ø¹Ø©:</strong><br>
                            <span style="color: white;">${record.startTime}</span>
                        </div>
                        <div>
                            <strong style="color: var(--neon-blue);">ğŸ•• Ø¥Ù„Ù‰ Ø§Ù„Ø³Ø§Ø¹Ø©:</strong><br>
                            <span style="color: white;">${record.endTime || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                    </div>
                    ` : ''}
                    
                    <div style="margin-bottom: 1rem;">
                        <strong style="color: var(--neon-blue);">ğŸ‘¨â€ğŸ’¼ Ø³Ø¬Ù„Ù‡Ø§:</strong><br>
                        <span style="color: var(--primary-200);">${record.createdBy}</span>
                    </div>
                    
                    ${record.notes ? `
                    <div>
                        <strong style="color: var(--neon-blue);">ğŸ’¬ Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong><br>
                        <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 8px; padding: 1rem; margin-top: 0.5rem; color: white;">
                            ${record.notes}
                        </div>
                    </div>
                    ` : ''}
                </div>
            `;

            document.getElementById('recordDetailsModal').classList.add('show');
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„
        function closeRecordDetailsModal() {
            document.getElementById('recordDetailsModal').classList.remove('show');
        }

        // Ø·Ø¨Ø§Ø¹Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„
        function printRecordDetails() {
            window.print();
        }

        // Ø­ÙØ¸ ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
        function saveLoginData() {
            if (document.getElementById('rememberMe').checked) {
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                
                localStorage.setItem('rememberedEmail', email);
                localStorage.setItem('rememberedPassword', btoa(password)); // ØªØ´ÙÙŠØ± Ø¨Ø³ÙŠØ·
                localStorage.setItem('rememberMe', 'true');
            } else {
                localStorage.removeItem('rememberedEmail');
                localStorage.removeItem('rememberedPassword');
                localStorage.removeItem('rememberMe');
            }
        }

        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
        function loadSavedLoginData() {
            if (localStorage.getItem('rememberMe') === 'true') {
                const email = localStorage.getItem('rememberedEmail');
                const password = localStorage.getItem('rememberedPassword');
                
                if (email) document.getElementById('loginEmail').value = email;
                if (password) document.getElementById('loginPassword').value = atob(password); // ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±
                document.getElementById('rememberMe').checked = true;
            }
            
            // Ù„Ø§ Ù†Ø¹Ø±Ø¶ Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø³ÙŠØ§Ù† ÙÙŠ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
        }
        let saturdayShifts = [];
        let currentAttendance = []; // Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹
        let selectedLeaveType = 'regular';
        let editingEmployeeId = null; // Ù…Ø¹Ø±Ù Ø§Ù„Ù…ÙˆØ¸Ù Ù‚ÙŠØ¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        let filteredEmployees = []; // Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…ÙÙ„ØªØ±ÙŠÙ†
        let resetHistory = []; // Ø³Ø¬Ù„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø©
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ±Ù‚ÙŠÙ… ÙˆØ§Ù„ØªØ±ØªÙŠØ¨
        let currentPage = 1;
        let employeesPerPage = 30;
        let sortColumn = 'name';
        let sortDirection = 'asc'; // asc Ø£Ùˆ desc
        let departments = ['ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', 'Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', 'Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©', 'Ø§Ù„ØªØ³ÙˆÙŠÙ‚', 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©']; // Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©

        // ==================== Real-time Synchronization System ====================
        let realtimeListeners = []; // Ù…ØµÙÙˆÙØ© Ù„Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ†
        let isRealtimeEnabled = false; // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ²Ø§Ù…Ù† Ø§Ù„ÙÙˆØ±ÙŠ
        let realtimeStatus = 'disconnected'; // Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„: connected, disconnected, error

        // ÙˆØ¸ÙŠÙØ© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†
        function refreshIcons() {
            try {
                // Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¯Ù…Ø¬ ÙŠØ¹Ù…Ù„ Ø¯Ø§Ø¦Ù…Ø§Ù‹
                lucide.createIcons();
            } catch (error) {
                console.warn('âš ï¸ Icon refresh failed:', error);
            }
        }

        // ==================== Real-time Synchronization Functions ====================
        
        // ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ²Ø§Ù…Ù† Ø§Ù„ÙÙˆØ±ÙŠ
        function initializeRealtimeSync() {
            if (typeof firebase === 'undefined' || !db) {
                console.warn('âš ï¸ Firebase not available - Real-time sync disabled');
                return false;
            }

            try {
                console.log('ğŸ”„ Initializing real-time synchronization...');
                
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ø§Ù„Ø³Ø§Ø¨Ù‚ÙŠÙ†
                cleanupRealtimeListeners();
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
                setupEmployeesListener();
                setupLeaveRecordsListener();
                setupSaturdayShiftsListener();
                setupCurrentAttendanceListener();
                setupResetHistoryListener();
                setupDepartmentsListener();
                
                isRealtimeEnabled = true;
                realtimeStatus = 'connected';
                console.log('âœ… Real-time synchronization enabled');
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¤Ø´Ø± Ø§Ù„Ø§ØªØµØ§Ù„
                showRealtimeStatus('connected');
                
                return true;
            } catch (error) {
                console.error('âŒ Failed to initialize real-time sync:', error);
                realtimeStatus = 'error';
                showRealtimeStatus('error');
                return false;
            }
        }

        // ØªÙ†Ø¸ÙŠÙ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ†
        function cleanupRealtimeListeners() {
            console.log('ğŸ§¹ Cleaning up real-time listeners...');
            realtimeListeners.forEach(unsubscribe => {
                if (typeof unsubscribe === 'function') {
                    unsubscribe();
                }
            });
            realtimeListeners = [];
        }

        // Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function setupEmployeesListener() {
            const unsubscribe = db.collection('employees').onSnapshot(
                (snapshot) => {
                    console.log('ğŸ“Š Employees data updated');
                    
                    const newEmployees = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                    employees = newEmployees;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                    updateEmployeesUI();
                },
                (error) => {
                    console.error('âŒ Employees listener error:', error);
                    handleRealtimeError('employees', error);
                }
            );
            
            realtimeListeners.push(unsubscribe);
        }

        // Ù…Ø³ØªÙ…Ø¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
        function setupLeaveRecordsListener() {
            const unsubscribe = db.collection('leave_records').onSnapshot(
                (snapshot) => {
                    console.log('ğŸ“ Leave records updated');
                    
                    const newRecords = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    
                    leaveRecords = newRecords;
                    updateLeaveRecordsUI();
                },
                (error) => {
                    console.error('âŒ Leave records listener error:', error);
                    handleRealtimeError('leave_records', error);
                }
            );
            
            realtimeListeners.push(unsubscribe);
        }

        // Ù…Ø³ØªÙ…Ø¹ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª
        function setupSaturdayShiftsListener() {
            const unsubscribe = db.collection('saturday_shifts').onSnapshot(
                (snapshot) => {
                    console.log('â° Saturday shifts updated');
                    
                    const newShifts = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    
                    saturdayShifts = newShifts;
                    updateSaturdayShiftsUI();
                },
                (error) => {
                    console.error('âŒ Saturday shifts listener error:', error);
                    handleRealtimeError('saturday_shifts', error);
                }
            );
            
            realtimeListeners.push(unsubscribe);
        }

        // Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠ
        function setupCurrentAttendanceListener() {
            const unsubscribe = db.collection('current_attendance').onSnapshot(
                (snapshot) => {
                    console.log('ğŸ‘¥ Current attendance updated');
                    
                    const newAttendance = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    
                    currentAttendance = newAttendance;
                    updateCurrentAttendeesUI();
                },
                (error) => {
                    console.error('âŒ Current attendance listener error:', error);
                    handleRealtimeError('current_attendance', error);
                }
            );
            
            realtimeListeners.push(unsubscribe);
        }

        // Ù…Ø³ØªÙ…Ø¹ Ø³Ø¬Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
        function setupResetHistoryListener() {
            const unsubscribe = db.collection('reset_history').orderBy('resetDate', 'desc').onSnapshot(
                (snapshot) => {
                    console.log('ğŸ”„ Reset history updated');
                    
                    const newHistory = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    
                    resetHistory = newHistory;
                    updateResetInfo();
                },
                (error) => {
                    console.error('âŒ Reset history listener error:', error);
                    handleRealtimeError('reset_history', error);
                }
            );
            
            realtimeListeners.push(unsubscribe);
        }

        // Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        function setupDepartmentsListener() {
            const unsubscribe = db.collection('departments').onSnapshot(
                (snapshot) => {
                    console.log('ğŸ¢ Departments updated');
                    
                    if (!snapshot.empty) {
                        departments = snapshot.docs.map(doc => doc.data().name);
                        updateDepartmentSelects();
                    }
                },
                (error) => {
                    console.error('âŒ Departments listener error:', error);
                    handleRealtimeError('departments', error);
                }
            );
            
            realtimeListeners.push(unsubscribe);
        }

        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function updateEmployeesUI() {
            try {
                // ØªØ­Ø¯ÙŠØ« Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø£Ø±ØµØ¯Ø©
                updateBalancesView();
                
                // ØªØ­Ø¯ÙŠØ« Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
                loadEmployeeOptions();
                
                // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                filterEmployees();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                updateEmployeeStats();
                updateMainStats();
                
                console.log('âœ… Employees UI updated');
            } catch (error) {
                console.error('âŒ Error updating employees UI:', error);
            }
        }

        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
        function updateLeaveRecordsUI() {
            try {
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                updateMainStats();
                
                // ØªØ­Ø¯ÙŠØ« Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (Ù‚Ø¯ ØªØªØ£Ø«Ø± Ø¨Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©)
                updateBalancesView();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ù…ÙØªÙˆØ­Ø§Ù‹
                const recordsTab = document.getElementById('recordsTab');
                if (recordsTab && !recordsTab.classList.contains('hidden')) {
                    // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù‡Ù†Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                }
                
                console.log('âœ… Leave records UI updated');
            } catch (error) {
                console.error('âŒ Error updating leave records UI:', error);
            }
        }

        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª
        function updateSaturdayShiftsUI() {
            try {
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                updateMainStats();
                
                // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØªÙˆØ­Ø§Ù‹
                const saturdayTab = document.getElementById('saturdayTab');
                if (saturdayTab && !saturdayTab.classList.contains('hidden')) {
                    // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª
                    updateSaturdayTable();
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†
                    updateCurrentAttendees();
                    updateTodayAttendees();
                }
                
                console.log('âœ… Saturday shifts UI updated');
            } catch (error) {
                console.error('âŒ Error updating Saturday shifts UI:', error);
            }
        }

        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠ
        function updateCurrentAttendeesUI() {
            try {
                // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ†
                updateTodayAttendees();
                
                // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                updateCurrentAttendees();
                
                console.log('âœ… Current attendees UI updated');
            } catch (error) {
                console.error('âŒ Error updating current attendees UI:', error);
            }
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø®Ø·Ø§Ø¡ Real-time
        function handleRealtimeError(collection, error) {
            console.error(`âŒ Real-time error in ${collection}:`, error);
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
            realtimeStatus = 'error';
            showRealtimeStatus('error');
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const errorMessage = `Ø®Ø·Ø£ ÙÙŠ ØªØ²Ø§Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª ${collection}. Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.`;
            console.warn(errorMessage);
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†
            setTimeout(() => {
                if (isRealtimeEnabled) {
                    console.log(`ğŸ”„ Retrying connection for ${collection}...`);
                    showRealtimeStatus('reconnecting');
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ²Ø§Ù…Ù† Ø§Ù„ÙÙˆØ±ÙŠ
                    setTimeout(() => {
                        initializeRealtimeSync();
                    }, 1000);
                }
            }, 5000);
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ø­Ø§Ù„Ø© Ø§Ù„ØªØ²Ø§Ù…Ù† Ø§Ù„ÙÙˆØ±ÙŠ
        function showRealtimeStatus(status) {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚
            const existingIndicator = document.getElementById('realtimeIndicator');
            if (existingIndicator) {
                existingIndicator.remove();
            }

            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¤Ø´Ø± Ø¬Ø¯ÙŠØ¯
            const indicator = document.createElement('div');
            indicator.id = 'realtimeIndicator';
            indicator.style.cssText = `
                position: fixed;
                top: 10px;
                right: 10px;
                padding: 0.5rem 1rem;
                border-radius: 20px;
                font-size: 0.8rem;
                font-weight: bold;
                z-index: 1000;
                display: flex;
                align-items: center;
                gap: 0.5rem;
                transition: all 0.3s ease;
                backdrop-filter: blur(10px);
            `;

            let statusText, statusColor, statusIcon;
            
            switch (status) {
                case 'connected':
                    statusText = 'Ù…ØªØ²Ø§Ù…Ù† ÙÙˆØ±ÙŠØ§Ù‹';
                    statusColor = 'var(--neon-green)';
                    statusIcon = 'ğŸŸ¢';
                    break;
                case 'disconnected':
                    statusText = 'ØºÙŠØ± Ù…ØªØµÙ„';
                    statusColor = 'var(--neon-yellow)';
                    statusIcon = 'ğŸŸ¡';
                    break;
                case 'error':
                    statusText = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„';
                    statusColor = 'var(--neon-red)';
                    statusIcon = 'ğŸ”´';
                    break;
                case 'reconnecting':
                    statusText = 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„...';
                    statusColor = 'var(--neon-blue)';
                    statusIcon = 'ğŸ”„';
                    break;
                default:
                    return;
            }

            indicator.style.background = `rgba(0, 35, 102, 0.9)`;
            indicator.style.border = `1px solid ${statusColor}`;
            indicator.style.color = statusColor;
            indicator.innerHTML = `${statusIcon} ${statusText}`;

            document.body.appendChild(indicator);

            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø¤Ø´Ø± Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù† Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØµÙ„
            if (status === 'connected') {
                setTimeout(() => {
                    if (indicator.parentNode) {
                        indicator.style.opacity = '0';
                        setTimeout(() => {
                            if (indicator.parentNode) {
                                indicator.remove();
                            }
                        }, 300);
                    }
                }, 3000);
            }
        }

        // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ²Ø§Ù…Ù† Ø§Ù„ÙÙˆØ±ÙŠ
        function testRealtimeSync() {
            console.log('ğŸ§ª Testing real-time synchronization...');
            
            if (!isRealtimeEnabled) {
                console.warn('âš ï¸ Real-time sync is not enabled');
                return false;
            }
            
            // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Firebase
            if (typeof firebase === 'undefined' || !db) {
                console.error('âŒ Firebase not available for real-time sync');
                return false;
            }
            
            // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ†
            const expectedListeners = 6; // employees, leave_records, saturday_shifts, current_attendance, reset_history, departments
            if (realtimeListeners.length !== expectedListeners) {
                console.warn(`âš ï¸ Expected ${expectedListeners} listeners, but found ${realtimeListeners.length}`);
            }
            
            console.log(`âœ… Real-time sync test passed - ${realtimeListeners.length} listeners active`);
            console.log('ğŸ“Š Real-time status:', realtimeStatus);
            console.log('ğŸ”— Active listeners:', realtimeListeners.length);
            
            return true;
        }

        // Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        window.testRealtime = function() {
            console.log('=== Real-time Synchronization Test ===');
            console.log('ğŸ” Current user:', currentUser?.email || 'Not logged in');
            console.log('ğŸ”¥ Firebase available:', typeof firebase !== 'undefined');
            console.log('ğŸ’¾ Database available:', !!db);
            console.log('âš¡ Real-time enabled:', isRealtimeEnabled);
            console.log('ğŸ“¡ Connection status:', realtimeStatus);
            console.log('ğŸ‘‚ Active listeners:', realtimeListeners.length);
            
            if (isRealtimeEnabled) {
                console.log('âœ… Real-time synchronization is working!');
                console.log('ğŸ’¡ Try opening the system in another browser tab to test multi-user sync');
            } else {
                console.log('âŒ Real-time synchronization is not active');
                console.log('ğŸ’¡ Make sure you are logged in and Firebase is connected');
            }
            
            return {
                enabled: isRealtimeEnabled,
                status: realtimeStatus,
                listeners: realtimeListeners.length,
                firebase: typeof firebase !== 'undefined',
                database: !!db,
                user: currentUser?.email
            };
        };

        // Ø­Ø³Ø§Ø¨Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø­Ù„ÙŠ
        const testAccounts = {
            'admin@company.com': { password: 'admin123', role: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…' },
            'supervisor@company.com': { password: 'super123', role: 'Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø£ÙˆÙ„' },
            'employee@company.com': { password: 'emp123', role: 'Ù…ÙˆØ¸Ù ØªØ¬Ø±ÙŠØ¨ÙŠ' }
        };

        // Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©
        const usernames = {
            'admin': { email: 'admin@company.com', password: 'admin123', role: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…' },
            'supervisor': { email: 'supervisor@company.com', password: 'super123', role: 'Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø£ÙˆÙ„' },
            'employee': { email: 'employee@company.com', password: 'emp123', role: 'Ù…ÙˆØ¸Ù ØªØ¬Ø±ÙŠØ¨ÙŠ' },
            'Ù…Ø¯ÙŠØ±': { email: 'admin@company.com', password: 'admin123', role: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…' },
            'Ù…Ø´Ø±Ù': { email: 'supervisor@company.com', password: 'super123', role: 'Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø£ÙˆÙ„' },
            'Ù…ÙˆØ¸Ù': { email: 'employee@company.com', password: 'emp123', role: 'Ù…ÙˆØ¸Ù ØªØ¬Ø±ÙŠØ¨ÙŠ' }
        };

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded');
            
            // ØªØ£Ø®ÙŠØ± Ù‚ØµÙŠØ± Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª
            setTimeout(() => {
                initializeApp();
            }, 500);
        });

        async function initializeApp() {
            try {
                console.log('ğŸš€ Initializing application...');
                
                // ØªÙ‡ÙŠØ¦Ø© Firebase
                const firebaseReady = await initializeFirebase();
                
                // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª (Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¯Ù…Ø¬ ÙŠØ¹Ù…Ù„ Ø¯Ø§Ø¦Ù…Ø§Ù‹)
                console.log('ğŸ¨ Initializing icon system...');
                lucide.createIcons();
                console.log('âœ… Icon system initialized');
                
                // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                loadSavedLoginData();
                console.log('âœ… Saved login data loaded');
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
                setupEvents();
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
                setupAuthStateListener(firebaseReady);
                
                console.log('âœ… Application initialized successfully');
                
            } catch (error) {
                console.error('âŒ App initialization error:', error);
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¨Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù…Ù† Ø§Ù„ÙˆØ¸Ø§Ø¦Ù
                console.log('ğŸ”„ Attempting minimal initialization...');
                lucide.createIcons();
                loadSavedLoginData();
                setupEvents();
                showLoginScreen();
            }
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
        function setupAuthStateListener(firebaseReady) {
            if (firebaseReady && auth) {
                console.log('ğŸ” Setting up Firebase auth listener...');
                auth.onAuthStateChanged((user) => {
                    try {
                        if (user) {
                            console.log('ğŸ‘¤ Firebase user logged in:', user.email);
                            currentUser = {
                                email: user.email,
                                role: testAccounts[user.email]?.role || 'Ù…Ø³ØªØ®Ø¯Ù…'
                            };
                            showMainScreen();
                            loadData();
                        } else {
                            console.log('ğŸ‘‹ Firebase user logged out');
                            if (!currentUser) {
                                showLoginScreen();
                            }
                        }
                    } catch (error) {
                        console.error('âŒ Auth state change error:', error);
                        showLoginScreen();
                    }
                });
            } else {
                console.log('ğŸ  Using local authentication mode');
                showLoginScreen();
            }
        }

        function setupEvents() {
            console.log('Setting up events...');
            
            // ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ - Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ø§Ù„Ù„Ù…Ø³
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                console.log('ğŸ“± Mobile device detected - enabling touch optimizations');
                
                // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
                document.addEventListener('touchstart', function() {}, { passive: true });
                document.addEventListener('touchmove', function() {}, { passive: true });
            }
            
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', handleLogin);
                console.log('Login form event listener added');
            } else {
                console.error('Login form not found');
            }
            
            // Ø±Ø§Ø¨Ø· Ù†Ø³ÙŠØ§Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
            const forgotPasswordLink = document.getElementById('forgotPasswordLink');
            if (forgotPasswordLink) {
                forgotPasswordLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    showForgotPasswordModal();
                });
                console.log('Forgot password link event listener added');
            }
            
            // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±
            const rememberMeCheckbox = document.getElementById('rememberMe');
            if (rememberMeCheckbox) {
                rememberMeCheckbox.addEventListener('change', function() {
                    if (!this.checked) {
                        localStorage.removeItem('rememberedEmail');
                        localStorage.removeItem('rememberedPassword');
                        localStorage.removeItem('rememberMe');
                    }
                });
            }
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¨Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬Ù‡Ø§
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal-overlay')) {
                    // Ø¥ØºÙ„Ø§Ù‚ Ø£ÙŠ Ù…ÙˆØ¯Ø§Ù„ Ù…ÙØªÙˆØ­
                    if (e.target.id === 'addUserModal') {
                        closeAddUserModal();
                    } else {
                        e.target.classList.remove('show');
                        // Ø¥Ø²Ø§Ù„Ø© Ù…Ù†Ø¹ Ø§Ù„Ø³ÙƒØ±ÙˆÙ„ ÙÙŠ Ø­Ø§Ù„Ø© Ø¥ØºÙ„Ø§Ù‚ Ø£ÙŠ Ù…ÙˆØ¯Ø§Ù„
                        document.body.classList.remove('modal-open');
                    }
                }
            });

            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ù…ÙØªØ§Ø­ Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const openModal = document.querySelector('.modal-overlay.show');
                    if (openModal) {
                        if (openModal.id === 'addUserModal') {
                            closeAddUserModal();
                        } else {
                            openModal.classList.remove('show');
                            document.body.classList.remove('modal-open');
                        }
                    }
                }
            });

            // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø³Ø¬Ù„
            const recordsSearch = document.getElementById('recordsSearch');
            if (recordsSearch) {
                recordsSearch.addEventListener('input', applyRecordsFilters);
            }

            const recordsDateFrom = document.getElementById('recordsDateFrom');
            if (recordsDateFrom) {
                recordsDateFrom.addEventListener('change', applyRecordsFilters);
            }

            const recordsDateTo = document.getElementById('recordsDateTo');
            if (recordsDateTo) {
                recordsDateTo.addEventListener('change', applyRecordsFilters);
            }

            const recordsEmployeeFilter = document.getElementById('recordsEmployeeFilter');
            if (recordsEmployeeFilter) {
                recordsEmployeeFilter.addEventListener('change', applyRecordsFilters);
            }

            const recordsTypeFilter = document.getElementById('recordsTypeFilter');
            if (recordsTypeFilter) {
                recordsTypeFilter.addEventListener('change', applyRecordsFilters);
            }

            const recordsUserFilter = document.getElementById('recordsUserFilter');
            if (recordsUserFilter) {
                recordsUserFilter.addEventListener('change', applyRecordsFilters);
            }

            const clearRecordsFilters = document.getElementById('clearRecordsFilters');
            if (clearRecordsFilters) {
                clearRecordsFilters.addEventListener('click', function() {
                    document.getElementById('recordsSearch').value = '';
                    document.getElementById('recordsDateFrom').value = '';
                    document.getElementById('recordsDateTo').value = '';
                    document.getElementById('recordsEmployeeFilter').value = '';
                    document.getElementById('recordsTypeFilter').value = '';
                    document.getElementById('recordsUserFilter').value = '';
                    applyRecordsFilters();
                });
            }

            const refreshRecords = document.getElementById('refreshRecords');
            if (refreshRecords) {
                refreshRecords.addEventListener('click', loadRecords);
            }

            const recordsPrevPage = document.getElementById('recordsPrevPage');
            if (recordsPrevPage) {
                recordsPrevPage.addEventListener('click', function() {
                    if (currentRecordsPage > 1) {
                        currentRecordsPage--;
                        displayRecords();
                        updateRecordsPagination();
                    }
                });
            }

            const recordsNextPage = document.getElementById('recordsNextPage');
            if (recordsNextPage) {
                recordsNextPage.addEventListener('click', function() {
                    const totalPages = Math.ceil(filteredRecords.length / recordsPerPage);
                    if (currentRecordsPage < totalPages) {
                        currentRecordsPage++;
                        displayRecords();
                        updateRecordsPagination();
                    }
                });
            }
            
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', handleLogout);
                console.log('Logout button event listener added');
            } else {
                console.warn('Logout button not found');
            }
            
            // Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('tab-button') || e.target.closest('.tab-button')) {
                    const button = e.target.classList.contains('tab-button') ? e.target : e.target.closest('.tab-button');
                    const tabName = button.dataset.tab;
                    switchTab(tabName);
                }
            });

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ø´Ø± Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
            window.addEventListener('resize', function() {
                setTimeout(() => {
                    const activeButton = document.querySelector('.tab-button.active');
                    if (activeButton) {
                        updateTabIndicator(activeButton);
                    }
                }, 100);
            });
            
            // Ø£Ø²Ø±Ø§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('leave-type-btn')) {
                    selectLeaveType(e.target);
                }
            });
            
            // ØªØºÙŠÙŠØ± Ø§Ù„Ù…ÙˆØ¸Ù
            document.addEventListener('change', function(e) {
                if (e.target.id === 'recordEmployee') {
                    showEmployeeBalance();
                }
                if (['startDate', 'endDate', 'startTime', 'endTime'].includes(e.target.id)) {
                    calculateDuration();
                }
                if (['arrivalTime', 'departureTime'].includes(e.target.id)) {
                    calculateSaturdayHours();
                }
                if (e.target.id === 'attendanceEmployee') {
                    updateAttendanceButton();
                }
            });
            
            // Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ©
            document.addEventListener('submit', function(e) {
                if (e.target.id === 'recordForm') {
                    e.preventDefault();
                    handleRecordSubmit();
                }
                if (e.target.id === 'saturdayForm') {
                    e.preventDefault();
                    handleSaturdaySubmit();
                }
                if (e.target.id === 'saturdayAttendanceForm') {
                    e.preventDefault();
                    handleAttendanceSubmit();
                }
                if (e.target.id === 'employeeForm') {
                    e.preventDefault();
                    handleEmployeeSubmit();
                }
            });
            
            // Ø£Ø­Ø¯Ø§Ø« Ø¥Ø¶Ø§ÙÙŠØ©
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('edit-employee-btn')) {
                    editEmployee(e.target.dataset.employeeId);
                }
                if (e.target.classList.contains('delete-employee-btn')) {
                    deleteEmployee(e.target.dataset.employeeId);
                }
                if (e.target.id === 'cancelEmployeeBtn') {
                    cancelEmployeeEdit();
                }
                if (e.target.id === 'sortDirection' || e.target.closest('#sortDirection')) {
                    toggleSortDirection();
                }
                if (e.target.id === 'prevPage') {
                    changePage(-1);
                }
                if (e.target.id === 'nextPage') {
                    changePage(1);
                }
                if (e.target.id === 'manageDepartmentsBtn') {
                    openDepartmentsModal();
                }
                if (e.target.id === 'closeDepartmentsModal') {
                    closeDepartmentsModal();
                }
                if (e.target.id === 'addDepartmentBtn') {
                    addDepartment();
                }
                if (e.target.classList.contains('delete-department-btn')) {
                    deleteDepartment(e.target.dataset.department);
                }
                
                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
                if (e.target.id === 'departmentsModal') {
                    closeDepartmentsModal();
                }
                
                // Ø£Ø²Ø±Ø§Ø± Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø©
                if (e.target.id === 'resetBalancesBtn') {
                    openResetBalancesModal();
                }
                if (e.target.id === 'viewResetHistoryBtn') {
                    openResetHistoryModal();
                }
                if (e.target.id === 'confirmResetBtn') {
                    executeResetBalances();
                }
                if (e.target.id === 'cancelResetBtn') {
                    closeResetBalancesModal();
                }
                if (e.target.id === 'closeResetModal') {
                    closeResetBalancesModal();
                }
                if (e.target.id === 'closeHistoryModal') {
                    closeResetHistoryModal();
                }
                
                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
                if (e.target.id === 'resetBalancesModal') {
                    closeResetBalancesModal();
                }
                if (e.target.id === 'resetHistoryModal') {
                    closeResetHistoryModal();
                }
            });
            
            // Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±Ø© Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†
            const searchEmployee = document.getElementById('searchEmployee');
            if (searchEmployee) {
                searchEmployee.addEventListener('input', filterEmployees);
                console.log('Search employee event listener added');
            }
            
            const departmentFilter = document.getElementById('departmentFilter');
            if (departmentFilter) {
                departmentFilter.addEventListener('change', filterEmployees);
                console.log('Department filter event listener added');
            }
            
            const sortColumn = document.getElementById('sortColumn');
            if (sortColumn) {
                sortColumn.addEventListener('change', filterEmployees);
                console.log('Sort column event listener added');
            }
            
            const sortDirection = document.getElementById('sortDirection');
            if (sortDirection) {
                sortDirection.addEventListener('click', function() {
                    const icon = document.getElementById('sortIcon');
                    if (icon.getAttribute('data-lucide') === 'arrow-up') {
                        icon.setAttribute('data-lucide', 'arrow-down');
                    } else {
                        icon.setAttribute('data-lucide', 'arrow-up');
                    }
                    lucide.createIcons();
                    filterEmployees();
                });
                console.log('Sort direction event listener added');
            }
            document.addEventListener('input', function(e) {
                if (e.target.id === 'searchEmployee') {
                    currentPage = 1;
                    filterEmployees();
                }
            });
            
            document.addEventListener('change', function(e) {
                if (e.target.id === 'departmentFilter') {
                    currentPage = 1;
                    filterEmployees();
                }
                if (e.target.id === 'sortColumn') {
                    sortColumn = e.target.value;
                    currentPage = 1;
                    filterEmployees();
                }
                if (e.target.id === 'employeePhoto') {
                    handlePhotoPreview(e.target);
                }
            });

            // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† - Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ø§Ù„Ù…ÙÙ‚ÙˆØ¯ÙŠÙ†
            const addUserBtn = document.getElementById('addNewUser');
            if (addUserBtn) {
                addUserBtn.addEventListener('click', addNewUser);
                console.log('Add user button event listener added');
            }

            const addUserForm = document.getElementById('addUserForm');
            if (addUserForm) {
                addUserForm.addEventListener('submit', handleAddUserSubmit);
                console.log('Add user form event listener added');
            }

            const closeAddUserModalBtn = document.getElementById('closeAddUserModal');
            if (closeAddUserModalBtn) {
                closeAddUserModalBtn.addEventListener('click', closeAddUserModal);
                console.log('Close add user modal event listener added');
            }

            const cancelAddUserBtn = document.getElementById('cancelAddUser');
            if (cancelAddUserBtn) {
                cancelAddUserBtn.addEventListener('click', closeAddUserModal);
                console.log('Cancel add user event listener added');
            }
        }

        async function loadData() {
            try {
                if (typeof firebase !== 'undefined' && db) {
                    console.log('ğŸ”„ Loading data with real-time synchronization...');
                    
                    // Ù…Ø­Ø§ÙˆÙ„Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ²Ø§Ù…Ù† Ø§Ù„ÙÙˆØ±ÙŠ
                    const realtimeSuccess = initializeRealtimeSync();
                    
                    if (realtimeSuccess) {
                        console.log('âœ… Real-time sync enabled - data will update automatically');
                        
                        // ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ„ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ)
                        await loadInitialData();
                        
                        // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ²Ø§Ù…Ù† Ø§Ù„ÙÙˆØ±ÙŠ
                        setTimeout(() => {
                            testRealtimeSync();
                        }, 2000);
                    } else {
                        console.warn('âš ï¸ Real-time sync failed, falling back to static loading');
                        await loadStaticData();
                    }
                } else {
                    console.warn('âš ï¸ Firebase not available, using local test data');
                    loadTestData();
                }
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
                await loadDepartments();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª
                updateAllUI();
                
            } catch (error) {
                console.error('âŒ Error loading data:', error);
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
                loadTestData();
                updateAllUI();
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© (Ù„Ù„ØªØ²Ø§Ù…Ù† Ø§Ù„ÙÙˆØ±ÙŠ)
        async function loadInitialData() {
            try {
                // ØªØ­Ù…ÙŠÙ„ Ø³Ø±ÙŠØ¹ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                // Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙˆÙ† Ø³ÙŠØªÙˆÙ„ÙˆÙ† Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù„Ø§Ø­Ù‚Ø©
                console.log('ğŸ“Š Loading initial data...');
                
                // Ù„Ø§ Ù†Ø­ØªØ§Ø¬ ØªØ­Ù…ÙŠÙ„ Ù…ÙØµÙ„ Ù‡Ù†Ø§ Ù„Ø£Ù† Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ø³ÙŠÙ‚ÙˆÙ…ÙˆÙ† Ø¨Ø°Ù„Ùƒ
                // ÙÙ‚Ø· Ù†ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                
            } catch (error) {
                console.error('âŒ Error loading initial data:', error);
                throw error;
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© (fallback)
        async function loadStaticData() {
            try {
                console.log('ğŸ“Š Loading static data...');
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ù† Firebase
                const employeesSnapshot = await db.collection('employees').get();
                employees = employeesSnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                console.log('Loaded employees:', employees);
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                const recordsSnapshot = await db.collection('leave_records').get();
                leaveRecords = recordsSnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                console.log('Loaded records:', leaveRecords);
                
                // ØªØ­Ù…ÙŠÙ„ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª
                const saturdaySnapshot = await db.collection('saturday_shifts').get();
                saturdayShifts = saturdaySnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                console.log('Loaded saturday shifts:', saturdayShifts);
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠ
                const attendanceSnapshot = await db.collection('current_attendance').get();
                currentAttendance = attendanceSnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                console.log('Loaded current attendance:', currentAttendance);
                
                // ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
                await loadResetHistory();
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø¶Ø§ÙÙŠÙ† Ù…Ù† localStorage
                const savedUsers = localStorage.getItem('systemUsers');
                if (savedUsers) {
                    try {
                        systemUsers = JSON.parse(savedUsers);
                        console.log('âœ… Loaded', systemUsers.length, 'custom users from localStorage');
                    } catch (error) {
                        console.error('âŒ Error loading systemUsers from localStorage:', error);
                        systemUsers = [];
                    }
                } else {
                    systemUsers = [];
                    console.log('â„¹ï¸ No custom users found in localStorage');
                }
                
            } catch (error) {
                console.error('âŒ Error loading static data:', error);
                throw error;
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function updateAllUI() {
            try {
                console.log('ğŸ¨ Updating all UI components...');
                
                // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ø±ØµØ¯Ø©
                updateBalancesView();
                
                // ØªØ­Ù…ÙŠÙ„ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                loadEmployeeOptions();
                
                // ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø£Ù‚Ø³Ø§Ù… (Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)
                updateDepartmentSelects();
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
                updateResetInfo();
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
                checkResetAlerts();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆØ¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ†
                updateCurrentDate();
                updateTodayAttendees();
                updateCurrentAttendees();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                updateMainStats();
                
                // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                updateEmployeeStats();
                
                // ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„
                filterEmployees();
                
                console.log('âœ… All UI components updated');
                
            } catch (error) {
                console.error('âŒ Error updating UI:', error);
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
        function loadTestData() {
            employees = [
                {
                    id: 'emp1',
                    name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ',
                    department: 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
                    regularBalance: 30,
                    regularUsed: 5,
                    emergencyBalance: 7,
                    emergencyUsed: 2,
                    sickUsed: 1,
                    permissionHours: 12
                },
                {
                    id: 'emp2',
                    name: 'ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ Ø­Ø³Ù†',
                    department: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©',
                    regularBalance: 45,
                    regularUsed: 8,
                    emergencyBalance: 7,
                    emergencyUsed: 1,
                    sickUsed: 0,
                    permissionHours: 6
                },
                {
                    id: 'emp3',
                    name: 'Ù…Ø­Ù…Ø¯ Ø³Ø§Ù„Ù… Ø£Ø­Ù…Ø¯',
                    department: 'Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                    regularBalance: 30,
                    regularUsed: 12,
                    emergencyBalance: 7,
                    emergencyUsed: 3,
                    sickUsed: 2,
                    permissionHours: 18
                },
                {
                    id: 'emp4',
                    name: 'Ù†ÙˆØ±Ø§ Ø£Ø­Ù…Ø¯ ÙŠÙˆØ³Ù',
                    department: 'Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©',
                    regularBalance: 30,
                    regularUsed: 3,
                    emergencyBalance: 7,
                    emergencyUsed: 0,
                    sickUsed: 1,
                    permissionHours: 4
                },
                {
                    id: 'emp5',
                    name: 'Ø®Ø§Ù„Ø¯ ÙŠÙˆØ³Ù Ù…Ø­Ù…Ø¯',
                    department: 'Ø§Ù„ØªØ³ÙˆÙŠÙ‚',
                    regularBalance: 45,
                    regularUsed: 15,
                    emergencyBalance: 7,
                    emergencyUsed: 2,
                    sickUsed: 0,
                    permissionHours: 21
                }
            ];
            saturdayShifts = [];
            currentAttendance = [];
            
            // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
            leaveRecords = [
                {
                    id: 'leave1',
                    employeeId: 'emp1',
                    employeeName: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ',
                    type: 'regular',
                    typeArabic: 'Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ',
                    date: '2024-01-15',
                    duration: 3,
                    balanceBefore: 30,
                    balanceAfter: 27,
                    createdBy: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…',
                    notes: 'Ø¥Ø¬Ø§Ø²Ø© Ø¹Ø§Ø¦Ù„ÙŠØ©'
                },
                {
                    id: 'leave2',
                    employeeId: 'emp1',
                    employeeName: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ',
                    type: 'emergency',
                    typeArabic: 'Ø¹Ø§Ø±Ø¶Ø©',
                    date: '2024-02-10',
                    duration: 1,
                    balanceBefore: 7,
                    balanceAfter: 6,
                    createdBy: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…',
                    notes: 'Ø¸Ø±ÙˆÙ Ø·Ø§Ø±Ø¦Ø©'
                },
                {
                    id: 'leave3',
                    employeeId: 'emp2',
                    employeeName: 'ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ Ø­Ø³Ù†',
                    type: 'regular',
                    typeArabic: 'Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ',
                    date: '2024-01-20',
                    duration: 5,
                    balanceBefore: 45,
                    balanceAfter: 40,
                    createdBy: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…',
                    notes: 'Ø¥Ø¬Ø§Ø²Ø© Ø³Ù†ÙˆÙŠØ©'
                },
                {
                    id: 'leave4',
                    employeeId: 'emp3',
                    employeeName: 'Ù…Ø­Ù…Ø¯ Ø³Ø§Ù„Ù… Ø£Ø­Ù…Ø¯',
                    type: 'permission',
                    typeArabic: 'Ø¥Ø°Ù†',
                    date: '2024-02-05',
                    duration: 4,
                    balanceBefore: 18,
                    balanceAfter: 14,
                    createdBy: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…',
                    notes: 'Ø¥Ø°Ù† Ø´Ø®ØµÙŠ'
                },
                {
                    id: 'leave5',
                    employeeId: 'emp2',
                    employeeName: 'ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ Ø­Ø³Ù†',
                    type: 'sick',
                    typeArabic: 'Ù…Ø±Ø¶ÙŠ',
                    date: '2024-02-15',
                    duration: 2,
                    balanceBefore: 40,
                    balanceAfter: 38,
                    createdBy: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…',
                    notes: 'Ø¥Ø¬Ø§Ø²Ø© Ù…Ø±Ø¶ÙŠØ©'
                },
                {
                    id: 'leave6',
                    employeeId: 'emp4',
                    employeeName: 'Ù†ÙˆØ±Ø§ Ø£Ø­Ù…Ø¯ ÙŠÙˆØ³Ù',
                    type: 'regular',
                    typeArabic: 'Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ',
                    date: '2024-01-25',
                    duration: 1,
                    balanceBefore: 30,
                    balanceAfter: 29,
                    createdBy: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…',
                    notes: 'ÙŠÙˆÙ… Ø±Ø§Ø­Ø©'
                }
            ];
            
            resetHistory = [];
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø¶Ø§ÙÙŠÙ† Ù…Ù† localStorage
            const savedUsers = localStorage.getItem('systemUsers');
            if (savedUsers) {
                try {
                    systemUsers = JSON.parse(savedUsers);
                    console.log('âœ… Loaded', systemUsers.length, 'custom users from localStorage');
                } catch (error) {
                    console.error('âŒ Error loading systemUsers from localStorage:', error);
                    systemUsers = [];
                }
            } else {
                systemUsers = [];
                console.log('â„¹ï¸ No custom users found in localStorage');
            }
            
            console.log('Test data loaded successfully');
            
            // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ localStorage
            localStorage.setItem('employees', JSON.stringify(employees));
            localStorage.setItem('leaveRecords', JSON.stringify(leaveRecords));
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©
            updateAllUI();
        }

        // ØªØ­Ù…ÙŠÙ„ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function loadEmployeeOptions() {
            const recordSelect = document.getElementById('recordEmployee');
            const saturdaySelect = document.getElementById('saturdayEmployee');
            const attendanceSelect = document.getElementById('attendanceEmployee');
            
            if (recordSelect) {
                recordSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù --</option>';
                employees.forEach(employee => {
                    const option = document.createElement('option');
                    option.value = employee.id;
                    option.textContent = `${employee.name} - ${employee.department}`;
                    recordSelect.appendChild(option);
                });
            }
            
            if (saturdaySelect) {
                saturdaySelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù --</option>';
                employees.forEach(employee => {
                    const option = document.createElement('option');
                    option.value = employee.id;
                    option.textContent = `${employee.name} - ${employee.department}`;
                    saturdaySelect.appendChild(option);
                });
            }
            
            if (attendanceSelect) {
                attendanceSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù --</option>';
                employees.forEach(employee => {
                    const option = document.createElement('option');
                    option.value = employee.id;
                    option.textContent = `${employee.name} - ${employee.department}`;
                    attendanceSelect.appendChild(option);
                });
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        function updateMainStats() {
            // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
            const totalEmployeesElement = document.getElementById('totalEmployees');
            if (totalEmployeesElement) {
                totalEmployeesElement.textContent = employees.length;
            }
            
            // Ø£Ø±ØµØ¯Ø© Ù…Ù†ØªÙ‡ÙŠØ© (Ø£Ù‚Ù„ Ù…Ù† 5 Ø£ÙŠØ§Ù…)
            const expiredCount = employees.filter(emp => {
                const remaining = (emp.regularBalance || 30) - (emp.regularUsed || 0);
                return remaining < 5;
            }).length;
            const expiredBalancesElement = document.getElementById('expiredBalances');
            if (expiredBalancesElement) {
                expiredBalancesElement.textContent = expiredCount;
            }
            
            // ÙÙŠ Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„ÙŠÙˆÙ…
            const today = new Date().toISOString().split('T')[0];
            const todayLeavesCount = leaveRecords.filter(record => {
                const startDate = record.startDate;
                const endDate = record.endDate || record.startDate;
                return today >= startDate && today <= endDate && record.type !== 'permission';
            }).length;
            const todayLeavesElement = document.getElementById('todayLeaves');
            if (todayLeavesElement) {
                todayLeavesElement.textContent = todayLeavesCount;
            }
            
            // Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
            const weekStart = getWeekStart(new Date());
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekEnd.getDate() + 6);
            
            const weekSaturdaysCount = saturdayShifts.filter(shift => {
                const shiftDate = new Date(shift.date);
                return shiftDate >= weekStart && shiftDate <= weekEnd;
            }).length;
            const weekSaturdaysElement = document.getElementById('weekSaturdays');
            if (weekSaturdaysElement) {
                weekSaturdaysElement.textContent = weekSaturdaysCount;
            }
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (Ø§Ù„Ø³Ø¨Øª)
        function getWeekStart(date) {
            const d = new Date(date);
            const day = d.getDay();
            const diff = d.getDate() - day + (day === 0 ? -6 : 1) - 1; // Ø§Ù„Ø³Ø¨Øª = Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
            return new Date(d.setDate(diff));
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        
        // ==================== ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø© ====================
        
        // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
        function updateResetInfo() {
            const currentYear = new Date().getFullYear();
            const currentMonth = new Date().getMonth() + 1; // 0-based
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            let fiscalYear;
            if (currentMonth >= 7) {
                fiscalYear = currentYear + '-' + (currentYear + 1);
            } else {
                fiscalYear = (currentYear - 1) + '-' + currentYear;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©
            const fiscalYearElement = document.getElementById('currentFiscalYear');
            if (fiscalYearElement) {
                fiscalYearElement.textContent = fiscalYear;
            }
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ø­ØªÙ‰ 1 ÙŠÙˆÙ„ÙŠÙˆ Ø§Ù„Ù‚Ø§Ø¯Ù…
            const nextJuly = new Date();
            if (currentMonth >= 7) {
                nextJuly.setFullYear(currentYear + 1, 6, 1); // ÙŠÙˆÙ„ÙŠÙˆ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©
            } else {
                nextJuly.setFullYear(currentYear, 6, 1); // ÙŠÙˆÙ„ÙŠÙˆ Ù‡Ø°Ù‡ Ø§Ù„Ø³Ù†Ø©
            }
            
            const today = new Date();
            const daysUntilJuly = Math.ceil((nextJuly - today) / (1000 * 60 * 60 * 24));
            
            const daysElement = document.getElementById('daysUntilJuly');
            if (daysElement) {
                if (daysUntilJuly > 0) {
                    daysElement.textContent = daysUntilJuly + ' ÙŠÙˆÙ…';
                } else if (daysUntilJuly === 0) {
                    daysElement.textContent = 'Ø§Ù„ÙŠÙˆÙ…!';
                } else {
                    daysElement.textContent = 'Ù…ØªØ£Ø®Ø± ' + Math.abs(daysUntilJuly) + ' ÙŠÙˆÙ…';
                }
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©
            updateResetStatus(daysUntilJuly);
            
            // ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
            updateLastResetDate();
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
        function updateResetStatus(daysUntilJuly) {
            const statusElement = document.getElementById('resetStatus');
            if (!statusElement) return;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¢Ø®Ø± Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
            const currentYear = new Date().getFullYear();
            const currentMonth = new Date().getMonth() + 1;
            let targetYear = currentMonth >= 7 ? currentYear : currentYear - 1;
            
            const hasResetThisYear = resetHistory.some(reset => reset.year === targetYear);
            
            if (hasResetThisYear) {
                statusElement.innerHTML = '<span style="color: var(--neon-green);">âœ… ØªÙ… Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø³Ù†Ø©</span>';
            } else if (daysUntilJuly > 30) {
                statusElement.innerHTML = '<span style="color: var(--neon-blue);">ğŸ“… Ù‚Ø±ÙŠØ¨Ø§Ù‹</span>';
            } else if (daysUntilJuly > 0) {
                statusElement.innerHTML = '<span style="color: var(--neon-yellow);">âš ï¸ Ù…Ø·Ù„ÙˆØ¨ Ù‚Ø±ÙŠØ¨Ø§Ù‹</span>';
            } else {
                statusElement.innerHTML = '<span style="color: var(--neon-red);">ğŸš¨ Ù…ØªØ£Ø®Ø±</span>';
            }
        }
        
        // ØªØ­Ø¯ÙŠØ« ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
        function updateLastResetDate() {
            const lastResetElement = document.getElementById('lastResetDate');
            if (!lastResetElement) return;
            
            if (resetHistory.length === 0) {
                lastResetElement.textContent = 'Ù„Ù… ÙŠØªÙ… Ø¨Ø¹Ø¯';
                return;
            }
            
            // Ø£Ø­Ø¯Ø« Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
            const latestReset = resetHistory.sort((a, b) => new Date(b.resetDate) - new Date(a.resetDate))[0];
            const resetDate = new Date(latestReset.resetDate);
            const formattedDate = resetDate.toLocaleDateString('ar-SA', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            lastResetElement.textContent = formattedDate;
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
        async function loadResetHistory() {
            try {
                const historySnapshot = await db.collection('reset_history').orderBy('resetDate', 'desc').get();
                resetHistory = historySnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                console.log('Loaded reset history:', resetHistory);
                updateResetInfo();
            } catch (error) {
                console.error('Error loading reset history:', error);
                resetHistory = [];
                updateResetInfo();
            }
        }
        
        // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
        function openResetBalancesModal() {
            const modal = document.getElementById('resetBalancesModal');
            if (!modal) return;
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø§ÙØ°Ø©
            const employeeCountElement = document.getElementById('resetEmployeeCount');
            if (employeeCountElement) {
                employeeCountElement.textContent = employees.length + ' Ù…ÙˆØ¸Ù';
            }
            
            const currentYear = new Date().getFullYear();
            const currentMonth = new Date().getMonth() + 1;
            let newFiscalYear;
            if (currentMonth >= 7) {
                newFiscalYear = (currentYear + 1) + '-' + (currentYear + 2);
            } else {
                newFiscalYear = currentYear + '-' + (currentYear + 1);
            }
            
            const newYearElement = document.getElementById('resetNewYear');
            if (newYearElement) {
                newYearElement.textContent = newFiscalYear;
            }
            
            const resetDateElement = document.getElementById('resetDate');
            if (resetDateElement) {
                const today = new Date();
                const formattedDate = today.toLocaleDateString('ar-SA', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                resetDateElement.textContent = formattedDate;
            }
            
            const resetByElement = document.getElementById('resetBy');
            if (resetByElement && currentUser) {
                resetByElement.textContent = currentUser.email;
            }
            
            modal.classList.remove('hidden');
            modal.style.display = 'flex';
            
            setTimeout(() => {
                lucide.createIcons();
            }, 100);
        }
        
        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
        function closeResetBalancesModal() {
            const modal = document.getElementById('resetBalancesModal');
            if (modal) {
                modal.classList.add('hidden');
                modal.style.display = 'none';
            }
        }
        
        // ØªÙ†ÙÙŠØ° Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø©
        async function executeResetBalances() {
            if (employees.length === 0) {
                showNotification('resetNotification', 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø£Ø±ØµØ¯ØªÙ‡Ù…', 'error');
                return;
            }
            
            const confirmBtn = document.getElementById('confirmResetBtn');
            if (!confirmBtn) return;
            
            const originalText = confirmBtn.innerHTML;
            confirmBtn.disabled = true;
            confirmBtn.innerHTML = '<div class="loading"></div> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°...';
            
            try {
                const currentYear = new Date().getFullYear();
                const currentMonth = new Date().getMonth() + 1;
                let fiscalYear = currentMonth >= 7 ? currentYear : currentYear - 1;
                
                const resetDate = new Date().toISOString().split('T')[0];
                const affectedEmployees = [];
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ù…ÙˆØ¸Ù
                for (const employee of employees) {
                    const oldData = {
                        regularUsed: employee.regularUsed || 0,
                        emergencyUsed: employee.emergencyUsed || 0,
                        sickUsed: employee.sickUsed || 0,
                        permissionHours: employee.permissionHours || 0
                    };
                    
                    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                    const updatedEmployee = {
                        ...employee,
                        previousYearData: {
                            year: fiscalYear,
                            regularBalance: employee.regularBalance || 30,
                            regularUsed: employee.regularUsed || 0,
                            emergencyUsed: employee.emergencyUsed || 0,
                            sickUsed: employee.sickUsed || 0,
                            permissionHours: employee.permissionHours || 0
                        },
                        regularUsed: 0,
                        emergencyUsed: 0,
                        sickUsed: 0,
                        permissionHours: 0,
                        lastResetYear: fiscalYear + 1,
                        lastResetDate: resetDate,
                        updatedAt: new Date()
                    };
                    
                    // ØªØ­Ø¯ÙŠØ« ÙÙŠ Firebase
                    await db.collection('employees').doc(employee.id).update(updatedEmployee);
                    
                    // ØªØ­Ø¯ÙŠØ« ÙÙŠ Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                    const employeeIndex = employees.findIndex(emp => emp.id === employee.id);
                    if (employeeIndex !== -1) {
                        employees[employeeIndex] = updatedEmployee;
                    }
                    
                    affectedEmployees.push({
                        id: employee.id,
                        name: employee.name,
                        oldUsed: oldData.regularUsed,
                        newUsed: 0
                    });
                }
                
                // Ø­ÙØ¸ Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
                const resetRecord = {
                    year: fiscalYear + 1,
                    resetDate: resetDate,
                    resetBy: currentUser.email,
                    employeesCount: employees.length,
                    employeesAffected: affectedEmployees,
                    isAutomatic: false,
                    createdAt: new Date()
                };
                
                const docRef = await db.collection('reset_history').add(resetRecord);
                resetHistory.unshift({
                    id: docRef.id,
                    ...resetRecord
                });
                
                showNotification('resetNotification', 'ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø£Ø±ØµØ¯Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±ÙˆØ¶
                updateResetInfo();
                updateBalancesView();
                updateEmployeesTable();
                updateEmployeeStats();
                
                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¨Ø¹Ø¯ 2 Ø«Ø§Ù†ÙŠØ©
                setTimeout(() => {
                    closeResetBalancesModal();
                }, 2000);
                
            } catch (error) {
                console.error('Error resetting balances:', error);
                showNotification('resetNotification', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø©: ' + error.message, 'error');
            } finally {
                confirmBtn.disabled = false;
                confirmBtn.innerHTML = originalText;
            }
        }
        
        // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø³Ø¬Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
        function openResetHistoryModal() {
            const modal = document.getElementById('resetHistoryModal');
            const content = document.getElementById('resetHistoryContent');
            
            if (!modal || !content) return;
            
            if (resetHistory.length === 0) {
                content.innerHTML = 
                    '<div style="text-align: center; padding: 3rem; color: var(--primary-200);">' +
                        '<i data-lucide="history" style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;"></i>' +
                        '<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø©</p>' +
                    '</div>';
            } else {
                let historyHtml = '';
                
                resetHistory.forEach(reset => {
                    const resetDate = new Date(reset.resetDate);
                    const formattedDate = resetDate.toLocaleDateString('ar-SA', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    
                    historyHtml += 
                        '<div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">' +
                            '<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">' +
                                '<h4 style="color: var(--neon-blue); margin: 0;">Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© ' + reset.year + '</h4>' +
                                '<span style="color: var(--neon-green); font-size: 0.9rem;">' + formattedDate + '</span>' +
                            '</div>' +
                            '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 0.75rem;">' +
                                '<div>' +
                                    '<span style="color: var(--primary-200);">Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†:</span> ' +
                                    '<span style="color: var(--neon-blue); font-weight: bold;">' + reset.employeesCount + '</span>' +
                                '</div>' +
                                '<div>' +
                                    '<span style="color: var(--primary-200);">Ø§Ù„Ù…Ù†ÙØ°:</span> ' +
                                    '<span style="color: var(--neon-yellow); font-weight: bold;">' + reset.resetBy + '</span>' +
                                '</div>' +
                            '</div>' +
                            '<div style="color: var(--primary-200); font-size: 0.9rem;">ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø£Ø±ØµØ¯Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­</div>' +
                        '</div>';
                });
                
                content.innerHTML = historyHtml;
            }
            
            modal.classList.remove('hidden');
            modal.style.display = 'flex';
            
            setTimeout(() => {
                lucide.createIcons();
            }, 100);
        }
        
        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø³Ø¬Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
        function closeResetHistoryModal() {
            const modal = document.getElementById('resetHistoryModal');
            if (modal) {
                modal.classList.add('hidden');
                modal.style.display = 'none';
            }
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
        function checkResetAlerts() {
            const currentYear = new Date().getFullYear();
            const currentMonth = new Date().getMonth() + 1;
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ø­ØªÙ‰ 1 ÙŠÙˆÙ„ÙŠÙˆ
            const nextJuly = new Date();
            if (currentMonth >= 7) {
                nextJuly.setFullYear(currentYear + 1, 6, 1);
            } else {
                nextJuly.setFullYear(currentYear, 6, 1);
            }
            
            const today = new Date();
            const daysUntilJuly = Math.ceil((nextJuly - today) / (1000 * 60 * 60 * 24));
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
            let targetYear = currentMonth >= 7 ? currentYear : currentYear - 1;
            const hasResetThisYear = resetHistory.some(reset => reset.year === targetYear);
            
            // Ø¹Ø±Ø¶ ØªÙ†Ø¨ÙŠÙ‡ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
            if (!hasResetThisYear && (daysUntilJuly <= 30 || daysUntilJuly < 0)) {
                showResetAlert(daysUntilJuly);
            }
        }
        
        // Ø¹Ø±Ø¶ ØªÙ†Ø¨ÙŠÙ‡ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
        function showResetAlert(daysUntilJuly) {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ù† ÙˆØ¬Ø¯
            const existingAlert = document.getElementById('resetAlert');
            if (existingAlert) {
                existingAlert.remove();
            }
            
            let alertMessage;
            let alertColor;
            
            if (daysUntilJuly > 0) {
                alertMessage = 'Ø¨Ø§Ù‚ÙŠ ' + daysUntilJuly + ' ÙŠÙˆÙ… Ø¹Ù„Ù‰ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© - ÙŠÙÙ†ØµØ­ Ø¨Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø£Ø±ØµØ¯Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ù‚Ø±ÙŠØ¨Ø§Ù‹';
                alertColor = 'var(--neon-yellow)';
            } else if (daysUntilJuly === 0) {
                alertMessage = 'Ø§Ù„ÙŠÙˆÙ… Ù‡Ùˆ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© - ÙŠØ¬Ø¨ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø£Ø±ØµØ¯Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª';
                alertColor = 'var(--neon-orange)';
            } else {
                alertMessage = 'ØªØ£Ø®Ø±Øª Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø¨Ù€ ' + Math.abs(daysUntilJuly) + ' ÙŠÙˆÙ… - ÙŠØ¬Ø¨ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† ÙÙˆØ±Ø§Ù‹';
                alertColor = 'var(--neon-red)';
            }
            
            const alertDiv = document.createElement('div');
            alertDiv.id = 'resetAlert';
            alertDiv.style.cssText = 
                'background: rgba(255, 235, 59, 0.1); border: 1px solid ' + alertColor + '; ' +
                'border-radius: 8px; padding: 1rem; margin-bottom: 1rem; ' +
                'display: flex; justify-content: space-between; align-items: center;';
            
            alertDiv.innerHTML = 
                '<div style="display: flex; align-items: center; gap: 0.5rem;">' +
                    '<i data-lucide="alert-triangle" style="color: ' + alertColor + '; width: 20px; height: 20px;"></i>' +
                    '<span style="color: ' + alertColor + ';">' + alertMessage + '</span>' +
                '</div>' +
                '<div style="display: flex; gap: 0.5rem;">' +
                    '<button onclick="switchTab(\'employees\')" class="btn-neon" style="padding: 0.5rem 1rem; font-size: 0.9rem;">\u0625\u0639\u0627\u062F\u0629 \u0627\u0644\u062A\u0639\u064A\u064A\u0646 \u0627\u0644\u0622\u0646</button>' +
                    '<button onclick="document.getElementById(\'resetAlert\').remove()" style="background: none; border: none; color: ' + alertColor + '; cursor: pointer; padding: 0.5rem;">' +
                        '<i data-lucide="x" style="width: 16px; height: 16px;"></i>' +
                    '</button>' +
                '</div>';
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            const mainScreen = document.querySelector('.main-screen');
            if (mainScreen) {
                const welcomeMessage = mainScreen.querySelector('.welcome-message');
                if (welcomeMessage) {
                    welcomeMessage.insertAdjacentElement('afterend', alertDiv);
                    lucide.createIcons();
                }
            }
        }
        
        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ù…Ù† Firebase
        async function loadDepartments() {
            try {
                console.log('Loading departments from Firebase...');
                const departmentsSnapshot = await db.collection('departments').get();
                if (!departmentsSnapshot.empty) {
                    departments = departmentsSnapshot.docs.map(doc => doc.data().name);
                    console.log('Loaded departments from Firebase:', departments);
                } else {
                    console.log('No departments found, creating default ones...');
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Firebase
                    const defaultDepartments = ['ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', 'Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', 'Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©', 'Ø§Ù„ØªØ³ÙˆÙŠÙ‚', 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'];
                    for (const dept of defaultDepartments) {
                        await db.collection('departments').add({ name: dept, createdAt: new Date() });
                    }
                    departments = defaultDepartments;
                    console.log('Created default departments:', departments);
                }
                updateDepartmentSelects();
            } catch (error) {
                console.error('Error loading departments:', error);
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
                departments = ['ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', 'Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', 'Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©', 'Ø§Ù„ØªØ³ÙˆÙŠÙ‚', 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'];
                console.log('Using fallback departments:', departments);
                updateDepartmentSelects();
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
        function updateDepartmentSelects() {
            console.log('Updating department selects with departments:', departments);
            const selects = ['employeeDepartment', 'departmentFilter', 'newUserDepartment'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    const currentValue = select.value;
                    const isFilter = selectId === 'departmentFilter';
                    const isUserForm = selectId === 'newUserDepartment';
                    
                    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Øµ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                    if (isFilter) {
                        select.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>';
                    } else if (isUserForm) {
                        select.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…</option>';
                    } else {
                        select.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù… --</option>';
                    }
                    
                    departments.forEach(dept => {
                        const option = document.createElement('option');
                        option.value = dept;
                        option.textContent = dept;
                        select.appendChild(option);
                    });
                    
                    // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ø³Ø§Ø¨Ù‚Ø§Ù‹
                    if (currentValue && departments.includes(currentValue)) {
                        select.value = currentValue;
                    }
                    
                    console.log(`Updated ${selectId} with ${departments.length} departments`);
                } else {
                    console.warn(`Select element ${selectId} not found`);
                }
            });
        }

        // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        function openDepartmentsModal() {
            console.log('Opening departments modal...');
            const modal = document.getElementById('departmentsModal');
            if (modal) {
                modal.classList.remove('hidden');
                modal.style.display = 'flex';
                updateDepartmentsList();
                // ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
                if (departments.length === 0) {
                    loadDepartments().then(() => {
                        updateDepartmentsList();
                    });
                }
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
                setTimeout(() => {
                    lucide.createIcons();
                }, 100);
            } else {
                console.error('Departments modal not found');
            }
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        function closeDepartmentsModal() {
            const modal = document.getElementById('departmentsModal');
            if (modal) {
                modal.classList.add('hidden');
                modal.style.display = 'none';
            }
            const nameInput = document.getElementById('newDepartmentName');
            if (nameInput) {
                nameInput.value = '';
            }
            
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØªÙˆØ­Ø§Ù‹
            const userModal = document.getElementById('addUserModal');
            if (userModal && userModal.classList.contains('show')) {
                updateDepartmentSelects();
                console.log('âœ… Updated departments in add user form');
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        function updateDepartmentsList() {
            const container = document.getElementById('departmentsList');
            
            if (departments.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--primary-200);">
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‚Ø³Ø§Ù… Ù…Ø¶Ø§ÙØ©</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            
            departments.forEach(dept => {
                const employeeCount = employees.filter(emp => emp.department === dept).length;
                
                const deptElement = document.createElement('div');
                deptElement.style.cssText = `
                    background: rgba(0, 35, 102, 0.2);
                    border: 1px solid rgba(0, 212, 255, 0.2);
                    border-radius: 8px;
                    padding: 1rem;
                    margin-bottom: 0.75rem;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                `;
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù…Ù†ÙØµÙ„Ø©
                const leftDiv = document.createElement('div');
                const nameDiv = document.createElement('div');
                nameDiv.style.cssText = 'color: var(--neon-blue); font-weight: 500;';
                nameDiv.textContent = dept;
                
                const countDiv = document.createElement('div');
                countDiv.style.cssText = 'color: var(--primary-200); font-size: 0.8rem;';
                countDiv.textContent = employeeCount + ' Ù…ÙˆØ¸Ù';
                
                leftDiv.appendChild(nameDiv);
                leftDiv.appendChild(countDiv);
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-department-btn';
                deleteBtn.dataset.department = dept;
                deleteBtn.style.cssText = 'background: rgba(255, 68, 68, 0.2); border: 1px solid rgba(255, 68, 68, 0.5); color: var(--neon-red); padding: 0.5rem; border-radius: 4px; cursor: pointer;';
                
                if (employeeCount > 0) {
                    deleteBtn.disabled = true;
                    deleteBtn.title = 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ù‚Ø³Ù… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…ÙˆØ¸ÙÙŠÙ†';
                    deleteBtn.style.opacity = '0.5';
                    deleteBtn.style.cursor = 'not-allowed';
                }
                
                const deleteIcon = document.createElement('i');
                deleteIcon.setAttribute('data-lucide', 'trash-2');
                deleteIcon.style.cssText = 'width: 16px; height: 16px;';
                deleteBtn.appendChild(deleteIcon);
                
                deptElement.appendChild(leftDiv);
                deptElement.appendChild(deleteBtn);
                container.appendChild(deptElement);
            });
            
            lucide.createIcons();
        }

        // Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯
        async function addDepartment() {
            const deptName = document.getElementById('newDepartmentName').value.trim();
            
            if (!deptName) {
                showNotification('departmentsNotification', 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…', 'error');
                return;
            }
            
            if (departments.includes(deptName)) {
                showNotification('departmentsNotification', 'Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„', 'error');
                return;
            }
            
            try {
                console.log('Adding new department:', deptName);
                // Ø­ÙØ¸ ÙÙŠ Firebase
                await db.collection('departments').add({
                    name: deptName,
                    createdAt: new Date(),
                    createdBy: currentUser.email
                });
                
                // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                departments.push(deptName);
                console.log('Department added. Current departments:', departments);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±ÙˆØ¶
                updateDepartmentSelects();
                updateDepartmentsList();
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø­Ù‚Ù„
                document.getElementById('newDepartmentName').value = '';
                
                showNotification('departmentsNotification', 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø³Ù… Ø¨Ù†Ø¬Ø§Ø­ ÙˆØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬', 'success');
                
            } catch (error) {
                console.error('Error adding department:', error);
                showNotification('departmentsNotification', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø³Ù…: ' + error.message, 'error');
            }
        }

        // Ø­Ø°Ù Ù‚Ø³Ù…
        async function deleteDepartment(deptName) {
            console.log('Attempting to delete department:', deptName);
            
            const employeeCount = employees.filter(emp => emp.department === deptName).length;
            console.log('Employee count in department:', employeeCount);
            
            if (employeeCount > 0) {
                showNotification('departmentsNotification', 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ù‚Ø³Ù… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…ÙˆØ¸ÙÙŠÙ†', 'error');
                return;
            }
            
            const confirmDelete = confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ù… "${deptName}"ØŸ`);
            if (!confirmDelete) return;
            
            try {
                console.log('Deleting department from Firebase...');
                // Ø­Ø°Ù Ù…Ù† Firebase
                const departmentsSnapshot = await db.collection('departments').where('name', '==', deptName).get();
                console.log('Found documents to delete:', departmentsSnapshot.size);
                
                const deletePromises = [];
                departmentsSnapshot.forEach((doc) => {
                    deletePromises.push(doc.ref.delete());
                });
                
                await Promise.all(deletePromises);
                console.log('Department deleted from Firebase');
                
                // Ø­Ø°Ù Ù…Ù† Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                const deptIndex = departments.indexOf(deptName);
                if (deptIndex !== -1) {
                    departments.splice(deptIndex, 1);
                    console.log('Department removed from local array. Remaining departments:', departments);
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±ÙˆØ¶
                updateDepartmentSelects();
                updateDepartmentsList();
                
                showNotification('departmentsNotification', 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ù… Ø¨Ù†Ø¬Ø§Ø­ ÙˆØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬', 'success');
                
            } catch (error) {
                console.error('Error deleting department:', error);
                showNotification('departmentsNotification', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ù…: ' + error.message, 'error');
            }
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        
        // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©
        function handlePhotoPreview(input) {
            const file = input.files[0];
            const preview = document.getElementById('photoPreview');
            const previewImg = document.getElementById('previewImg');
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImg.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            } else {
                preview.classList.add('hidden');
            }
        }

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ Base64
        function convertImageToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // ØªØ¨Ø¯ÙŠÙ„ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØªØ±ØªÙŠØ¨
        function toggleSortDirection() {
            sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            const sortIcon = document.getElementById('sortIcon');
            sortIcon.setAttribute('data-lucide', sortDirection === 'asc' ? 'arrow-up' : 'arrow-down');
            refreshIcons();
            currentPage = 1;
            filterEmployees();
        }

        // ØªØºÙŠÙŠØ± Ø§Ù„ØµÙØ­Ø©
        function changePage(direction) {
            const employeesToShow = filteredEmployees.length > 0 ? filteredEmployees : employees;
            const totalPages = Math.ceil(employeesToShow.length / employeesPerPage);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                updateEmployeesTable();
            }
        }

        // ØªØ­Ø¯ÙŠØ« ØªØ±Ù‚ÙŠÙ… Ø§Ù„ØµÙØ­Ø§Øª
        function updatePagination() {
            const employeesToShow = filteredEmployees.length > 0 ? filteredEmployees : employees;
            const totalPages = Math.ceil(employeesToShow.length / employeesPerPage);
            const pagination = document.getElementById('pagination');
            const pageInfo = document.getElementById('pageInfo');
            const prevBtn = document.getElementById('prevPage');
            const nextBtn = document.getElementById('nextPage');
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ±Ù‚ÙŠÙ… ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø£ÙƒØ«Ø± Ù…Ù† ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø©
            if (totalPages <= 1) {
                pagination.classList.add('hidden');
                return;
            }
            
            pagination.classList.remove('hidden');
            pageInfo.textContent = `ØµÙØ­Ø© ${currentPage} Ù…Ù† ${totalPages} (${employeesToShow.length} Ù…ÙˆØ¸Ù)`;
            
            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages;
            
            prevBtn.style.opacity = currentPage === 1 ? '0.5' : '1';
            nextBtn.style.opacity = currentPage === totalPages ? '0.5' : '1';
        }

        // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function sortEmployees(employeesList) {
            return employeesList.sort((a, b) => {
                let aValue, bValue;
                
                switch (sortColumn) {
                    case 'name':
                        aValue = a.name.toLowerCase();
                        bValue = b.name.toLowerCase();
                        break;
                    case 'department':
                        aValue = a.department.toLowerCase();
                        bValue = b.department.toLowerCase();
                        break;
                    case 'regularBalance':
                        aValue = (a.regularBalance || 30) - (a.regularUsed || 0);
                        bValue = (b.regularBalance || 30) - (b.regularUsed || 0);
                        break;
                    case 'createdAt':
                        aValue = new Date(a.createdAt || 0);
                        bValue = new Date(b.createdAt || 0);
                        break;
                    default:
                        aValue = a.name.toLowerCase();
                        bValue = b.name.toLowerCase();
                }
                
                if (sortDirection === 'asc') {
                    return aValue > bValue ? 1 : -1;
                } else {
                    return aValue < bValue ? 1 : -1;
                }
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function updateEmployeeStats() {
            const totalCount = employees.length;
            const lowBalanceCount = employees.filter(emp => {
                const remaining = (emp.regularBalance || 30) - (emp.regularUsed || 0);
                return remaining < 5;
            }).length;
            
            const departments = [...new Set(employees.map(emp => emp.department))];
            const activeDepartments = departments.length;
            
            const avgBalance = employees.length > 0 ? 
                employees.reduce((sum, emp) => sum + ((emp.regularBalance || 30) - (emp.regularUsed || 0)), 0) / employees.length : 0;
            
            const totalEmployeesCountElement = document.getElementById('totalEmployeesCount');
            if (totalEmployeesCountElement) {
                totalEmployeesCountElement.textContent = totalCount;
            }
            
            const lowBalanceCountElement = document.getElementById('lowBalanceCount');
            if (lowBalanceCountElement) {
                lowBalanceCountElement.textContent = lowBalanceCount;
            }
            
            const activeDepartmentsElement = document.getElementById('activeDepartments');
            if (activeDepartmentsElement) {
                activeDepartmentsElement.textContent = activeDepartments;
            }
            
            const avgBalanceElement = document.getElementById('avgBalance');
            if (avgBalanceElement) {
                avgBalanceElement.textContent = avgBalance.toFixed(1);
            }
        }

        // ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function filterEmployees() {
            const searchTerm = document.getElementById('searchEmployee').value.toLowerCase();
            const departmentFilter = document.getElementById('departmentFilter').value;
            
            // ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
            let filtered = employees.filter(employee => {
                const matchesSearch = employee.name.toLowerCase().includes(searchTerm) ||
                                    employee.department.toLowerCase().includes(searchTerm);
                const matchesDepartment = !departmentFilter || employee.department === departmentFilter;
                
                return matchesSearch && matchesDepartment;
            });
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
            filteredEmployees = sortEmployees(filtered);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
            updateEmployeesTable();
            updatePagination();
        }

        // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function updateEmployeesTable() {
            const tbody = document.getElementById('employeesTableBody');
            const employeesToShow = filteredEmployees.length > 0 ? filteredEmployees : employees;
            
            if (employeesToShow.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 3rem; color: var(--primary-200);">
                            <i data-lucide="users" style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ†</p>
                        </td>
                    </tr>
                `;
                lucide.createIcons();
                document.getElementById('pagination').classList.add('hidden');
                return;
            }
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const startIndex = (currentPage - 1) * employeesPerPage;
            const endIndex = startIndex + employeesPerPage;
            const pageEmployees = employeesToShow.slice(startIndex, endIndex);
            
            tbody.innerHTML = '';
            
            pageEmployees.forEach(employee => {
                const regularRemaining = (employee.regularBalance || 30) - (employee.regularUsed || 0);
                const emergencyRemaining = (employee.emergencyBalance || 7) - (employee.emergencyUsed || 0);
                
                const statusColor = regularRemaining > 10 ? 'var(--neon-green)' : 
                                  regularRemaining > 5 ? 'var(--neon-yellow)' : 'var(--neon-red)';
                const statusText = regularRemaining > 10 ? 'Ø¬ÙŠØ¯' : 
                                 regularRemaining > 5 ? 'Ù…ØªÙˆØ³Ø·' : 'Ù…Ù†Ø®ÙØ¶';
                
                const row = document.createElement('tr');
                row.style.cssText = `
                    border-bottom: 1px solid rgba(0, 212, 255, 0.1);
                    transition: background-color 0.3s ease;
                `;
                
                row.addEventListener('mouseenter', () => {
                    row.style.backgroundColor = 'rgba(0, 212, 255, 0.05)';
                });
                
                row.addEventListener('mouseleave', () => {
                    row.style.backgroundColor = 'transparent';
                });
                
                // ØµÙˆØ±Ø© Ø§Ù„Ù…ÙˆØ¸Ù
                let photoHtml;
                if (employee.photo) {
                    photoHtml = `<img src="${employee.photo}" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid var(--neon-blue);">`;
                } else {
                    photoHtml = `<div style="width: 40px; height: 40px; border-radius: 50%; background: rgba(0, 212, 255, 0.2); display: flex; align-items: center; justify-content: center; border: 2px solid var(--neon-blue);">
                        <i data-lucide="user" style="width: 20px; height: 20px; color: var(--neon-blue);"></i>
                    </div>`;
                }
                
                // Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù
                let notesHtml = '';
                if (employee.notes) {
                    const shortNotes = employee.notes.length > 50 ? employee.notes.substring(0, 50) + '...' : employee.notes;
                    notesHtml = `<div style="font-size: 0.8rem; color: var(--primary-200); margin-top: 0.25rem;">${shortNotes}</div>`;
                }
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… createElement Ù„ØªØ¬Ù†Ø¨ Ù…Ø´Ø§ÙƒÙ„ template strings
                const nameCell = document.createElement('td');
                nameCell.style.cssText = 'padding: 0.75rem; color: var(--neon-blue); font-weight: 500;';
                const nameDiv = document.createElement('div');
                nameDiv.textContent = employee.name;
                nameCell.appendChild(nameDiv);
                
                if (employee.notes) {
                    const notesDiv = document.createElement('div');
                    notesDiv.style.cssText = 'font-size: 0.8rem; color: var(--primary-200); margin-top: 0.25rem;';
                    const shortNotes = employee.notes.length > 50 ? employee.notes.substring(0, 50) + '...' : employee.notes;
                    notesDiv.textContent = shortNotes;
                    nameCell.appendChild(notesDiv);
                }
                
                // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø®Ù„Ø§ÙŠØ§
                const photoCell = document.createElement('td');
                photoCell.style.cssText = 'padding: 0.75rem; text-align: center;';
                photoCell.innerHTML = photoHtml;
                
                const deptCell = document.createElement('td');
                deptCell.style.cssText = 'padding: 0.75rem; text-align: center; color: var(--primary-200);';
                deptCell.textContent = employee.department;
                
                const regularCell = document.createElement('td');
                regularCell.style.cssText = 'padding: 0.75rem; text-align: center; color: var(--neon-green);';
                regularCell.textContent = regularRemaining + '/' + (employee.regularBalance || 30);
                
                const emergencyCell = document.createElement('td');
                emergencyCell.style.cssText = 'padding: 0.75rem; text-align: center; color: var(--neon-yellow);';
                emergencyCell.textContent = emergencyRemaining + '/' + (employee.emergencyBalance || 7);
                
                const permissionCell = document.createElement('td');
                permissionCell.style.cssText = 'padding: 0.75rem; text-align: center; color: var(--neon-orange);';
                permissionCell.textContent = (employee.permissionHours || 0) + 'Ø³';
                
                const statusCell = document.createElement('td');
                statusCell.style.cssText = `padding: 0.75rem; text-align: center; color: ${statusColor}; font-weight: 500;`;
                statusCell.textContent = statusText;
                
                const actionsCell = document.createElement('td');
                actionsCell.style.cssText = 'padding: 0.75rem; text-align: center;';
                
                const actionsDiv = document.createElement('div');
                actionsDiv.style.cssText = 'display: flex; gap: 0.5rem; justify-content: center;';
                
                const editBtn = document.createElement('button');
                editBtn.className = 'edit-employee-btn';
                editBtn.dataset.employeeId = employee.id;
                editBtn.style.cssText = 'background: rgba(0, 212, 255, 0.2); border: 1px solid rgba(0, 212, 255, 0.5); color: var(--neon-blue); padding: 0.25rem 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.8rem;';
                editBtn.innerHTML = '<i data-lucide="edit-2" style="width: 14px; height: 14px;"></i> ØªØ¹Ø¯ÙŠÙ„';
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-employee-btn';
                deleteBtn.dataset.employeeId = employee.id;
                deleteBtn.style.cssText = 'background: rgba(255, 68, 68, 0.2); border: 1px solid rgba(255, 68, 68, 0.5); color: var(--neon-red); padding: 0.25rem 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.8rem;';
                deleteBtn.innerHTML = '<i data-lucide="trash-2" style="width: 14px; height: 14px;"></i> Ø­Ø°Ù';
                
                actionsDiv.appendChild(editBtn);
                actionsDiv.appendChild(deleteBtn);
                actionsCell.appendChild(actionsDiv);
                
                // Ø¥Ø¶Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ù„Ù„ØµÙ
                row.appendChild(photoCell);
                row.appendChild(nameCell);
                row.appendChild(deptCell);
                row.appendChild(regularCell);
                row.appendChild(emergencyCell);
                row.appendChild(permissionCell);
                row.appendChild(statusCell);
                row.appendChild(actionsCell);
                
                tbody.appendChild(row);
            });
            
            lucide.createIcons();
            updatePagination();
        }

        // Ø­ÙØ¸/ØªØ­Ø¯ÙŠØ« Ù…ÙˆØ¸Ù
        async function handleEmployeeSubmit() {
            console.log('Starting employee submit...');
            
            const nameInput = document.getElementById('employeeName');
            const departmentInput = document.getElementById('employeeDepartment');
            const regularBalanceInput = document.getElementById('regularBalance');
            const emergencyBalanceInput = document.getElementById('emergencyBalance');
            const regularUsedInput = document.getElementById('regularUsed');
            const emergencyUsedInput = document.getElementById('emergencyUsed');
            const permissionHoursInput = document.getElementById('permissionHours');
            const sickUsedInput = document.getElementById('sickUsed');
            const notesInput = document.getElementById('employeeNotes');
            const photoInput = document.getElementById('employeePhoto');
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†Ø§ØµØ±
            if (!nameInput || !departmentInput || !regularBalanceInput || !emergencyBalanceInput) {
                console.error('Required form elements not found');
                showNotification('employeesNotification', 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ - ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©', 'error');
                return;
            }
            
            const name = nameInput.value.trim();
            const department = departmentInput.value;
            const regularBalance = parseInt(regularBalanceInput.value);
            const emergencyBalance = parseInt(emergencyBalanceInput.value);
            const regularUsed = parseInt(regularUsedInput ? regularUsedInput.value : 0) || 0;
            const emergencyUsed = parseInt(emergencyUsedInput ? emergencyUsedInput.value : 0) || 0;
            const permissionHours = parseInt(permissionHoursInput ? permissionHoursInput.value : 0) || 0;
            const sickUsed = parseInt(sickUsedInput ? sickUsedInput.value : 0) || 0;
            const notes = notesInput ? notesInput.value.trim() : '';
            const photoFile = photoInput ? photoInput.files[0] : null;
            
            console.log('Form data:', { name, department, regularBalance, emergencyBalance });
            
            if (!name || !department) {
                showNotification('employeesNotification', 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
            
            if (regularUsed > regularBalance || emergencyUsed > emergencyBalance) {
                showNotification('employeesNotification', 'Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„ÙƒÙ„ÙŠ', 'error');
                return;
            }
            
            // ØªØ¹Ø·ÙŠÙ„ Ø²Ø± Ø§Ù„Ø­ÙØ¸ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
            const saveBtn = document.getElementById('saveEmployeeBtn');
            const saveBtnText = document.getElementById('saveEmployeeBtnText');
            if (!saveBtn || !saveBtnText) {
                console.error('Save button elements not found');
                showNotification('employeesNotification', 'Ø®Ø·Ø£ ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'error');
                return;
            }
            
            const originalText = saveBtn.innerHTML;
            saveBtn.disabled = true;
            saveBtnText.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...';
            
            const employeeData = {
                name: name,
                department: department,
                regularBalance: regularBalance,
                emergencyBalance: emergencyBalance,
                regularUsed: regularUsed,
                emergencyUsed: emergencyUsed,
                permissionHours: permissionHours,
                sickUsed: sickUsed,
                notes: notes || null,
                createdBy: currentUser.email,
                updatedAt: new Date()
            };
            
            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±Ø©
            if (photoFile) {
                try {
                    console.log('Processing image...');
                    // ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© (Ø£Ù‚Ù„ Ù…Ù† 1MB)
                    if (photoFile.size > 1024 * 1024) {
                        showNotification('employeesNotification', 'Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹ (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 1MB)', 'error');
                        saveBtn.disabled = false;
                        saveBtn.innerHTML = originalText;
                        return;
                    }
                    
                    const photoBase64 = await convertImageToBase64(photoFile);
                    employeeData.photo = photoBase64;
                    console.log('Image processed successfully');
                } catch (error) {
                    console.error('Error converting image:', error);
                    showNotification('employeesNotification', 'Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±Ø©', 'error');
                    saveBtn.disabled = false;
                    saveBtn.innerHTML = originalText;
                    return;
                }
            }
            
            try {
                console.log('Saving to Firebase...');
                
                if (editingEmployeeId) {
                    // ØªØ­Ø¯ÙŠØ« Ù…ÙˆØ¸Ù Ù…ÙˆØ¬ÙˆØ¯
                    if (!photoFile) {
                        const existingEmployee = employees.find(emp => emp.id === editingEmployeeId);
                        if (existingEmployee && existingEmployee.photo) {
                            employeeData.photo = existingEmployee.photo;
                        }
                    }
                    
                    await db.collection('employees').doc(editingEmployeeId).update(employeeData);
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                    const employeeIndex = employees.findIndex(emp => emp.id === editingEmployeeId);
                    if (employeeIndex !== -1) {
                        employees[employeeIndex] = { id: editingEmployeeId, ...employeeData };
                    }
                    
                    showNotification('employeesNotification', 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    
                } else {
                    // Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯
                    employeeData.createdAt = new Date();
                    console.log('Adding new employee:', employeeData);
                    
                    const docRef = await db.collection('employees').add(employeeData);
                    console.log('Employee added with ID:', docRef.id);
                    
                    // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                    employees.push({
                        id: docRef.id,
                        ...employeeData
                    });
                    
                    showNotification('employeesNotification', 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­', 'success');
                }
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                resetEmployeeForm();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±ÙˆØ¶
                currentPage = 1;
                filterEmployees();
                updateEmployeeStats();
                updateBalancesView();
                loadEmployeeOptions();
                
                console.log('Employee saved successfully');
                
            } catch (error) {
                console.error('Error saving employee:', error);
                showNotification('employeesNotification', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¸Ù: ' + error.message, 'error');
            } finally {
                // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„Ø­ÙØ¸
                saveBtn.disabled = false;
                saveBtn.innerHTML = originalText;
            }
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆØ¸Ù
        function editEmployee(employeeId) {
            const employee = employees.find(emp => emp.id === employeeId);
            if (!employee) return;
            
            editingEmployeeId = employeeId;
            
            // Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù
            document.getElementById('employeeName').value = employee.name;
            document.getElementById('employeeDepartment').value = employee.department;
            document.getElementById('regularBalance').value = employee.regularBalance || 30;
            document.getElementById('emergencyBalance').value = employee.emergencyBalance || 7;
            document.getElementById('regularUsed').value = employee.regularUsed || 0;
            document.getElementById('emergencyUsed').value = employee.emergencyUsed || 0;
            document.getElementById('permissionHours').value = employee.permissionHours || 0;
            document.getElementById('sickUsed').value = employee.sickUsed || 0;
            document.getElementById('employeeNotes').value = employee.notes || '';
            
            // Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const photoPreview = document.getElementById('photoPreview');
            const previewImg = document.getElementById('previewImg');
            if (employee.photo) {
                previewImg.src = employee.photo;
                photoPreview.classList.remove('hidden');
            } else {
                photoPreview.classList.add('hidden');
            }
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            document.getElementById('employeeFormTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù';
            document.getElementById('saveEmployeeBtnText').textContent = 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª';
            document.getElementById('cancelEmployeeBtn').classList.remove('hidden');
        }

        // Ø­Ø°Ù Ù…ÙˆØ¸Ù
        async function deleteEmployee(employeeId) {
            const employee = employees.find(emp => emp.id === employeeId);
            if (!employee) return;
            
            const confirmDelete = confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù "${employee.name}"ØŸ\n\nØ³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹.`);
            if (!confirmDelete) return;
            
            try {
                // Ø­Ø°Ù Ù…Ù† Firebase
                await db.collection('employees').doc(employeeId).delete();
                
                // Ø­Ø°Ù Ù…Ù† Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                const employeeIndex = employees.findIndex(emp => emp.id === employeeId);
                if (employeeIndex !== -1) {
                    employees.splice(employeeIndex, 1);
                }
                
                showNotification('employeesNotification', `ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù "${employee.name}" Ø¨Ù†Ø¬Ø§Ø­`, 'success');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±ÙˆØ¶
                updateEmployeesTable();
                updateEmployeeStats();
                updateBalancesView();
                loadEmployeeOptions();
                
            } catch (error) {
                console.error('Error deleting employee:', error);
                showNotification('employeesNotification', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù', 'error');
            }
        }

        // Ø¥Ù„ØºØ§Ø¡ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù
        function cancelEmployeeEdit() {
            resetEmployeeForm();
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…ÙˆØ¸Ù
        function resetEmployeeForm() {
            editingEmployeeId = null;
            document.getElementById('employeeForm').reset();
            document.getElementById('regularBalance').value = 30;
            document.getElementById('emergencyBalance').value = 7;
            document.getElementById('employeeFormTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯';
            document.getElementById('saveEmployeeBtnText').textContent = 'Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¸Ù';
            document.getElementById('cancelEmployeeBtn').classList.add('hidden');
            document.getElementById('photoPreview').classList.add('hidden');
        }

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª Ø¥Ù„Ù‰ Ù†Ø¸Ø§Ù… 12 Ø³Ø§Ø¹Ø© Ù…Ø¹ AM/PM
        function formatTime12Hour(time24) {
            if (!time24) return '';
            
            const [hours, minutes] = time24.split(':');
            const hour = parseInt(hours);
            const ampm = hour >= 12 ? 'PM' : 'AM';
            const hour12 = hour % 12 || 12;
            
            return `${hour12}:${minutes} ${ampm}`;
        }

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª Ù…Ù† 12 Ø³Ø§Ø¹Ø© Ø¥Ù„Ù‰ 24 Ø³Ø§Ø¹Ø© Ù„Ù„Ø­ÙØ¸
        function formatTime24Hour(time12) {
            if (!time12) return '';
            
            const [time, ampm] = time12.split(' ');
            const [hours, minutes] = time.split(':');
            let hour = parseInt(hours);
            
            if (ampm === 'PM' && hour !== 12) {
                hour += 12;
            } else if (ampm === 'AM' && hour === 12) {
                hour = 0;
            }
            
            return `${hour.toString().padStart(2, '0')}:${minutes}`;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ù†Ø¸Ø§Ù… 24 Ø³Ø§Ø¹Ø©
        function getCurrentTime24() {
            return new Date().toTimeString().slice(0, 5);
        }

        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø²Ø± Ø§Ù„Ø­Ø¶ÙˆØ±/Ø§Ù„Ø§Ù†ØµØ±Ø§Ù
        function updateAttendanceButton() {
            const employeeId = document.getElementById('attendanceEmployee').value;
            const attendanceBtn = document.getElementById('attendanceBtnText');
            const attendanceIcon = document.getElementById('attendanceIcon');
            const departureTimeGroup = document.getElementById('departureTimeGroup');
            const customArrivalTime = document.getElementById('customArrivalTime');
            const customDepartureTime = document.getElementById('customDepartureTime');
            
            if (!employeeId) {
                attendanceBtn.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±';
                attendanceIcon.setAttribute('data-lucide', 'play');
                if (departureTimeGroup) departureTimeGroup.style.display = 'none';
                if (customArrivalTime) customArrivalTime.disabled = false;
                if (customDepartureTime) customDepartureTime.disabled = true;
                lucide.createIcons();
                return;
            }
            
            const today = new Date().toISOString().split('T')[0];
            const existingAttendance = currentAttendance.find(attendance => 
                attendance.employeeId === employeeId && attendance.date === today
            );
            
            if (!existingAttendance || existingAttendance.departureTime) {
                attendanceBtn.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±';
                attendanceIcon.setAttribute('data-lucide', 'play');
                if (departureTimeGroup) departureTimeGroup.style.display = 'none';
                if (customArrivalTime) customArrivalTime.disabled = false;
                if (customDepartureTime) customDepartureTime.disabled = true;
            } else {
                attendanceBtn.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù†ØµØ±Ø§Ù';
                attendanceIcon.setAttribute('data-lucide', 'square');
                if (departureTimeGroup) departureTimeGroup.style.display = 'block';
                if (customArrivalTime) customArrivalTime.disabled = true;
                if (customDepartureTime) customDepartureTime.disabled = false;
            }
            
            lucide.createIcons();
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ
        function updateCurrentDate() {
            const today = new Date();
            const formattedDate = today.toLocaleDateString('ar-SA', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });
            const currentDateElement = document.getElementById('currentDate');
            if (currentDateElement) {
                currentDateElement.textContent = formattedDate;
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø§Ù„ÙŠÙˆÙ…
        function updateTodayAttendees() {
            const today = new Date().toISOString().split('T')[0];
            const todayAttendees = currentAttendance.filter(attendance => 
                attendance.date === today && !attendance.departureTime
            );
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ employeeId
            const uniqueAttendees = todayAttendees.filter((attendance, index, self) => 
                index === self.findIndex(a => a.employeeId === attendance.employeeId)
            );
            
            const todayAttendeesElement = document.getElementById('todayAttendees');
            if (todayAttendeesElement) {
                todayAttendeesElement.textContent = uniqueAttendees.length;
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹
        function updateCurrentAttendees() {
            const container = document.getElementById('currentAttendees');
            if (!container) {
                // Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
                return;
            }
            
            const today = new Date().toISOString().split('T')[0];
            
            // Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø°ÙŠÙ† Ù„Ù… ÙŠÙ†ØµØ±ÙÙˆØ§ Ø¨Ø¹Ø¯ (Ù…Ø¹ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª)
            const todayAttendees = currentAttendance.filter(attendance => 
                attendance.date === today && !attendance.departureTime
            );
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ employeeId
            const uniqueAttendees = todayAttendees.filter((attendance, index, self) => 
                index === self.findIndex(a => a.employeeId === attendance.employeeId)
            );
            
            if (uniqueAttendees.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--primary-200);">
                        <i data-lucide="clock" style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ø­Ø§Ø¶Ø±ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                    </div>
                `;
                lucide.createIcons();
                return;
            }
            
            container.innerHTML = '';
            
            uniqueAttendees.forEach(attendance => {
                const employee = employees.find(emp => emp.id === attendance.employeeId);
                if (!employee) return;
                
                const attendanceElement = document.createElement('div');
                attendanceElement.style.cssText = `
                    background: rgba(0, 35, 102, 0.2);
                    border: 1px solid rgba(0, 212, 255, 0.2);
                    border-radius: 8px;
                    padding: 1rem;
                    margin-bottom: 0.75rem;
                    transition: all 0.3s ease;
                `;
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
                const arrivalParts = attendance.arrivalTime.split(':');
                const arrivalDate = new Date();
                arrivalDate.setHours(parseInt(arrivalParts[0]), parseInt(arrivalParts[1]), 0, 0);
                
                const currentTime = new Date();
                let workingHours = Math.max(0, (currentTime - arrivalDate) / (1000 * 60 * 60));
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ Ø£Ù‚Ù„ Ù…Ù† ÙˆÙ‚Øª Ø§Ù„Ø­Ø¶ÙˆØ±ØŒ ÙÙ‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„Ø­Ø¶ÙˆØ± ÙƒØ§Ù† Ø¨Ø§Ù„Ø£Ù…Ø³
                if (workingHours > 24) {
                    workingHours = workingHours % 24;
                }
                
                // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ù†ØµÙˆØµ
                const progressColor = workingHours >= 8 ? 'var(--neon-green)' : workingHours >= 6 ? 'var(--neon-yellow)' : 'var(--neon-blue)';
                const progressText = workingHours >= 8 ? 'Ù…ÙƒØªÙ…Ù„ âœ“' : 'Ø¨Ø§Ù‚ÙŠ ' + (8 - workingHours).toFixed(1) + ' Ø³Ø§Ø¹Ø©';
                const progressWidth = Math.min(100, (workingHours / 8) * 100);
                
                let countdownHtml = '';
                if (workingHours < 8) {
                    const remainingHours = Math.floor(8 - workingHours);
                    const remainingMinutes = Math.floor(((8 - workingHours) % 1) * 60);
                    countdownHtml = '<div style="text-align: center; font-size: 0.8rem; color: var(--neon-orange); font-weight: 500;">â° ' + remainingHours + 'Ø³ ' + remainingMinutes + 'Ø¯ Ù…ØªØ¨Ù‚ÙŠØ©</div>';
                } else {
                    countdownHtml = '<div style="text-align: center; font-size: 0.8rem; color: var(--neon-green); font-weight: 500;">ğŸ‰ ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ 8 Ø³Ø§Ø¹Ø§Øª!</div>';
                }
                
                attendanceElement.innerHTML = 
                    '<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">' +
                        '<div>' +
                            '<h4 style="color: var(--neon-blue); font-size: 0.9rem; margin-bottom: 0.25rem;">' + employee.name + '</h4>' +
                            '<p style="color: var(--primary-200); font-size: 0.8rem;">Ø­Ø¶Ø± Ø§Ù„Ø³Ø§Ø¹Ø© ' + formatTime12Hour(attendance.arrivalTime) + '</p>' +
                        '</div>' +
                        '<div style="text-align: left;">' +
                            '<span style="color: var(--neon-green); font-weight: bold; font-size: 0.9rem;">' + workingHours.toFixed(1) + ' Ø³Ø§Ø¹Ø©</span>' +
                        '</div>' +
                    '</div>' +
                    '<!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->' +
                    '<div style="margin-bottom: 0.5rem;">' +
                        '<div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">' +
                            '<span style="color: var(--primary-200);">Ø§Ù„ØªÙ‚Ø¯Ù… Ù†Ø­Ùˆ 8 Ø³Ø§Ø¹Ø§Øª</span>' +
                            '<span style="color: ' + progressColor + '; font-weight: bold;">' + progressText + '</span>' +
                        '</div>' +
                        '<div style="height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">' +
                            '<div style="height: 100%; background: ' + progressColor + '; width: ' + progressWidth + '%; transition: width 0.3s ease; border-radius: 4px;"></div>' +
                        '</div>' +
                    '</div>' +
                    '<!-- Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ -->' +
                    countdownHtml;
                
                container.appendChild(attendanceElement);
            });
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±/Ø§Ù„Ø§Ù†ØµØ±Ø§Ù
        async function handleAttendanceSubmit() {
            const employeeId = document.getElementById('attendanceEmployee').value;
            const customArrivalTime = document.getElementById('customArrivalTime').value;
            const customDepartureTime = document.getElementById('customDepartureTime').value;
            
            if (!employeeId) {
                showNotification('saturdayNotification', 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¸Ù', 'error');
                return;
            }
            
            const employee = employees.find(emp => emp.id === employeeId);
            const today = new Date().toISOString().split('T')[0];
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…
            const existingAttendance = currentAttendance.find(attendance => 
                attendance.employeeId === employeeId && attendance.date === today
            );
            
            try {
                if (!existingAttendance) {
                    // ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø¬Ø¯ÙŠØ¯
                    const arrivalTime = customArrivalTime || getCurrentTime24();
                    
                    const attendanceData = {
                        employeeId: employeeId,
                        employeeName: employee.name,
                        date: today,
                        arrivalTime: arrivalTime,
                        departureTime: null,
                        createdBy: currentUser.email,
                        createdAt: new Date()
                    };
                    
                    const docRef = await db.collection('current_attendance').add(attendanceData);
                    
                    // Ù„Ø§ Ù†Ø­ØªØ§Ø¬ Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¯ÙˆÙŠØ§Ù‹ - Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ø¨Ø± real-time listener
                    
                    showNotification('saturdayNotification', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± ' + employee.name + ' Ø§Ù„Ø³Ø§Ø¹Ø© ' + formatTime12Hour(arrivalTime), 'success');
                    
                } else if (!existingAttendance.departureTime) {
                    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù†ØµØ±Ø§Ù
                    const departureTime = customDepartureTime || getCurrentTime24();
                    
                    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø§Ø¹Ø§Øª
                    const arrivalParts = existingAttendance.arrivalTime.split(':');
                    const departureParts = departureTime.split(':');
                    
                    const arrivalDate = new Date();
                    arrivalDate.setHours(parseInt(arrivalParts[0]), parseInt(arrivalParts[1]), 0, 0);
                    
                    const departureDate = new Date();
                    departureDate.setHours(parseInt(departureParts[0]), parseInt(departureParts[1]), 0, 0);
                    
                    let hours = Math.max(0, (departureDate - arrivalDate) / (1000 * 60 * 60));
                    
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØµØ±Ø§Ù Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø­Ø¶ÙˆØ±ØŒ ÙÙ‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ù„ÙŠ
                    if (departureDate < arrivalDate) {
                        hours = Math.max(0, (departureDate.getTime() + 24 * 60 * 60 * 1000 - arrivalDate.getTime()) / (1000 * 60 * 60));
                    }
                    
                    if (hours < 8) {
                        const confirmDeparture = confirm('Ø§Ù„Ù…ÙˆØ¸Ù Ø¹Ù…Ù„ ' + hours.toFixed(1) + ' Ø³Ø§Ø¹Ø© ÙÙ‚Ø· (Ø£Ù‚Ù„ Ù…Ù† 8 Ø³Ø§Ø¹Ø§Øª). Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø§Ù†ØµØ±Ø§ÙØŸ');
                        if (!confirmDeparture) return;
                    }
                    
                    // ØªØ­Ø¯ÙŠØ« Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±
                    await db.collection('current_attendance').doc(existingAttendance.id).update({
                        departureTime: departureTime,
                        hours: parseFloat(hours.toFixed(1))
                    });
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©
                    await db.collection('saturday_shifts').add({
                        employeeId: employeeId,
                        employeeName: employee.name,
                        date: today,
                        arrivalTime: existingAttendance.arrivalTime,
                        departureTime: departureTime,
                        hours: parseFloat(hours.toFixed(1)),
                        notes: null,
                        createdBy: currentUser.email,
                        createdAt: new Date()
                    });
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                    existingAttendance.departureTime = departureTime;
                    existingAttendance.hours = parseFloat(hours.toFixed(1));
                    
                    // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ø¬Ù„ Ø§Ù„Ù…Ø­Ù„ÙŠ
                    saturdayShifts.push({
                        employeeId: employeeId,
                        employeeName: employee.name,
                        date: today,
                        arrivalTime: existingAttendance.arrivalTime,
                        departureTime: departureTime,
                        hours: parseFloat(hours.toFixed(1)),
                        notes: null,
                        createdBy: currentUser.email,
                        createdAt: new Date()
                    });
                    
                    showNotification('saturdayNotification', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù†ØµØ±Ø§Ù ' + employee.name + ' Ø§Ù„Ø³Ø§Ø¹Ø© ' + formatTime12Hour(departureTime) + ' (' + hours.toFixed(1) + ' Ø³Ø§Ø¹Ø©)', 'success');
                    
                } else {
                    showNotification('saturdayNotification', 'Ø§Ù„Ù…ÙˆØ¸Ù Ø³Ø¬Ù„ Ø­Ø¶ÙˆØ± ÙˆØ§Ù†ØµØ±Ø§Ù Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„ÙØ¹Ù„', 'error');
                    return;
                }
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                document.getElementById('saturdayAttendanceForm').reset();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                updateCurrentAttendees();
                updateTodayAttendees();
                updateSaturdayTable();
                updateMainStats();
                updateAttendanceButton();
                
            } catch (error) {
                console.error('Error handling attendance:', error);
                showNotification('saturdayNotification', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±/Ø§Ù„Ø§Ù†ØµØ±Ø§Ù', 'error');
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª
        function updateSaturdayTable() {
            const tbody = document.getElementById('saturdayTableBody');
            if (!tbody) {
                // Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
                return;
            }
            
            if (saturdayShifts.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 3rem; color: var(--primary-200);">
                            <i data-lucide="calendar" style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ù…Ø³Ø¬Ù„Ø©</p>
                        </td>
                    </tr>
                `;
                lucide.createIcons();
                return;
            }
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹)
            const sortedShifts = [...saturdayShifts].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            tbody.innerHTML = '';
            
            sortedShifts.forEach(shift => {
                const row = document.createElement('tr');
                row.style.cssText = `
                    border-bottom: 1px solid rgba(0, 212, 255, 0.1);
                    transition: background-color 0.3s ease;
                `;
                
                row.addEventListener('mouseenter', () => {
                    row.style.backgroundColor = 'rgba(0, 212, 255, 0.05)';
                });
                
                row.addEventListener('mouseleave', () => {
                    row.style.backgroundColor = 'transparent';
                });
                
                const shiftDate = new Date(shift.date);
                const formattedDate = shiftDate.toLocaleDateString('ar-SA', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                });
                
                const statusColor = shift.hours >= 8 ? 'var(--neon-green)' : 'var(--neon-yellow)';
                const statusText = shift.hours >= 8 ? 'Ù…ÙƒØªÙ…Ù„Ø©' : 'Ù†Ø§Ù‚ØµØ©';
                
                row.innerHTML = 
                    '<td style="padding: 0.75rem; color: var(--neon-blue); font-weight: 500;">' + shift.employeeName + '</td>' +
                    '<td style="padding: 0.75rem; text-align: center; color: var(--primary-200);">' + formattedDate + '</td>' +
                    '<td style="padding: 0.75rem; text-align: center; color: var(--neon-green);">' + formatTime12Hour(shift.arrivalTime) + '</td>' +
                    '<td style="padding: 0.75rem; text-align: center; color: var(--neon-red);">' + (shift.departureTime ? formatTime12Hour(shift.departureTime) : '--') + '</td>' +
                    '<td style="padding: 0.75rem; text-align: center; color: var(--neon-blue); font-weight: bold;">' + shift.hours + '</td>' +
                    '<td style="padding: 0.75rem; text-align: center; color: ' + statusColor + '; font-weight: 500;">' + statusText + '</td>';
                
                tbody.appendChild(row);
            });
        }

        // Ø­Ø³Ø§Ø¨ Ø³Ø§Ø¹Ø§Øª Ù†ÙˆØ¨ØªØ¬ÙŠØ© Ø§Ù„Ø³Ø¨Øª
        function calculateSaturdayHours() {
            const arrivalTime = document.getElementById('arrivalTime').value;
            const departureTime = document.getElementById('departureTime').value;
            const hoursDiv = document.getElementById('calculatedHours');
            const hoursText = document.getElementById('hoursText');
            const hoursWarning = document.getElementById('hoursWarning');
            
            if (!arrivalTime || !departureTime) {
                hoursDiv.classList.add('hidden');
                return;
            }
            
            const arrival = new Date(`2000-01-01T${arrivalTime}:00`);
            const departure = new Date(`2000-01-01T${departureTime}:00`);
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØµØ±Ø§Ù Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø­Ø¶ÙˆØ±ØŒ ÙÙ‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„Ø§Ù†ØµØ±Ø§Ù ÙÙŠ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ù„ÙŠ
            if (departure < arrival) {
                departure.setDate(departure.getDate() + 1);
            }
            
            const hours = Math.max(0, (departure - arrival) / (1000 * 60 * 60));
            
            if (hours > 0) {
                hoursText.textContent = `Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª: ${hours.toFixed(1)} Ø³Ø§Ø¹Ø©`;
                
                if (hours < 8) {
                    hoursWarning.classList.remove('hidden');
                } else {
                    hoursWarning.classList.add('hidden');
                }
                
                hoursDiv.classList.remove('hidden');
                lucide.createIcons();
            } else {
                hoursDiv.classList.add('hidden');
            }
        }

        // ØªØ³Ø¬ÙŠÙ„ Ù†ÙˆØ¨ØªØ¬ÙŠØ© Ø§Ù„Ø³Ø¨Øª
        async function handleSaturdaySubmit() {
            const employeeId = document.getElementById('saturdayEmployee').value;
            const saturdayDate = document.getElementById('saturdayDate').value;
            const arrivalTime = document.getElementById('arrivalTime').value;
            const departureTime = document.getElementById('departureTime').value;
            const notes = document.getElementById('saturdayNotes').value;
            
            if (!employeeId) {
                showNotification('saturdayNotification', 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¸Ù', 'error');
                return;
            }
            
            if (!saturdayDate) {
                showNotification('saturdayNotification', 'ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø¨Øª', 'error');
                return;
            }
            
            if (!arrivalTime || !departureTime) {
                showNotification('saturdayNotification', 'ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù', 'error');
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„ØªØ§Ø±ÙŠØ® ÙŠÙˆÙ… Ø³Ø¨Øª
            const selectedDate = new Date(saturdayDate);
            if (selectedDate.getDay() !== 6) {
                showNotification('saturdayNotification', 'Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù„ÙŠØ³ ÙŠÙˆÙ… Ø³Ø¨Øª', 'error');
                return;
            }
            
            // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª
            const arrival = new Date(`2000-01-01T${arrivalTime}:00`);
            const departure = new Date(`2000-01-01T${departureTime}:00`);
            
            if (departure < arrival) {
                departure.setDate(departure.getDate() + 1);
            }
            
            const hours = Math.max(0, (departure - arrival) / (1000 * 60 * 60));
            
            if (hours < 8) {
                showNotification('saturdayNotification', 'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ© 8 Ø³Ø§Ø¹Ø§Øª', 'error');
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ù†ÙˆØ¨ØªØ¬ÙŠØ© Ù…Ø³Ø¬Ù„Ø© Ù„Ù†ÙØ³ Ø§Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ù†ÙØ³ Ø§Ù„ØªØ§Ø±ÙŠØ®
            const existingShift = saturdayShifts.find(shift => 
                shift.employeeId === employeeId && shift.date === saturdayDate
            );
            
            if (existingShift) {
                showNotification('saturdayNotification', 'ÙŠÙˆØ¬Ø¯ Ù†ÙˆØ¨ØªØ¬ÙŠØ© Ù…Ø³Ø¬Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ù†ÙØ³ Ø§Ù„ØªØ§Ø±ÙŠØ®', 'error');
                return;
            }
            
            const employee = employees.find(emp => emp.id === employeeId);
            
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø³Ø¬Ù„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ©
                const shiftData = {
                    employeeId: employeeId,
                    employeeName: employee.name,
                    date: saturdayDate,
                    arrivalTime: arrivalTime,
                    departureTime: departureTime,
                    hours: parseFloat(hours.toFixed(1)),
                    notes: notes || null,
                    createdBy: currentUser.email,
                    createdAt: new Date()
                };
                
                // Ø­ÙØ¸ ÙÙŠ Firebase
                const docRef = await db.collection('saturday_shifts').add(shiftData);
                
                // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                saturdayShifts.push({
                    id: docRef.id,
                    ...shiftData
                });
                
                showNotification('saturdayNotification', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                document.getElementById('saturdayForm').reset();
                document.getElementById('calculatedHours').classList.add('hidden');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                updateSaturdayTable();
                updateSaturdayStats();
                updateMainStats();
                
            } catch (error) {
                console.error('Error recording Saturday shift:', error);
                showNotification('saturdayNotification', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ©', 'error');
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø³Ø¬Ù„ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª (Ø§Ø³ØªØ¨Ø¯Ù„Øª Ø¨Ù€ updateSaturdayTable)
        function updateSaturdayRecords() {
            updateSaturdayTable();
        }

        // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª
        function updateSaturdayStats() {
            const container = document.getElementById('saturdayStats');
            if (!container) {
                // Ø§Ù„Ø¹Ù†ØµØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
                return;
            }
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            const totalShifts = saturdayShifts.length;
            const totalHours = saturdayShifts.reduce((sum, shift) => sum + shift.hours, 0);
            const averageHours = totalShifts > 0 ? (totalHours / totalShifts).toFixed(1) : 0;
            
            // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
            const employeeStats = {};
            saturdayShifts.forEach(shift => {
                if (!employeeStats[shift.employeeId]) {
                    employeeStats[shift.employeeId] = {
                        name: shift.employeeName,
                        shifts: 0,
                        hours: 0
                    };
                }
                employeeStats[shift.employeeId].shifts++;
                employeeStats[shift.employeeId].hours += shift.hours;
            });
            
            const topEmployee = Object.values(employeeStats).sort((a, b) => b.shifts - a.shifts)[0];
            
            container.innerHTML = `
                <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem; text-align: center;">
                    <div style="color: var(--neon-blue); font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem;">${totalShifts}</div>
                    <div style="color: var(--primary-200); font-size: 0.9rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª</div>
                </div>
                <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem; text-align: center;">
                    <div style="color: var(--neon-green); font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem;">${totalHours.toFixed(1)}</div>
                    <div style="color: var(--primary-200); font-size: 0.9rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</div>
                </div>
                <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem; text-align: center;">
                    <div style="color: var(--neon-yellow); font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem;">${averageHours}</div>
                    <div style="color: var(--primary-200); font-size: 0.9rem;">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø§Ø¹Ø§Øª</div>
                </div>
                ${topEmployee ? `
                <div style="background: rgba(0, 35, 102, 0.2); border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 8px; padding: 1rem; text-align: center;">
                    <div style="color: var(--neon-orange); font-size: 1rem; font-weight: bold; margin-bottom: 0.5rem;">${topEmployee.name}</div>
                    <div style="color: var(--primary-200); font-size: 0.9rem;">Ø§Ù„Ø£ÙƒØ«Ø± Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª (${topEmployee.shifts})</div>
                </div>
                ` : ''}
            `;
        }

        // Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©
        function selectLeaveType(button) {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.leave-type-btn').forEach(btn => {
                btn.style.border = '2px solid var(--primary-600)';
                btn.style.background = 'none';
                btn.style.color = 'white';
                btn.classList.remove('active');
            });
            
            // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
            const type = button.dataset.type;
            selectedLeaveType = type;
            button.classList.add('active');
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
            const colors = {
                regular: 'var(--neon-green)',
                emergency: 'var(--neon-yellow)',
                sick: 'var(--neon-red)',
                permission: 'var(--neon-orange)'
            };
            
            button.style.border = `2px solid ${colors[type]}`;
            button.style.background = `${colors[type]}20`;
            button.style.color = colors[type];
            
            // ØªØ¨Ø¯ÙŠÙ„ Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®/Ø§Ù„ÙˆÙ‚Øª
            toggleDateTimeFields(type);
            calculateDuration();
        }

        // ØªØ¨Ø¯ÙŠÙ„ Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®/Ø§Ù„ÙˆÙ‚Øª
        function toggleDateTimeFields(type) {
            const dateFields = document.getElementById('dateFields');
            const timeFields = document.getElementById('timeFields');
            
            if (type === 'permission') {
                dateFields.classList.add('hidden');
                timeFields.classList.remove('hidden');
                document.getElementById('startDate').required = false;
                document.getElementById('endDate').required = false;
                document.getElementById('startTime').required = true;
                document.getElementById('endTime').required = true;
            } else {
                dateFields.classList.remove('hidden');
                timeFields.classList.add('hidden');
                document.getElementById('startDate').required = true;
                document.getElementById('endDate').required = true;
                document.getElementById('startTime').required = false;
                document.getElementById('endTime').required = false;
            }
        }

        // Ø¹Ø±Ø¶ Ø±ØµÙŠØ¯ Ø§Ù„Ù…ÙˆØ¸Ù
        function showEmployeeBalance() {
            const employeeId = document.getElementById('recordEmployee').value;
            const balanceDiv = document.getElementById('employeeBalance');
            const balanceInfo = document.getElementById('balanceInfo');
            
            if (!employeeId || !balanceDiv || !balanceInfo) {
                if (balanceDiv) balanceDiv.classList.add('hidden');
                return;
            }
            
            const employee = employees.find(emp => emp.id === employeeId);
            if (!employee) {
                balanceDiv.classList.add('hidden');
                return;
            }
            
            const regularRemaining = (employee.regularBalance || 30) - (employee.regularUsed || 0);
            const emergencyRemaining = (employee.emergencyBalance || 7) - (employee.emergencyUsed || 0);
            
            const regularColor = regularRemaining > 5 ? 'var(--neon-green)' : 'var(--neon-red)';
            const emergencyColor = emergencyRemaining > 2 ? 'var(--neon-green)' : 'var(--neon-yellow)';
            
            balanceInfo.innerHTML = 
                '<div style="display: flex; justify-content: space-between; margin-bottom: 0.75rem;">' +
                    '<span style="color: var(--primary-200);">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ</span>' +
                    '<span style="font-weight: bold; color: ' + regularColor + '">' + regularRemaining + ' ÙŠÙˆÙ…</span>' +
                '</div>' +
                '<div style="display: flex; justify-content: space-between; margin-bottom: 0.75rem;">' +
                    '<span style="color: var(--primary-200);">Ø±ØµÙŠØ¯ Ø§Ù„Ø¹Ø§Ø±Ø¶Ø©</span>' +
                    '<span style="font-weight: bold; color: ' + emergencyColor + '">' + emergencyRemaining + ' ÙŠÙˆÙ…</span>' +
                '</div>' +
                '<div style="display: flex; justify-content: space-between;">' +
                    '<span style="color: var(--primary-200);">Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª</span>' +
                    '<span style="font-weight: bold; color: var(--neon-orange);">' + (employee.permissionHours || 0) + ' Ø³Ø§Ø¹Ø©</span>' +
                '</div>';
            
            balanceDiv.classList.remove('hidden');
            balanceDiv.classList.remove('hidden');
        }

        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¯Ø©
        function calculateDuration() {
            const durationDiv = document.getElementById('calculatedDuration');
            const durationText = document.getElementById('durationText');
            const permissionWarning = document.getElementById('permissionWarning');
            
            if (!durationDiv) return;
            
            let duration = 0;
            let unit = 'ÙŠÙˆÙ…';
            
            if (selectedLeaveType === 'permission') {
                const startTime = document.getElementById('startTime').value;
                const endTime = document.getElementById('endTime').value;
                
                if (startTime && endTime) {
                    const start = new Date(`2000-01-01T${startTime}:00`);
                    const end = new Date(`2000-01-01T${endTime}:00`);
                    duration = Math.max(0, (end - start) / (1000 * 60 * 60));
                    unit = 'Ø³Ø§Ø¹Ø©';
                }
            } else {
                const startDate = document.getElementById('startDate').value;
                const endDate = document.getElementById('endDate').value;
                
                if (startDate && endDate) {
                    const start = new Date(startDate);
                    const end = new Date(endDate);
                    duration = Math.max(0, Math.floor((end - start) / (1000 * 60 * 60 * 24)) + 1);
                }
            }
            
            if (duration > 0) {
                durationText.textContent = `Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø©: ${duration} ${unit}`;
                
                // ØªØ­Ø°ÙŠØ± Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª
                if (selectedLeaveType === 'permission' && duration >= 7) {
                    const daysToDeduct = Math.floor(duration / 7);
                    permissionWarning.textContent = `âš ï¸ Ø³ÙŠØªÙ… Ø®ØµÙ… ${daysToDeduct} ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ`;
                    permissionWarning.classList.remove('hidden');
                } else {
                    permissionWarning.classList.add('hidden');
                }
                
                durationDiv.classList.remove('hidden');
                lucide.createIcons();
            } else {
                durationDiv.classList.add('hidden');
            }
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ©
        async function handleRecordSubmit() {
            const employeeId = document.getElementById('recordEmployee').value;
            const notes = document.getElementById('recordNotes').value;
            
            if (!employeeId) {
                showNotification('recordNotification', 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¸Ù', 'error');
                return;
            }
            
            const employee = employees.find(emp => emp.id === employeeId);
            let duration = 0;
            let startDate = '';
            let endDate = '';
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¯Ø© ÙˆØ§Ù„ØªÙˆØ§Ø±ÙŠØ®
            if (selectedLeaveType === 'permission') {
                const startTime = document.getElementById('startTime').value;
                const endTime = document.getElementById('endTime').value;
                
                if (!startTime || !endTime) {
                    showNotification('recordNotification', 'ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¥Ø°Ù†', 'error');
                    return;
                }
                
                const start = new Date(`2000-01-01T${startTime}:00`);
                const end = new Date(`2000-01-01T${endTime}:00`);
                duration = Math.max(0, (end - start) / (1000 * 60 * 60));
                startDate = new Date().toISOString().split('T')[0];
            } else {
                startDate = document.getElementById('startDate').value;
                endDate = document.getElementById('endDate').value;
                
                if (!startDate || !endDate) {
                    showNotification('recordNotification', 'ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©', 'error');
                    return;
                }
                
                const start = new Date(startDate);
                const end = new Date(endDate);
                duration = Math.max(0, Math.floor((end - start) / (1000 * 60 * 60 * 24)) + 1);
            }
            
            if (duration <= 0) {
                showNotification('recordNotification', 'Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯
            if (selectedLeaveType === 'regular') {
                const remaining = (employee.regularBalance || 30) - (employee.regularUsed || 0);
                if (duration > remaining) {
                    showNotification('recordNotification', `Ø§Ù„Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ. Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${remaining} ÙŠÙˆÙ…`, 'error');
                    return;
                }
            } else if (selectedLeaveType === 'emergency') {
                const remaining = (employee.emergencyBalance || 7) - (employee.emergencyUsed || 0);
                if (duration > remaining) {
                    showNotification('recordNotification', `Ø±ØµÙŠØ¯ Ø§Ù„Ø¹Ø§Ø±Ø¶Ø© ØºÙŠØ± ÙƒØ§ÙÙŠ. Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${remaining} ÙŠÙˆÙ…`, 'error');
                    return;
                }
            }
            
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø³Ø¬Ù„
                const recordData = {
                    employeeId: employeeId,
                    employeeName: employee.name,
                    type: selectedLeaveType,
                    duration: duration,
                    startDate: startDate,
                    endDate: endDate || startDate,
                    notes: notes || null,
                    createdBy: currentUser.email,
                    createdAt: new Date()
                };
                
                if (selectedLeaveType === 'permission') {
                    recordData.startTime = document.getElementById('startTime').value;
                    recordData.endTime = document.getElementById('endTime').value;
                }
                
                // Ø­ÙØ¸ ÙÙŠ Firebase
                await db.collection('leave_records').add(recordData);
                
                // ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…ÙˆØ¸Ù Ù…Ø­Ù„ÙŠØ§Ù‹
                if (selectedLeaveType === 'regular') {
                    employee.regularUsed = (employee.regularUsed || 0) + duration;
                } else if (selectedLeaveType === 'emergency') {
                    employee.emergencyUsed = (employee.emergencyUsed || 0) + duration;
                } else if (selectedLeaveType === 'sick') {
                    employee.sickUsed = (employee.sickUsed || 0) + duration;
                } else if (selectedLeaveType === 'permission') {
                    const totalPermissionHours = (employee.permissionHours || 0) + duration;
                    const daysToDeduct = Math.floor(totalPermissionHours / 7);
                    const remainingHours = totalPermissionHours % 7;
                    
                    employee.permissionHours = remainingHours;
                    employee.regularUsed = (employee.regularUsed || 0) + daysToDeduct;
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ø®ØµÙ… Ø¥Ø°Ø§ Ø­Ø¯Ø«
                    if (daysToDeduct > 0) {
                        await db.collection('leave_records').add({
                            employeeId: employeeId,
                            employeeName: employee.name,
                            type: 'permission_deducted',
                            duration: daysToDeduct,
                            startDate: startDate,
                            endDate: startDate,
                            notes: `Ø®ØµÙ… ${daysToDeduct} ÙŠÙˆÙ… Ù…Ù† ØªØ¬Ù…ÙŠØ¹ ${totalPermissionHours} Ø³Ø§Ø¹Ø© Ø£Ø°ÙˆÙ†Ø§Øª`,
                            createdBy: currentUser.email,
                            createdAt: new Date()
                        });
                    }
                }
                
                // Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
                const typeNames = {
                    regular: 'Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„Ø§Ø¹ØªÙŠØ§Ø¯ÙŠØ©',
                    emergency: 'Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„Ø¹Ø§Ø±Ø¶Ø©',
                    sick: 'Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„Ù…Ø±Ø¶ÙŠØ©',
                    permission: 'Ø§Ù„Ø¥Ø°Ù†'
                };
                
                showNotification('recordNotification', `ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${typeNames[selectedLeaveType]} Ø¨Ù†Ø¬Ø§Ø­`, 'success');
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                document.getElementById('recordForm').reset();
                selectLeaveType(document.querySelector('[data-type="regular"]'));
                document.getElementById('employeeBalance').classList.add('hidden');
                document.getElementById('calculatedDuration').classList.add('hidden');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                updateBalancesView();
                showEmployeeBalance();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ù…ÙØªÙˆØ­Ø§Ù‹
                const recordsTab = document.getElementById('recordsTab');
                if (recordsTab && !recordsTab.classList.contains('hidden')) {
                    setTimeout(() => {
                        loadRecords();
                    }, 500);
                }
                
            } catch (error) {
                console.error('Error recording leave:', error);
                showNotification('recordNotification', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ©', 'error');
            }
        }

        function updateBalancesView() {
            const container = document.getElementById('balancesContent');
            if (!container) {
                console.warn('balancesContent container not found');
                return;
            }
            
            container.innerHTML = '';
            
            if (employees.length === 0) {
                container.innerHTML = 
                    '<div style="text-align: center; padding: 2rem; color: var(--primary-200);">' +
                        '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙˆØ¸ÙÙŠÙ†</p>' +
                        '<p style="margin-top: 1rem; font-size: 0.9rem;">ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ù† ØªØ¨ÙˆÙŠØ¨ "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†"</p>' +
                    '</div>';
                updateMainStats();
                return;
            }
            
            employees.forEach(employee => {
                const regularRemaining = (employee.regularBalance || 30) - (employee.regularUsed || 0);
                const emergencyRemaining = (employee.emergencyBalance || 7) - (employee.emergencyUsed || 0);
                const regularPercentage = Math.max(0, (regularRemaining / (employee.regularBalance || 30)) * 100);
                const emergencyPercentage = Math.max(0, (emergencyRemaining / (employee.emergencyBalance || 7)) * 100);
                
                // ØªØ­Ø¯ÙŠØ¯ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ¸Ù ÙˆØ£Ù„ÙˆØ§Ù†Ù‡
                let balanceClass, balanceColor, statusClass;
                if (regularPercentage > 70) {
                    balanceClass = 'excellent';
                    balanceColor = 'var(--neon-green)';
                    statusClass = 'excellent';
                } else if (regularPercentage > 50) {
                    balanceClass = 'good';
                    balanceColor = 'var(--neon-blue)';
                    statusClass = 'good';
                } else if (regularPercentage > 20) {
                    balanceClass = 'warning';
                    balanceColor = 'var(--neon-yellow)';
                    statusClass = 'warning';
                } else {
                    balanceClass = 'critical';
                    balanceColor = 'var(--neon-red)';
                    statusClass = 'critical';
                }
                
                const card = document.createElement('div');
                card.className = 'employee-balance-card';
                card.setAttribute('data-employee-id', employee.id);
                card.onclick = () => showEmployeeDetails(employee.id);
                
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø´Ø± Ø§Ù„Ø­Ø§Ù„Ø©
                const statusIndicator = `<div class="status-indicator ${statusClass}"></div>`;
                
                card.innerHTML = statusIndicator +
                    '<div style="margin-bottom: 1rem; position: relative; z-index: 1;">' +
                        '<h3 style="color: var(--neon-blue); font-weight: 600; margin-bottom: 0.5rem; font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem;">' +
                            '<i data-lucide="user" style="width: 18px; height: 18px;"></i>' +
                            employee.name +
                        '</h3>' +
                        '<p style="color: var(--primary-200); font-size: 0.85rem; display: flex; align-items: center; gap: 0.5rem;">' +
                            '<i data-lucide="users" style="width: 14px; height: 14px;"></i>' +
                            employee.department +
                        '</p>' +
                    '</div>' +
                    
                    '<div style="margin-bottom: 1rem; position: relative; z-index: 1;">' +
                        '<div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; margin-bottom: 0.5rem;">' +
                            '<span style="color: var(--primary-200); display: flex; align-items: center; gap: 0.5rem;">' +
                                '<i data-lucide="calendar" style="width: 14px; height: 14px;"></i>' +
                                'Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ' +
                            '</span>' +
                            '<span class="balance-number" style="color: ' + balanceColor + ';">' + regularRemaining + '/' + (employee.regularBalance || 30) + '</span>' +
                        '</div>' +
                        '<div class="progress-bar">' +
                            '<div class="progress-fill" style="background: ' + balanceColor + '; width: ' + regularPercentage + '%;"></div>' +
                        '</div>' +
                    '</div>' +
                    
                    '<div style="margin-bottom: 1rem; position: relative; z-index: 1;">' +
                        '<div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; margin-bottom: 0.5rem;">' +
                            '<span style="color: var(--primary-200); display: flex; align-items: center; gap: 0.5rem;">' +
                                '<i data-lucide="alert-triangle" style="width: 14px; height: 14px;"></i>' +
                                'Ø¹Ø§Ø±Ø¶Ø©' +
                            '</span>' +
                            '<span class="balance-number" style="color: var(--neon-yellow);">' + emergencyRemaining + '/' + (employee.emergencyBalance || 7) + '</span>' +
                        '</div>' +
                        '<div class="progress-bar">' +
                            '<div class="progress-fill" style="background: var(--neon-yellow); width: ' + emergencyPercentage + '%;"></div>' +
                        '</div>' +
                    '</div>' +
                    
                    '<div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; position: relative; z-index: 1;">' +
                        '<span style="color: var(--primary-200); display: flex; align-items: center; gap: 0.5rem;">' +
                            '<i data-lucide="clock" style="width: 14px; height: 14px;"></i>' +
                            'Ø£Ø°ÙˆÙ†Ø§Øª' +
                        '</span>' +
                        '<span class="balance-number" style="color: var(--neon-orange);">' + (employee.permissionHours || 0) + ' Ø³Ø§Ø¹Ø©</span>' +
                    '</div>' +
                    
                    '<div style="position: absolute; bottom: 0.75rem; left: 0.75rem; opacity: 0.3; transition: opacity 0.3s ease;">' +
                        '<i data-lucide="chevron-right" style="width: 16px; height: 16px; color: var(--neon-blue);"></i>' +
                    '</div>';
                
                container.appendChild(card);
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
            lucide.createIcons();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            updateMainStats();
            
            // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¥Ø°Ø§ ÙƒØ§Ù† ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
            if (document.getElementById('employeesTab') && !document.getElementById('employeesTab').classList.contains('hidden')) {
                updateEmployeeStats();
            }
        }

        // ÙˆØ¸ÙŠÙØ© Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø­Ø³Ù†Ø©
        function showEmployeeDetails(employeeId) {
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…ÙˆØ¸Ù
            const employee = employees.find(emp => emp.id === employeeId);
            if (!employee) {
                console.error('Employee not found:', employeeId);
                return;
            }
            
            // Ø¬Ù„Ø¨ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…ÙˆØ¸Ù
            const employeeLeaveRecords = leaveRecords.filter(record => record.employeeId === employeeId);
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±ØµØ¯Ø©
            const regularRemaining = (employee.regularBalance || 30) - (employee.regularUsed || 0);
            const emergencyRemaining = (employee.emergencyBalance || 7) - (employee.emergencyUsed || 0);
            const regularPercentage = Math.max(0, (regularRemaining / (employee.regularBalance || 30)) * 100);
            const emergencyPercentage = Math.max(0, (emergencyRemaining / (employee.emergencyBalance || 7)) * 100);
            
            // ØªØ­Ø¯ÙŠØ¯ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ¸Ù
            let statusColor, statusText;
            if (regularPercentage > 70) {
                statusColor = 'var(--neon-green)';
                statusText = 'Ù…Ù…ØªØ§Ø²';
            } else if (regularPercentage > 50) {
                statusColor = 'var(--neon-blue)';
                statusText = 'Ø¬ÙŠØ¯';
            } else if (regularPercentage > 20) {
                statusColor = 'var(--neon-yellow)';
                statusText = 'ØªØ­Ø°ÙŠØ±';
            } else {
                statusColor = 'var(--neon-red)';
                statusText = 'Ø­Ø±Ø¬';
            }
            
            // Ù…Ù„Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            const employeeInfoSection = document.querySelector('#employeeDetailsModal .employee-info-section');
            if (employeeInfoSection) {
                employeeInfoSection.innerHTML = `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
                        <div style="background: rgba(0, 212, 255, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(0, 212, 255, 0.3);">
                            <h3 style="color: var(--neon-blue); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i data-lucide="user" style="width: 20px; height: 20px;"></i>
                                Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                            </h3>
                            <div style="space-y: 0.75rem;">
                                <div style="margin-bottom: 0.75rem;">
                                    <span style="color: var(--primary-200); font-size: 0.9rem;">Ø§Ù„Ø§Ø³Ù…:</span>
                                    <span style="color: white; font-weight: bold; margin-right: 0.5rem;">${employee.name}</span>
                                </div>
                                <div style="margin-bottom: 0.75rem;">
                                    <span style="color: var(--primary-200); font-size: 0.9rem;">Ø§Ù„Ù‚Ø³Ù…:</span>
                                    <span style="color: white; margin-right: 0.5rem;">${employee.department}</span>
                                </div>
                                <div>
                                    <span style="color: var(--primary-200); font-size: 0.9rem;">Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                                    <span style="color: ${statusColor}; font-weight: bold; margin-right: 0.5rem;">${statusText}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(0, 255, 136, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(0, 255, 136, 0.3);">
                            <h3 style="color: var(--neon-green); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i data-lucide="calendar-check" style="width: 20px; height: 20px;"></i>
                                Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø±ØµØ¯Ø©
                            </h3>
                            <div style="space-y: 1rem;">
                                <div style="margin-bottom: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <span style="color: var(--primary-200); font-size: 0.9rem;">Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ</span>
                                        <span style="color: ${statusColor}; font-weight: bold;">${regularRemaining}/${employee.regularBalance || 30}</span>
                                    </div>
                                    <div class="progress-bar" style="height: 8px;">
                                        <div class="progress-fill" style="background: ${statusColor}; width: ${regularPercentage}%;"></div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <span style="color: var(--primary-200); font-size: 0.9rem;">Ø¹Ø§Ø±Ø¶Ø©</span>
                                        <span style="color: var(--neon-yellow); font-weight: bold;">${emergencyRemaining}/${employee.emergencyBalance || 7}</span>
                                    </div>
                                    <div class="progress-bar" style="height: 8px;">
                                        <div class="progress-fill" style="background: var(--neon-yellow); width: ${emergencyPercentage}%;"></div>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span style="color: var(--primary-200); font-size: 0.9rem;">Ø£Ø°ÙˆÙ†Ø§Øª</span>
                                        <span style="color: var(--neon-orange); font-weight: bold;">${employee.permissionHours || 0} Ø³Ø§Ø¹Ø©</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
            const leaveHistorySection = document.querySelector('#employeeDetailsModal .leave-history-section');
            if (leaveHistorySection) {
                if (employeeLeaveRecords.length === 0) {
                    leaveHistorySection.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: var(--primary-200);">
                            <i data-lucide="calendar-x" style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø²Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸Ù</p>
                        </div>
                    `;
                } else {
                    // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„Ø£Ù‚Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹)
                    const sortedRecords = employeeLeaveRecords.sort((a, b) => new Date(a.date) - new Date(b.date));
                    
                    let historyHTML = `
                        <div class="table-container">
                            <table class="leave-history-table">
                                <thead>
                                    <tr>
                                        <th>Ù…Ø³Ù„Ø³Ù„</th>
                                        <th>Ù…Ù† ØªØ§Ø±ÙŠØ®</th>
                                        <th>Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</th>
                                        <th>Ø§Ù„Ù…Ø¯Ø©</th>
                                        <th>Ø§Ù„Ù†ÙˆØ¹</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    sortedRecords.forEach((record, index) => {
                        // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¨Ø£ÙŠ Ù…Ù† Ø§Ù„ØµÙŠØºØªÙŠÙ†
                        const dateValue = record.date || record.startDate;
                        const recordDate = new Date(dateValue);
                        
                        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ØªØ§Ø±ÙŠØ®
                        if (isNaN(recordDate.getTime())) {
                            console.warn('ØªØ§Ø±ÙŠØ® ØºÙŠØ± ØµØ­ÙŠØ­ ÙÙŠ Ø§Ù„Ø³Ø¬Ù„:', record);
                            return; // ØªØ®Ø·ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¬Ù„
                        }
                        
                        // Ø­Ø³Ø§Ø¨ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ©
                        let fromDate, toDate;
                        
                        // ØªÙ†Ø³ÙŠÙ‚ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
                        fromDate = recordDate.toLocaleDateString('ar-EG', {
                            day: 'numeric',
                            month: 'short',
                            year: 'numeric'
                        });
                        
                        // Ø­Ø³Ø§Ø¨ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
                        if (record.duration > 1 && record.type !== 'permission') {
                            const endDate = new Date(recordDate);
                            endDate.setDate(recordDate.getDate() + (record.duration - 1));
                            toDate = endDate.toLocaleDateString('ar-EG', {
                                day: 'numeric',
                                month: 'short',
                                year: 'numeric'
                            });
                        } else {
                            // Ù†ÙØ³ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù„Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ù„ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯ ÙˆØ§Ù„Ø£Ø°ÙˆÙ†Ø§Øª
                            toDate = fromDate;
                        }
                        
                        // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ ÙˆØ£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©
                        let typeClass, typeIcon, typeText;
                        switch(record.type) {
                            case 'regular':
                                typeClass = 'leave-type-regular';
                                typeIcon = 'calendar';
                                typeText = 'Ø§Ø¹ØªÙŠØ§Ø¯ÙŠ';
                                break;
                            case 'emergency':
                                typeClass = 'leave-type-emergency';
                                typeIcon = 'alert-triangle';
                                typeText = 'Ø¹Ø§Ø±Ø¶Ø©';
                                break;
                            case 'permission':
                                typeClass = 'leave-type-permission';
                                typeIcon = 'clock';
                                typeText = 'Ø¥Ø°Ù†';
                                break;
                            case 'sick':
                                typeClass = 'leave-type-sick';
                                typeIcon = 'heart-pulse';
                                typeText = 'Ù…Ø±Ø¶ÙŠ';
                                break;
                            default:
                                typeClass = 'leave-type-regular';
                                typeIcon = 'calendar';
                                typeText = record.type;
                        }
                        
                        // ØªØ­Ø¯ÙŠØ¯ ÙˆØ­Ø¯Ø© Ø§Ù„Ù…Ø¯Ø©
                        const durationUnit = record.type === 'permission' ? 'Ø³Ø§Ø¹Ø©' : 'ÙŠÙˆÙ…';
                        
                        historyHTML += `
                            <tr>
                                <td style="text-align: center; font-weight: 600; color: var(--neon-blue);">${index + 1}</td>
                                <td style="text-align: center; font-weight: 500;">${fromDate}</td>
                                <td style="text-align: center; font-weight: 500;">${toDate}</td>
                                <td style="text-align: center; font-weight: 600;">${record.duration} ${durationUnit}</td>
                                <td style="text-align: center;">
                                    <span class="leave-type-badge ${typeClass}">
                                        <i data-lucide="${typeIcon}" style="width: 14px; height: 14px;"></i>
                                        ${typeText}
                                    </span>
                                </td>
                            </tr>
                        `;
                    });
                    
                    historyHTML += `
                                </tbody>
                            </table>
                        </div>
                    `;
                    leaveHistorySection.innerHTML = historyHTML;
                }
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
            lucide.createIcons();
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
            const modal = document.getElementById('employeeDetailsModal');
            if (modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden'; // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
            }
        }

        // ÙˆØ¸ÙŠÙØ© Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù
        function closeEmployeeDetailsModal() {
            const modal = document.getElementById('employeeDetailsModal');
            if (modal) {
                // Ø¥Ø²Ø§Ù„Ø© class show Ù„Ø¨Ø¯Ø¡ Ø§Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
                modal.classList.remove('show');
                
                // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                document.body.style.overflow = 'auto';
                
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ù†ÙŠÙ…ÙŠØ´Ù† (300ms)
                setTimeout(() => {
                    const employeeInfoSection = modal.querySelector('.employee-info-section');
                    const leaveHistorySection = modal.querySelector('.leave-history-section');
                    
                    if (employeeInfoSection) {
                        employeeInfoSection.innerHTML = '';
                    }
                    if (leaveHistorySection) {
                        leaveHistorySection.innerHTML = '';
                    }
                }, 300);
            }
        }

        function switchTab(tabName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            document.querySelectorAll('.tab-panel').forEach(panel => {
                panel.classList.add('hidden');
            });
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯
            const targetTab = document.getElementById(tabName + 'Tab');
            if (targetTab) {
                targetTab.classList.remove('hidden');
            }
            
            // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
            const activeButton = document.querySelector(`[data-tab="${tabName}"]`);
            if (activeButton) {
                activeButton.classList.add('active');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ù…ØªØ­Ø±Ùƒ
                updateTabIndicator(activeButton);
            }
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
            if (tabName === 'record') {
                loadEmployeeOptions();
            } else if (tabName === 'saturday') {
                loadEmployeeOptions();
                updateCurrentDate();
                updateCurrentAttendees();
                updateTodayAttendees();
                updateSaturdayTable();
                updateSaturdayStats();
                updateAttendanceButton();
            } else if (tabName === 'employees') {
                // ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø¹Ù†Ø¯ ÙØªØ­ ØªØ¨ÙˆÙŠØ¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                if (departments.length === 0) {
                    console.log('Loading departments for employees tab...');
                    loadDepartments();
                } else {
                    updateDepartmentSelects();
                }
                filteredEmployees = [];
                currentPage = 1;
                updateEmployeesTable();
                updateEmployeeStats();
                resetEmployeeForm();
            } else if (tabName === 'records') {
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
                loadRecords();
                
                // ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù„Ù„ÙÙ„ØªØ±Ø©
                const employeeFilter = document.getElementById('recordsEmployeeFilter');
                if (employeeFilter && employees.length > 0) {
                    employeeFilter.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</option>' +
                        employees.map(emp => `<option value="${emp.id}">${emp.name}</option>`).join('');
                }
            } else if (tabName === 'settings') {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                const userEmail = localStorage.getItem('currentUserEmail') || '';
                const isAdmin = userEmail === 'admin@company.com' || userEmail === 'admin' || 
                               (currentUser && (currentUser.email === 'admin@company.com' || currentUser.role === 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…'));
                
                console.log('ğŸ” Settings access check:', {
                    userEmail,
                    currentUser,
                    isAdmin
                });
                
                if (!isAdmin) {
                    alert('âš ï¸ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª\nÙÙ‚Ø· Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù… ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…');
                    switchTab('balances');
                    return;
                }
                
                console.log('âœ… Settings access granted');
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
                loadSettings();
            }
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
            lucide.createIcons();
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ù…ØªØ­Ø±Ùƒ
        function updateTabIndicator(activeButton) {
            const indicator = document.getElementById('tabIndicator');
            const tabsBar = document.querySelector('.tabs-bar');
            
            if (!indicator || !activeButton || !tabsBar) return;
            
            // Ø­Ø³Ø§Ø¨ Ù…ÙˆÙ‚Ø¹ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù…Ø¤Ø´Ø±
            const buttonRect = activeButton.getBoundingClientRect();
            const barRect = tabsBar.getBoundingClientRect();
            
            const left = buttonRect.left - barRect.left;
            const width = buttonRect.width;
            
            // ØªØ­Ø¯ÙŠØ¯ Ù„ÙˆÙ† Ø§Ù„Ù…Ø¤Ø´Ø± Ø­Ø³Ø¨ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
            const tabName = activeButton.dataset.tab;
            const colors = {
                'balances': 'var(--tab-balances)',
                'record': 'var(--tab-record)',
                'saturday': 'var(--tab-saturday)',
                'employees': 'var(--tab-employees)',
                'records': 'var(--tab-records)',
                'settings': 'var(--tab-settings)'
            };
            
            const color = colors[tabName] || 'var(--neon-blue)';
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­Ø¯ÙŠØ«
            indicator.style.left = left + 'px';
            indicator.style.width = width + 'px';
            indicator.style.background = `linear-gradient(90deg, ${color}, ${color}80)`;
            indicator.style.boxShadow = `0 0 10px ${color}`;
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¤Ø´Ø± Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        function initializeTabIndicator() {
            setTimeout(() => {
                const activeButton = document.querySelector('.tab-button.active');
                if (activeButton) {
                    updateTabIndicator(activeButton);
                }
            }, 100);
        }

        async function handleLogin(e) {
            e.preventDefault();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ­Ù…ÙŠÙ„ Firebase
            if (typeof firebase === 'undefined' || !auth) {
                console.warn('Firebase not available, using local authentication');
            }
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
            let actualEmail = email;
            let userAccount = null;
            
            // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø¶Ø§ÙÙŠÙ† Ø£ÙˆÙ„Ø§Ù‹
            const customUser = systemUsers.find(user => 
                user.email === email || user.username === email
            );
            
            if (customUser) {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø¶Ø§ÙÙŠÙ†
                const storedPassword = customUser.password;
                if (storedPassword === password) {
                    actualEmail = customUser.email;
                    userAccount = {
                        email: customUser.email,
                        password: customUser.password,
                        role: customUser.role
                    };
                }
            }
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯ ÙÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø¶Ø§ÙÙŠÙ†ØŒ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            else if (!email.includes('@') && usernames[email.toLowerCase()]) {
                const userData = usernames[email.toLowerCase()];
                actualEmail = userData.email;
                userAccount = userData;
            } else if (testAccounts[email]) {
                userAccount = testAccounts[email];
            }
            
            console.log('Attempting login with:', actualEmail);
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
            const loginBtn = document.getElementById('loginBtn');
            const loginBtnText = document.getElementById('loginBtnText');
            const loginLoading = document.getElementById('loginLoading');
            
            if (!loginBtn || !loginBtnText || !loginLoading) {
                console.error('Login form elements not found');
                return;
            }
            
            loginBtnText.classList.add('hidden');
            loginLoading.classList.remove('hidden');
            loginBtn.disabled = true;

            try {
                if (typeof firebase !== 'undefined' && auth) {
                    // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Firebase
                    console.log('Attempting Firebase login...');
                    const userCredential = await auth.signInWithEmailAndPassword(actualEmail, password);
                    console.log('Firebase login successful:', userCredential.user.email);
                    currentUser = {
                        email: userCredential.user.email,
                        role: userAccount?.role || testAccounts[actualEmail]?.role || 'Ù…Ø³ØªØ®Ø¯Ù…'
                    };
                } else {
                    // ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù…Ø­Ù„ÙŠ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
                    console.log('Using local authentication...');
                    if (userAccount && userAccount.password === password) {
                        currentUser = {
                            email: actualEmail,
                            role: userAccount.role
                        };
                        console.log('Local login successful');
                    } else {
                        throw new Error('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                    }
                }
                
                showNotification('loginNotification', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                
                // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø±Ø¨Ø¹ "ØªØ°ÙƒØ±Ù†ÙŠ" Ù…Ø­Ø¯Ø¯
                saveLoginData();
                
                setTimeout(() => {
                    showMainScreen();
                    loadData();
                    
                    // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ© Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    setTimeout(() => {
                        showSeasonalMessage();
                    }, 1000);
                }, 1000);
                
            } catch (error) {
                console.error('Login error:', error);
                let errorMessage = 'Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
                
                if (error.code === 'auth/user-not-found') {
                    errorMessage = 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯';
                } else if (error.code === 'auth/wrong-password') {
                    errorMessage = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­';
                } else if (error.code === 'auth/too-many-requests') {
                    errorMessage = 'Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙƒØ«ÙŠØ±Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ø§Ù‹';
                } else {
                    errorMessage = error.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹';
                }
                
                showNotification('loginNotification', errorMessage, 'error');
            } finally {
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„
                loginBtnText.classList.remove('hidden');
                loginLoading.classList.add('hidden');
                loginBtn.disabled = false;
            }
        }

        async function handleLogout() {
            try {
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ù‚Ø¨Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                cleanupRealtimeListeners();
                isRealtimeEnabled = false;
                realtimeStatus = 'disconnected';
                
                if (typeof firebase !== 'undefined' && auth) {
                    await auth.signOut();
                }
                console.log('User logged out');
                currentUser = null;
                showLoginScreen();
            } catch (error) {
                console.error('Logout error:', error);
                // Ø­ØªÙ‰ Ù„Ùˆ ÙØ´Ù„ FirebaseØŒ Ù†Ù‚ÙˆÙ… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ø­Ù„ÙŠØ§Ù‹
                cleanupRealtimeListeners();
                currentUser = null;
                showLoginScreen();
            }
        }

        function showLoginScreen() {
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('mainScreen').classList.add('hidden');
        }

        function showMainScreen() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('mainScreen').classList.remove('hidden');
            
            // ØªØ­Ø¯ÙŠØ« Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨
            const userWelcome = document.getElementById('userWelcome');
            if (currentUser) {
                const userName = currentUser.email === 'admin@company.com' ? 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…' : 
                               currentUser.email === 'supervisor@company.com' ? 'Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø£ÙˆÙ„' : 'Ù…ÙˆØ¸Ù ØªØ¬Ø±ÙŠØ¨ÙŠ';
                userWelcome.textContent = `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${userName} (${currentUser.email})`;
            }
            
            // Ø¥Ø®ÙØ§Ø¡/Ø¥Ø¸Ù‡Ø§Ø± ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const settingsTab = document.querySelector('[data-tab="settings"]');
            if (settingsTab) {
                const userEmail = localStorage.getItem('currentUserEmail') || '';
                const isAdmin = userEmail === 'admin@company.com' || userEmail === 'admin' || 
                               (currentUser && (currentUser.email === 'admin@company.com' || currentUser.role === 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…'));
                
                if (isAdmin) {
                    settingsTab.style.display = 'flex';
                } else {
                    settingsTab.style.display = 'none';
                }
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            updateMainStats();
            
            // ØªÙ‡ÙŠØ¦Ø© Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            initializeTabIndicator();
            
            // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯ÙˆØ±ÙŠ Ù„Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† (ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©)
            setInterval(() => {
                if (document.getElementById('saturdayTab') && !document.getElementById('saturdayTab').classList.contains('hidden')) {
                    updateCurrentAttendees();
                    updateTodayAttendees();
                }
            }, 60000); // ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            setTimeout(() => {
                lucide.createIcons();
            }, 100);
        }

        // ==================== ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ====================
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        let currentSettingsSection = 'general';
        let systemSettings = {
            fiscal: {
                yearStart: 7, // ÙŠÙˆÙ„ÙŠÙˆ
                defaultBalance: 30
            },
            appearance: {
                language: 'ar',
                fontSize: 'medium'
            },
            notifications: {
                email: true,
                lowBalance: true
            },
            security: {
                minPasswordLength: 8,
                maxLoginAttempts: 5,
                requireComplexPassword: true,
                passwordExpiry: false,
                sessionTimeout: 60,
                autoLogout: true
            },
            backup: {
                frequency: 'daily',
                retention: 14,
                autoBackup: true
            }
        };

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        async function loadSettings() {
            try {
                console.log('ğŸ”„ Loading settings...');
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ù† localStorage Ø£Ùˆ Firebase
                const savedSettings = localStorage.getItem('systemSettings');
                if (savedSettings) {
                    systemSettings = { ...systemSettings, ...JSON.parse(savedSettings) };
                }
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                applySettingsToForm();
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
                setupSettingsEventListeners();
                
                console.log('âœ… Settings loaded successfully');
                
            } catch (error) {
                console.error('âŒ Error loading settings:', error);
                showNotification('settingsNotification', 'Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'error');
            }
        }

        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        function applySettingsToForm() {
            // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©
            document.getElementById('fiscalYearStart').value = systemSettings.fiscal.yearStart;
            document.getElementById('defaultBalance').value = systemSettings.fiscal.defaultBalance;
            
            // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¸Ù‡Ø±
            document.getElementById('systemLanguage').value = systemSettings.appearance.language;
            document.getElementById('fontSize').value = systemSettings.appearance.fontSize;
            
            // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
            document.getElementById('emailNotifications').checked = systemSettings.notifications.email;
            document.getElementById('lowBalanceAlerts').checked = systemSettings.notifications.lowBalance;
            
            // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†
            document.getElementById('minPasswordLength').value = systemSettings.security.minPasswordLength;
            document.getElementById('maxLoginAttempts').value = systemSettings.security.maxLoginAttempts;
            document.getElementById('requireComplexPassword').checked = systemSettings.security.requireComplexPassword;
            document.getElementById('passwordExpiry').checked = systemSettings.security.passwordExpiry;
            document.getElementById('sessionTimeout').value = systemSettings.security.sessionTimeout;
            document.getElementById('autoLogout').checked = systemSettings.security.autoLogout;
            
            // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
            document.getElementById('backupFrequency').value = systemSettings.backup.frequency;
            document.getElementById('backupRetention').value = systemSettings.backup.retention;
            document.getElementById('enableAutoBackup').checked = systemSettings.backup.autoBackup;
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function setupSettingsEventListeners() {
            // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            document.querySelectorAll('.settings-nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    switchSettingsSection(this.dataset.section);
                });
            });

            // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
            const generalForm = document.getElementById('generalSettingsForm');
            if (generalForm) {
                generalForm.addEventListener('submit', handleGeneralSettingsSave);
            }

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
            const resetBtn = document.getElementById('resetGeneralSettings');
            if (resetBtn) {
                resetBtn.addEventListener('click', resetGeneralSettings);
            }

            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
            const createBackupBtn = document.getElementById('createBackup');
            if (createBackupBtn) {
                createBackupBtn.addEventListener('click', createBackup);
            }

            const downloadBackupBtn = document.getElementById('downloadBackup');
            if (downloadBackupBtn) {
                downloadBackupBtn.addEventListener('click', downloadBackup);
            }

            const previewBackupBtn = document.getElementById('previewBackup');
            if (previewBackupBtn) {
                previewBackupBtn.addEventListener('click', previewBackup);
            }

            const restoreBackupBtn = document.getElementById('restoreBackup');
            if (restoreBackupBtn) {
                restoreBackupBtn.addEventListener('click', restoreBackup);
            }

            // Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù†
            const viewSecurityLogBtn = document.getElementById('viewSecurityLog');
            if (viewSecurityLogBtn) {
                viewSecurityLogBtn.addEventListener('click', viewSecurityLog);
            }

            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
            const addUserBtn = document.getElementById('addNewUser');
            if (addUserBtn) {
                addUserBtn.addEventListener('click', addNewUser);
            }
        }

        // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function switchSettingsSection(sectionName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
            document.querySelectorAll('.settings-section').forEach(section => {
                section.classList.add('hidden');
            });

            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.settings-nav-btn').forEach(btn => {
                btn.style.background = 'none';
                btn.style.color = 'var(--primary-200)';
                btn.classList.remove('active');
            });

            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯
            const targetSection = document.getElementById(sectionName + 'Settings');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }

            // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
            const activeButton = document.querySelector(`[data-section="${sectionName}"]`);
            if (activeButton) {
                activeButton.style.background = 'rgba(0, 212, 255, 0.2)';
                activeButton.style.color = 'var(--neon-blue)';
                activeButton.classList.add('active');
            }

            currentSettingsSection = sectionName;

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
            lucide.createIcons();
        }

        // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
        async function handleGeneralSettingsSave(e) {
            e.preventDefault();
            
            try {
                // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                systemSettings.fiscal.yearStart = parseInt(document.getElementById('fiscalYearStart').value);
                systemSettings.fiscal.defaultBalance = parseInt(document.getElementById('defaultBalance').value);
                
                systemSettings.appearance.language = document.getElementById('systemLanguage').value;
                systemSettings.appearance.fontSize = document.getElementById('fontSize').value;
                
                systemSettings.notifications.email = document.getElementById('emailNotifications').checked;
                systemSettings.notifications.lowBalance = document.getElementById('lowBalanceAlerts').checked;
                
                // Ø­ÙØ¸ ÙÙŠ localStorage
                localStorage.setItem('systemSettings', JSON.stringify(systemSettings));
                
                // Ø­ÙØ¸ ÙÙŠ Firebase Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­Ø§Ù‹
                if (db) {
                    await db.collection('settings').doc('system').set(systemSettings);
                }
                
                showNotification('settingsNotification', 'ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
            } catch (error) {
                console.error('âŒ Error saving settings:', error);
                showNotification('settingsNotification', 'Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'error');
            }
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
        function resetGeneralSettings() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©ØŸ')) {
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                systemSettings.fiscal = {
                    yearStart: 7,
                    defaultBalance: 30
                };
                
                systemSettings.appearance = {
                    language: 'ar',
                    fontSize: 'medium'
                };
                
                systemSettings.notifications = {
                    email: true,
                    lowBalance: true
                };
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                applySettingsToForm();
                
                showNotification('settingsNotification', 'ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
        async function createBackup() {
            try {
                const backupData = {
                    timestamp: new Date().toISOString(),
                    version: '1.0',
                    data: {
                        employees: employees,
                        leaveRecords: leaveRecords,
                        departments: departments,
                        settings: systemSettings
                    }
                };
                
                // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØªÙˆÙØ±Ø©
                if (typeof saturdayShifts !== 'undefined') {
                    backupData.data.saturdayShifts = saturdayShifts;
                }
                
                if (typeof resetHistory !== 'undefined') {
                    backupData.data.resetHistory = resetHistory;
                }
                
                // Ø­ÙØ¸ ÙÙŠ Firebase Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­Ø§Ù‹
                if (db) {
                    await db.collection('backups').add(backupData);
                }
                
                // Ø­ÙØ¸ ÙÙŠ localStorage
                const backupKey = `backup_${Date.now()}`;
                localStorage.setItem(backupKey, JSON.stringify(backupData));
                
                showNotification('settingsNotification', 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
            } catch (error) {
                console.error('âŒ Error creating backup:', error);
                showNotification('settingsNotification', 'Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'error');
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
        function downloadBackup() {
            try {
                const backupData = {
                    timestamp: new Date().toISOString(),
                    version: '1.0',
                    data: {
                        employees: employees,
                        leaveRecords: leaveRecords,
                        departments: departments,
                        settings: systemSettings
                    }
                };
                
                const dataStr = JSON.stringify(backupData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `employee_system_backup_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                showNotification('settingsNotification', 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
            } catch (error) {
                console.error('âŒ Error downloading backup:', error);
                showNotification('settingsNotification', 'Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'error');
            }
        }

        // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
        function previewBackup() {
            const fileInput = document.getElementById('backupFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showNotification('settingsNotification', 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    
                    let previewText = `ğŸ“Š Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©:\n\n`;
                    previewText += `ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date(backupData.timestamp).toLocaleString('ar-EG')}\n`;
                    previewText += `ğŸ“¦ Ø§Ù„Ø¥ØµØ¯Ø§Ø±: ${backupData.version}\n\n`;
                    
                    if (backupData.data) {
                        previewText += `ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: ${backupData.data.employees?.length || 0}\n`;
                        previewText += `ğŸ“ Ø¹Ø¯Ø¯ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª: ${backupData.data.leaveRecords?.length || 0}\n`;
                        previewText += `ğŸ¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…: ${backupData.data.departments?.length || 0}\n`;
                        
                        if (backupData.data.saturdayShifts) {
                            previewText += `â° Ø¹Ø¯Ø¯ Ù†ÙˆØ¨ØªØ¬ÙŠØ§Øª Ø§Ù„Ø³Ø¨Øª: ${backupData.data.saturdayShifts.length}\n`;
                        }
                    }
                    
                    alert(previewText);
                    
                } catch (error) {
                    showNotification('settingsNotification', 'Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØºÙŠØ± ØµØ§Ù„Ø­', 'error');
                }
            };
            
            reader.readAsText(file);
        }

        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
        function restoreBackup() {
            const fileInput = document.getElementById('backupFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showNotification('settingsNotification', 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            if (!confirm('âš ï¸ ØªØ­Ø°ÙŠØ±: Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø³ØªØ­Ù„ Ù…Ø­Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ')) {
                return;
            }
            
            const reader = new FileReader();
            reader.onload = async function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    
                    if (backupData.data) {
                        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                        if (backupData.data.employees) {
                            employees = backupData.data.employees;
                            localStorage.setItem('employees', JSON.stringify(employees));
                        }
                        
                        if (backupData.data.leaveRecords) {
                            leaveRecords = backupData.data.leaveRecords;
                            localStorage.setItem('leaveRecords', JSON.stringify(leaveRecords));
                        }
                        
                        if (backupData.data.departments) {
                            departments = backupData.data.departments;
                            localStorage.setItem('departments', JSON.stringify(departments));
                        }
                        
                        if (backupData.data.settings) {
                            systemSettings = backupData.data.settings;
                            localStorage.setItem('systemSettings', JSON.stringify(systemSettings));
                        }
                        
                        // Ø­ÙØ¸ ÙÙŠ Firebase Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­Ø§Ù‹
                        if (db) {
                            if (backupData.data.employees) {
                                for (const employee of backupData.data.employees) {
                                    await db.collection('employees').doc(employee.id).set(employee);
                                }
                            }
                            
                            if (backupData.data.leaveRecords) {
                                for (const record of backupData.data.leaveRecords) {
                                    await db.collection('leave_records').doc(record.id).set(record);
                                }
                            }
                        }
                        
                        showNotification('settingsNotification', 'ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­. Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©...', 'success');
                        
                        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†
                        setTimeout(() => {
                            location.reload();
                        }, 3000);
                    }
                    
                } catch (error) {
                    console.error('âŒ Error restoring backup:', error);
                    showNotification('settingsNotification', 'Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'error');
                }
            };
            
            reader.readAsText(file);
        }

        // Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù†
        function viewSecurityLog() {
            const securityLog = [
                { date: '2025-01-09 14:30', user: 'admin', action: 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­', ip: '192.168.1.100' },
                { date: '2025-01-09 14:25', user: 'supervisor', action: 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­', ip: '192.168.1.101' },
                { date: '2025-01-09 14:20', user: 'unknown', action: 'Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ ÙØ§Ø´Ù„Ø©', ip: '192.168.1.102' },
                { date: '2025-01-09 14:15', user: 'admin', action: 'ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…', ip: '192.168.1.100' },
                { date: '2025-01-09 14:10', user: 'supervisor', action: 'Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯', ip: '192.168.1.101' }
            ];
            
            let logText = 'ğŸ“Š Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù†:\n\n';
            securityLog.forEach(entry => {
                logText += `ğŸ“… ${entry.date}\n`;
                logText += `ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${entry.user}\n`;
                logText += `ğŸ”§ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: ${entry.action}\n`;
                logText += `ğŸŒ IP: ${entry.ip}\n\n`;
            });
            
            alert(logText);
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
        function addNewUser() {
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
            const modal = document.getElementById('addUserModal');
            modal.classList.add('show');
            
            // Ù…Ù†Ø¹ Ø§Ù„Ø³ÙƒØ±ÙˆÙ„ ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø®Ù„ÙÙŠØ©
            document.body.classList.add('modal-open');
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            document.getElementById('addUserForm').reset();
            document.getElementById('addUserNotification').innerHTML = '';
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ø§ÙØ°Ø© (ÙÙŠ Ø­Ø§Ù„Ø© ÙƒØ§Ù†Øª Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)
            document.querySelector('#addUserModal .modal-title').textContent = 'ğŸ‘¤ Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯';
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø­Ù‚ÙˆÙ„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
            const passwordField = document.getElementById('newUserPassword');
            const confirmPasswordField = document.getElementById('newUserPasswordConfirm');
            if (passwordField) passwordField.style.display = 'block';
            if (confirmPasswordField) confirmPasswordField.style.display = 'block';
            
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ù…Ù† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
            updateDepartmentSelects();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
            lucide.createIcons();
        }

        // Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
        async function handleAddUserSubmit(e) {
            e.preventDefault();
            
            try {
                // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                const userData = {
                    id: 'user_' + Date.now(),
                    name: document.getElementById('newUserName').value.trim(),
                    username: document.getElementById('newUserUsername').value.trim(),
                    email: document.getElementById('newUserEmail').value.trim(),
                    phone: document.getElementById('newUserPhone').value.trim(),
                    password: document.getElementById('newUserPassword').value,
                    passwordConfirm: document.getElementById('newUserPasswordConfirm').value,
                    role: document.getElementById('newUserRole').value,
                    department: document.getElementById('newUserDepartment').value,
                    notes: document.getElementById('newUserNotes').value.trim(),
                    createdAt: new Date().toISOString(),
                    isActive: true
                };

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                if (!userData.name || !userData.username || !userData.email || !userData.password || !userData.role) {
                    showNotification('addUserNotification', 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø·ÙˆÙ„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                if (userData.password.length < 8) {
                    showNotification('addUserNotification', 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                if (userData.password !== userData.passwordConfirm) {
                    showNotification('addUserNotification', 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
                const existingUser = systemUsers.find(user => 
                    user.username === userData.username || user.email === userData.email
                );

                if (existingUser) {
                    showNotification('addUserNotification', 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„', 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                const defaultEmails = ['admin@company.com', 'supervisor@company.com', 'employee@company.com'];
                const defaultUsernames = ['admin', 'supervisor', 'employee'];
                
                if (defaultEmails.includes(userData.email) || defaultUsernames.includes(userData.username)) {
                    showNotification('addUserNotification', 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ù…Ø­Ø¬ÙˆØ² Ù„Ù„Ù†Ø¸Ø§Ù…)', 'error');
                    return;
                }

                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                systemUsers.push(userData);

                // Ø­ÙØ¸ ÙÙŠ localStorage
                localStorage.setItem('systemUsers', JSON.stringify(systemUsers));

                // Ø­ÙØ¸ ÙÙŠ Firebase Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­Ø§Ù‹
                if (db) {
                    await db.collection('users').doc(userData.id).set({
                        ...userData,
                        password: btoa(userData.password) // ØªØ´ÙÙŠØ± Ø¨Ø³ÙŠØ·
                    });
                }

                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„
                addUserToTable(userData);

                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
                closeAddUserModal();

                showNotification('settingsNotification', `ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… "${userData.name}" Ø¨Ù†Ø¬Ø§Ø­`, 'success');

            } catch (error) {
                console.error('âŒ Error adding user:', error);
                showNotification('addUserNotification', 'Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'error');
            }
        }

        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        function addUserToTable(userData) {
            const tbody = document.getElementById('usersTableBody');
            const newRow = document.createElement('tr');
            newRow.style.borderBottom = '1px solid rgba(0, 212, 255, 0.1)';
            newRow.dataset.userId = userData.id;
            
            const roleColors = {
                'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…': 'linear-gradient(45deg, var(--neon-blue), var(--primary-600))',
                'Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø£ÙˆÙ„': 'linear-gradient(45deg, var(--neon-yellow), var(--neon-orange))',
                'Ù…ÙˆØ¸Ù ØªØ¬Ø±ÙŠØ¨ÙŠ': 'rgba(255, 255, 255, 0.2)'
            };
            
            const roleTextColors = {
                'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…': 'white',
                'Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø£ÙˆÙ„': 'var(--primary-900)',
                'Ù…ÙˆØ¸Ù ØªØ¬Ø±ÙŠØ¨ÙŠ': 'white'
            };
            
            newRow.innerHTML = `
                <td style="color: white; font-weight: bold;">
                    <div>${userData.name}</div>
                    <div style="font-size: 0.8rem; color: var(--primary-200);">@${userData.username}</div>
                </td>
                <td class="hide-mobile" style="color: var(--primary-200);">
                    <div>${userData.email}</div>
                    ${userData.phone ? `<div style="font-size: 0.8rem;">${userData.phone}</div>` : ''}
                </td>
                <td style="text-align: center;">
                    <span style="background: ${roleColors[userData.role] || 'rgba(255, 255, 255, 0.2)'}; color: ${roleTextColors[userData.role] || 'white'}; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">${userData.role}</span>
                </td>
                <td class="hide-small" style="text-align: center;">
                    <span style="background: rgba(0, 255, 136, 0.2); color: var(--neon-green); padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold;">Ù†Ø´Ø·</span>
                </td>
                <td style="text-align: center;">
                    <div style="display: flex; gap: 0.5rem; justify-content: center;">
                        <button class="btn-neon" style="padding: 0.5rem; font-size: 0.8rem;" title="\u062A\u0639\u062F\u064A\u0644" onclick="editUser('${userData.id}')">
                            <i data-lucide="edit-2"></i>
                        </button>
                        <button style="background: rgba(255, 68, 68, 0.2); border: 1px solid rgba(255, 68, 68, 0.5); color: #ff4444; padding: 0.5rem; border-radius: 6px; cursor: pointer;" title="\u062D\u0630\u0641" onclick="deleteUser('${userData.id}')">
                            <i data-lucide="trash-2"></i>
                        </button>
                    </div>
                </td>
            `;
            
            tbody.appendChild(newRow);
            lucide.createIcons();
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function closeAddUserModal() {
            const modal = document.getElementById('addUserModal');
            modal.classList.remove('show');
            
            // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø³ÙƒØ±ÙˆÙ„ ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
            document.body.classList.remove('modal-open');
        }

        // Ø­Ø°Ù Ù…Ø³ØªØ®Ø¯Ù…
        function deleteUser(userId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ')) {
                // Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                systemUsers = systemUsers.filter(user => user.id !== userId);
                
                // Ø­ÙØ¸ ÙÙŠ localStorage
                localStorage.setItem('systemUsers', JSON.stringify(systemUsers));
                
                // Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„
                const row = document.querySelector(`[data-user-id="${userId}"]`);
                if (row) {
                    row.remove();
                }
                
                showNotification('settingsNotification', 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù…
        function editUser(userId) {
            const user = systemUsers.find(u => u.id === userId);
            if (user) {
                // Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                document.getElementById('newUserName').value = user.name;
                document.getElementById('newUserUsername').value = user.username;
                document.getElementById('newUserEmail').value = user.email;
                document.getElementById('newUserPhone').value = user.phone || '';
                document.getElementById('newUserRole').value = user.role;
                document.getElementById('newUserDepartment').value = user.department || '';
                document.getElementById('newUserNotes').value = user.notes || '';
                
                // Ø¥Ø®ÙØ§Ø¡ Ø­Ù‚ÙˆÙ„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                document.getElementById('newUserPassword').style.display = 'none';
                document.getElementById('newUserPasswordConfirm').style.display = 'none';
                
                // ØªØºÙŠÙŠØ± Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ø§ÙØ°Ø©
                document.querySelector('#addUserModal .modal-title').textContent = 'âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…';
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø©
                document.getElementById('addUserModal').classList.add('show');
            }
        }

        function showNotification(containerId, message, type = 'success') {
            const container = document.getElementById(containerId);
            if (!container) {
                console.warn('Notification container not found:', containerId);
                console.log('Message:', message);
                return;
            }
            
            const notification = document.createElement('div');
            notification.className = 'notification ' + type;
            
            const icon = type === 'success' ? 'check-circle' : 
                        type === 'error' ? 'x-circle' : 'alert-circle';
            
            notification.innerHTML = 
                '<i data-lucide="' + icon + '"></i>' +
                '<span>' + message + '</span>';
            
            container.innerHTML = '';
            container.appendChild(notification);
            
            lucide.createIcons();
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }
    </script>
</body>
</html>
</html>
